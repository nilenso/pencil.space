shadow$provide.module$node_modules$paper$dist$paper_full=function(global$jscomp$0,require,module$jscomp$0,exports$jscomp$1){(function(self$jscomp$0,undefined){self$jscomp$0=self$jscomp$0||require("shadow$empty");var window=self$jscomp$0.window,document=self$jscomp$0.document,Base=new function(){function inject(dest,src,enumerable,beans,preserve){function field(name,val){val=val||(val=describe(src,name))&&(val.get?val:val.value);"string"===typeof val&&"#"===val[0]&&(val=dest[val.substring(1)]||val);
var isFunc="function"===typeof val,res=val,prev=preserve||isFunc&&!val.base?val&&val.get?name in dest:dest[name]:null,bean;preserve&&prev||(isFunc&&prev&&(val.base=prev),isFunc&&!1!==beans&&(bean=name.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(beansNames[bean[3].toLowerCase()+bean[4]]=bean[2]),res&&!isFunc&&res.get&&"function"===typeof res.get&&Base.isPlainObject(res)||(res={value:res,writable:!0}),(describe(dest,name)||{configurable:!0}).configurable&&(res.configurable=!0,res.enumerable=null!=enumerable?
enumerable:!bean),define(dest,name,res))}var beansNames={};if(src){for(var name$jscomp$0 in src)src.hasOwnProperty(name$jscomp$0)&&!hidden.test(name$jscomp$0)&&field(name$jscomp$0);for(name$jscomp$0 in beansNames){var part=beansNames[name$jscomp$0],set=dest["set"+part];part=dest["get"+part]||set&&dest["is"+part];!part||!0!==beans&&0!==part.length||field(name$jscomp$0,{get:part,set:set})}}return dest}function Base(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];src&&set$jscomp$0(this,
src)}return this}var hidden=/^(statics|enumerable|beans|preserve)$/,array=[],slice=array.slice,create=Object.create,describe=Object.getOwnPropertyDescriptor,define=Object.defineProperty,forEach=array.forEach||function(iter,bind){for(var i=0,l=this.length;i<l;i++)iter.call(bind,this[i],i,this)},forIn=function(iter,bind){for(var i in this)this.hasOwnProperty(i)&&iter.call(bind,this[i],i,this)},set$jscomp$0=Object.assign||function(dst){for(var i=1,l=arguments.length;i<l;i++){var src=arguments[i],key;
for(key in src)src.hasOwnProperty(key)&&(dst[key]=src[key])}return dst},each=function(obj,iter,bind){if(obj){var desc=describe(obj,"length");(desc&&"number"===typeof desc.value?forEach:forIn).call(obj,iter,bind=bind||obj)}return bind};return inject(Base,{inject:function(src){if(src){var statics=!0===src.statics?src:src.statics,beans=src.beans,preserve=src.preserve;statics!==src&&inject(this.prototype,src,src.enumerable,beans,preserve);inject(this,statics,null,beans,preserve)}statics=1;for(beans=arguments.length;statics<
beans;statics++)this.inject(arguments[statics]);return this},extend:function(){for(var base=this,ctor,proto,i=0,obj,l=arguments.length;i<l&&(!ctor||!proto);i++)obj=arguments[i],ctor=ctor||obj.initialize,proto=proto||obj.prototype;ctor=ctor||function(){base.apply(this,arguments)};proto=ctor.prototype=proto||create(this.prototype);define(proto,"constructor",{value:ctor,writable:!0,configurable:!0});inject(ctor,this);arguments.length&&this.inject.apply(ctor,arguments);ctor.base=base;return ctor}}).inject({enumerable:!1,
initialize:Base,set:Base,inject:function(){for(var i=0,l=arguments.length;i<l;i++){var src=arguments[i];src&&inject(this,src,src.enumerable,src.beans,src.preserve)}return this},extend:function(){var res=create(this);return res.inject.apply(res,arguments)},each:function(iter,bind){return each(this,iter,bind)},clone:function(){return new this.constructor(this)},statics:{set:set$jscomp$0,each:each,create:create,define:define,describe:describe,clone:function(obj){return set$jscomp$0(new obj.constructor,
obj)},isPlainObject:function(obj){return(obj=null!=obj&&obj.constructor)&&(obj===Object||obj===Base||"Object"===obj.name)},pick:function(a,b){return undefined!==a?a:b},slice:function(list,begin,end){return slice.call(list,begin,end)}}})};"undefined"!==typeof module$jscomp$0&&(module$jscomp$0.exports=Base);Base.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+Base.each(this,function(value,key){if(!/^_/.test(key)){var type=
typeof value;this.push(key+": "+("number"===type?Formatter.instance.number(value):"string"===type?"'"+value+"'":value))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(json){return Base.importJSON(json,this)},exportJSON:function(options){return Base.exportJSON(this,options)},toJSON:function(){return Base.serialize(this)},set:function(props,exclude){props&&Base.filter(this,props,exclude,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function extend(){var res=
extend.base.apply(this,arguments),name=res.prototype._class;name&&!Base.exports[name]&&(Base.exports[name]=res);return res},equals:function(obj1,obj2){if(obj1===obj2)return!0;if(obj1&&obj1.equals)return obj1.equals(obj2);if(obj2&&obj2.equals)return obj2.equals(obj1);if(obj1&&obj2&&"object"===typeof obj1&&"object"===typeof obj2){if(Array.isArray(obj1)&&Array.isArray(obj2)){var length=obj1.length;if(length!==obj2.length)return!1;for(;length--;)if(!Base.equals(obj1[length],obj2[length]))return!1}else{var keys=
Object.keys(obj1);length=keys.length;if(length!==Object.keys(obj2).length)return!1;for(;length--;){var key=keys[length];if(!obj2.hasOwnProperty(key)||!Base.equals(obj1[key],obj2[key]))return!1}}return!0}return!1},read:function(list,start,options,amount){if(this===Base)return options=this.peek(list,start),list.__index++,options;var proto=this.prototype,readIndex=proto._readIndex,begin=start||readIndex&&list.__index||0,length=list.length;start=list[begin];amount=amount||length-begin;if(start instanceof
this||options&&options.readNull&&null==start&&1>=amount)return readIndex&&(list.__index=begin+1),start&&options&&options.clone?start.clone():start;start=Base.create(proto);readIndex&&(start.__read=!0);start=start.initialize.apply(start,0<begin||begin+amount<length?Base.slice(list,begin,begin+amount):list)||start;if(readIndex){list.__index=begin+start.__read;if(options=start.__filtered)list.__filtered=options,start.__filtered=undefined;start.__read=undefined}return start},peek:function(list,start){return list[list.__index=
start||list.__index||0]},remain:function(list){return list.length-(list.__index||0)},readList:function(list,start,options,amount){var res=[],entry;start=start||0;for(amount=amount?start+amount:list.length;start<amount;start++)res.push(Array.isArray(entry=list[start])?this.read(entry,0,options):this.read(list,start,options,1));return res},readNamed:function(list,name,start,options,amount){var value=this.getNamed(list,name),hasValue=undefined!==value;if(hasValue){var filtered=list.__filtered;if(!filtered){var source=
this.getSource(list);filtered=list.__filtered=Base.create(source);filtered.__unfiltered=source}filtered[name]=undefined}return this.read(hasValue?[value]:list,start,options,amount)},readSupported:function(list,dest){var source=this.getSource(list),that=this,read=!1;source&&Object.keys(source).forEach(function(key){if(key in dest){var value=that.readNamed(list,key);undefined!==value&&(dest[key]=value);read=!0}});return read},getSource:function(list){var source=list.__source;undefined===source&&(source=
1===list.length&&list[0],source=list.__source=source&&Base.isPlainObject(source)?source:null);return source},getNamed:function(list,name){var source=this.getSource(list);if(source)return name?source[name]:list.__filtered||source},hasNamed:function(list,name){return!!this.getNamed(list,name)},filter:function(dest,source,exclude,prioritize){function handleKey(key){if(!(exclude&&key in exclude||processed&&key in processed)){var value=source[key];undefined!==value&&(dest[key]=value)}}if(prioritize){for(var keys=
{},i=0,key$jscomp$0,l=prioritize.length;i<l;i++)(key$jscomp$0=prioritize[i])in source&&(handleKey(key$jscomp$0),keys[key$jscomp$0]=!0);var processed=keys}Object.keys(source.__unfiltered||source).forEach(handleKey);return dest},isPlainValue:function(obj,asString){return Base.isPlainObject(obj)||Array.isArray(obj)||asString&&"string"===typeof obj},serialize:function(obj,options,compact,dictionary){options=options||{};var isRoot=!dictionary;isRoot&&(options.formatter=new Formatter(options.precision),
dictionary={length:0,definitions:{},references:{},add:function(item,create){var id="#"+item._id,ref=this.references[id];ref||(this.length++,create=create.call(item),(item=item._class)&&create[0]!==item&&create.unshift(item),this.definitions[id]=create,ref=this.references[id]=[id]);return ref}});if(obj&&obj._serialize){var res=obj._serialize(options,dictionary);options=obj._class;!options||obj._compactSerialize||!isRoot&&compact||res[0]===options||res.unshift(options)}else if(Array.isArray(obj)){res=
[];for(var i=0,l=obj.length;i<l;i++)res[i]=Base.serialize(obj[i],options,compact,dictionary)}else if(Base.isPlainObject(obj)){res={};var keys=Object.keys(obj);i=0;for(l=keys.length;i<l;i++){var key=keys[i];res[key]=Base.serialize(obj[key],options,compact,dictionary)}}else res="number"===typeof obj?options.formatter.number(obj,options.precision):obj;return isRoot&&0<dictionary.length?[["dictionary",dictionary.definitions],res]:res},deserialize:function(json,create,_data,_setDictionary,_isRoot){var res=
json,isFirst=!_data,hasDictionary=isFirst&&json&&json.length&&"dictionary"===json[0][0];_data=_data||{};if(Array.isArray(json)){_setDictionary=json[0];var isDictionary="dictionary"===_setDictionary;if(1==json.length&&/^#/.test(_setDictionary))return _data.dictionary[_setDictionary];_setDictionary=Base.exports[_setDictionary];res=[];for(var i=_setDictionary?1:0,l=json.length;i<l;i++)res.push(Base.deserialize(json[i],create,_data,isDictionary,hasDictionary));_setDictionary&&(json=res,res=create?create(_setDictionary,
json,isFirst||_isRoot):new _setDictionary(json))}else if(Base.isPlainObject(json))for(isDictionary in res={},_setDictionary&&(_data.dictionary=res),json)res[isDictionary]=Base.deserialize(json[isDictionary],create,_data);return hasDictionary?res[1]:res},exportJSON:function(obj,options){obj=Base.serialize(obj,options);return options&&0==options.asString?obj:JSON.stringify(obj)},importJSON:function(json,target){return Base.deserialize("string"===typeof json?JSON.parse(json):json,function(ctor,args,
isRoot){var obj=(isRoot=isRoot&&target&&target.constructor===ctor)?target:Base.create(ctor.prototype);if(1===args.length&&obj instanceof Item&&(isRoot||!(obj instanceof Layer))){var arg=args[0];Base.isPlainObject(arg)&&(arg.insert=!1,isRoot&&(args=args.concat([{insert:!0}])))}(isRoot?obj.set:ctor).apply(obj,args);isRoot&&(target=null);return obj})},push:function(list,items){var itemsLength=items.length;if(4096>itemsLength)list.push.apply(list,items);else{var startLength=list.length;list.length+=itemsLength;
for(var i=0;i<itemsLength;i++)list[startLength+i]=items[i]}return list},splice:function(list,items,index,remove){var amount=items&&items.length,append=undefined===index;index=append?list.length:index;index>list.length&&(index=list.length);for(var i=0;i<amount;i++)items[i]._index=index+i;if(append)return Base.push(list,items),[];i=[index,remove];items&&Base.push(i,items);items=list.splice.apply(list,i);i=0;for(remove=items.length;i<remove;i++)items[i]._index=undefined;i=index+amount;for(remove=list.length;i<
remove;i++)list[i]._index=i;return items},capitalize:function(str){return str.replace(/\b[a-z]/g,function(match){return match.toUpperCase()})},camelize:function(str){return str.replace(/-(.)/g,function(match,chr){return chr.toUpperCase()})},hyphenate:function(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Emitter={on:function(type,func){if("string"!==typeof type)Base.each(type,function(value,key){this.on(key,value)},this);else{var types=this._eventTypes;types=types&&types[type];
var handlers=this._callbacks=this._callbacks||{};handlers=handlers[type]=handlers[type]||[];-1===handlers.indexOf(func)&&(handlers.push(func),types&&types.install&&1===handlers.length&&types.install.call(this,type))}return this},off:function(type,func){if("string"!==typeof type)Base.each(type,function(value,key){this.off(key,value)},this);else{var types=this._eventTypes;types=types&&types[type];var handlers=this._callbacks&&this._callbacks[type],index;handlers&&(!func||-1!==(index=handlers.indexOf(func))&&
1===handlers.length?(types&&types.uninstall&&types.uninstall.call(this,type),delete this._callbacks[type]):-1!==index&&handlers.splice(index,1));return this}},once:function(type,func){return this.on(type,function handler(){func.apply(this,arguments);this.off(type,handler)})},emit:function(type,event){var handlers=this._callbacks&&this._callbacks[type];if(!handlers)return!1;var args=Base.slice(arguments,1),setTarget=event&&event.target&&!event.currentTarget;handlers=handlers.slice();setTarget&&(event.currentTarget=
this);for(var i=0,l=handlers.length;i<l;i++)if(0==handlers[i].apply(this,args)){event&&event.stop&&event.stop();break}setTarget&&delete event.currentTarget;return!0},responds:function(type){return!(!this._callbacks||!this._callbacks[type])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(install){var types=this._eventTypes,handlers=this._callbacks;install=install?"install":"uninstall";if(types)for(var type in handlers)if(0<handlers[type].length){var entry=types[type];(entry=entry&&
entry[install])&&entry.call(this,type)}},statics:{inject:function inject(src){var events=src._events;if(events){var types={};Base.each(events,function(entry,key){var isString="string"===typeof entry,name=isString?entry:key;key=Base.capitalize(name);var type=name.substring(2).toLowerCase();types[type]=isString?{}:entry;name="_"+name;src["get"+key]=function(){return this[name]};src["set"+key]=function(func){var prev=this[name];prev&&this.off(type,prev);if(func)this.on(type,func);this[name]=func}});
src._eventTypes=types}return inject.base.apply(this,arguments)}}},PaperScope=Base.extend({_class:"PaperScope",initialize:function PaperScope(){paper=this;this.settings=new Base({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0});this.project=null;this.projects=[];this.tools=[];this._id=PaperScope._id++;PaperScope._scopes[this._id]=this;var proto=PaperScope.prototype;if(!this.support){var ctx=CanvasProvider.getContext(1,1)||{};proto.support={nativeDash:"setLineDash"in ctx||"mozDash"in ctx,
nativeBlendModes:BlendMode.nativeModes};CanvasProvider.release(ctx)}if(!this.agent){ctx=self$jscomp$0.navigator.userAgent.toLowerCase();var os=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(ctx)||[])[0];os="darwin"===os?"mac":os;var agent=proto.agent=proto.browser={platform:os};os&&(agent[os]=!0);ctx.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv:v?([.\d]+))?/g,function(match,n,v1,v2,rv){agent.chrome||(match="opera"===n?v2:/^(node|trident)$/.test(n)?
rv:v1,agent.version=match,agent.versionNumber=parseFloat(match),n={trident:"msie",jsdom:"node"}[n]||n,agent.name=n,agent[n]=!0)});agent.chrome&&delete agent.webkit;agent.atom&&delete agent.chrome}},version:"0.12.4",getView:function(){var project=this.project;return project&&project._view},getPaper:function(){return this},execute:function(code,options){code=paper.PaperScript.execute(code,this,options);View.updateFocus();return code},install:function(scope){var that=this;Base.each(["project","view",
"tool"],function(key){Base.define(scope,key,{configurable:!0,get:function(){return that[key]}})});for(var key$jscomp$0 in this)!/^_/.test(key$jscomp$0)&&this[key$jscomp$0]&&(scope[key$jscomp$0]=this[key$jscomp$0])},setup:function(element){paper=this;this.project=new Project(element);return this},createCanvas:function(width,height){return CanvasProvider.getCanvas(width,height)},activate:function(){paper=this},clear:function(){for(var projects=this.projects,tools=this.tools,i=projects.length-1;0<=i;i--)projects[i].remove();
for(i=tools.length-1;0<=i;i--)tools[i].remove()},remove:function(){this.clear();delete PaperScope._scopes[this._id]},statics:new function(){function handleAttribute(name){name+="Attribute";return function(el,attr){return el[name](attr)||el[name]("data-paper-"+attr)}}return{_scopes:{},_id:0,get:function(id){return this._scopes[id]||null},getAttribute:handleAttribute("get"),hasAttribute:handleAttribute("has")}}}),PaperScopeItem=Base.extend(Emitter,{initialize:function(activate){this._scope=paper;this._index=
this._scope[this._list].push(this)-1;!activate&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var prev=this._scope[this._reference];prev&&prev!==this&&prev.emit("deactivate");this._scope[this._reference]=this;this.emit("activate",prev);return!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(null==this._index)return!1;Base.splice(this._scope[this._list],null,this._index,1);this._scope[this._reference]==this&&(this._scope[this._reference]=
null);this._scope=null;return!0},getView:function(){return this._scope.getView()}}),CollisionDetection={findItemBoundsCollisions:function(items1,items2,tolerance){function getBounds(items){for(var bounds=Array(items.length),i=0;i<items.length;i++){var rect=items[i].getBounds();bounds[i]=[rect.left,rect.top,rect.right,rect.bottom]}return bounds}var bounds1=getBounds(items1);items1=items2&&items2!==items1?getBounds(items2):bounds1;return this.findBoundsCollisions(bounds1,items1,tolerance||0)},findCurveBoundsCollisions:function(curves1,
curves2,tolerance,bothAxis){function getBounds(curves){for(var min=Math.min,max=Math.max,bounds=Array(curves.length),i=0;i<curves.length;i++){var v=curves[i];bounds[i]=[min(v[0],v[2],v[4],v[6]),min(v[1],v[3],v[5],v[7]),max(v[0],v[2],v[4],v[6]),max(v[1],v[3],v[5],v[7])]}return bounds}var bounds1=getBounds(curves1);curves1=curves2&&curves2!==curves1?getBounds(curves2):bounds1;if(bothAxis){bothAxis=this.findBoundsCollisions(bounds1,curves1,tolerance||0,!1,!0);tolerance=this.findBoundsCollisions(bounds1,
curves1,tolerance||0,!0,!0);bounds1=[];curves1=0;for(curves2=bothAxis.length;curves1<curves2;curves1++)bounds1[curves1]={hor:bothAxis[curves1],ver:tolerance[curves1]};return bounds1}return this.findBoundsCollisions(bounds1,curves1,tolerance||0)},findBoundsCollisions:function(boundsA,boundsB,tolerance,sweepVertical,onlySweepAxisCollisions){function binarySearch(indices,coord,value){for(var lo=0,hi=indices.length;lo<hi;){var mid=hi+lo>>>1;allBounds[indices[mid]][coord]<value?lo=mid+1:hi=mid}return lo-
1}var self=!boundsB||boundsA===boundsB,allBounds=self?boundsA:boundsA.concat(boundsB),lengthA=boundsA.length,lengthAll=allBounds.length,pri0=sweepVertical?1:0,pri1=pri0+2,sec0=sweepVertical?0:1,sec1=sec0+2,allIndicesByPri0=Array(lengthAll);for(sweepVertical=0;sweepVertical<lengthAll;sweepVertical++)allIndicesByPri0[sweepVertical]=sweepVertical;allIndicesByPri0.sort(function(i1,i2){return allBounds[i1][pri0]-allBounds[i2][pri0]});var activeIndicesByPri1=[],allCollisions=Array(lengthA);for(sweepVertical=
0;sweepVertical<lengthAll;sweepVertical++){var curIndex=allIndicesByPri0[sweepVertical],curBounds=allBounds[curIndex],origIndex=self?curIndex:curIndex-lengthA,isCurrentA=curIndex<lengthA,isCurrentB=self||!isCurrentA,curCollisions=isCurrentA?[]:null;if(activeIndicesByPri1.length){var pruneCount=binarySearch(activeIndicesByPri1,pri1,curBounds[pri0]-tolerance)+1;activeIndicesByPri1.splice(0,pruneCount);if(self&&onlySweepAxisCollisions)for(curCollisions=curCollisions.concat(activeIndicesByPri1),pruneCount=
0;pruneCount<activeIndicesByPri1.length;pruneCount++){var activeIndex=activeIndicesByPri1[pruneCount];allCollisions[activeIndex].push(origIndex)}else{var curSec1=curBounds[sec1],curSec0=curBounds[sec0];for(pruneCount=0;pruneCount<activeIndicesByPri1.length;pruneCount++){activeIndex=activeIndicesByPri1[pruneCount];var activeBounds=allBounds[activeIndex],isActiveA=activeIndex<lengthA,isActiveB=self||activeIndex>=lengthA;if(onlySweepAxisCollisions||(isCurrentA&&isActiveB||isCurrentB&&isActiveA)&&curSec1>=
activeBounds[sec0]-tolerance&&curSec0<=activeBounds[sec1]+tolerance)isCurrentA&&isActiveB&&curCollisions.push(self?activeIndex:activeIndex-lengthA),isCurrentB&&isActiveA&&allCollisions[activeIndex].push(origIndex)}}}isCurrentA&&(boundsA===boundsB&&curCollisions.push(curIndex),allCollisions[curIndex]=curCollisions);activeIndicesByPri1.length?(curBounds=binarySearch(activeIndicesByPri1,pri1,curBounds[pri1]),activeIndicesByPri1.splice(curBounds+1,0,curIndex)):activeIndicesByPri1.push(curIndex)}for(sweepVertical=
0;sweepVertical<allCollisions.length;sweepVertical++)(boundsA=allCollisions[sweepVertical])&&boundsA.sort(function(i1,i2){return i1-i2});return allCollisions}},Formatter=Base.extend({initialize:function(precision){this.precision=Base.pick(precision,5);this.multiplier=Math.pow(10,this.precision)},number:function(val){return 16>this.precision?Math.round(val*this.multiplier)/this.multiplier:val},pair:function(val1,val2,separator){return this.number(val1)+(separator||",")+this.number(val2)},point:function(val,
separator){return this.number(val.x)+(separator||",")+this.number(val.y)},size:function(val,separator){return this.number(val.width)+(separator||",")+this.number(val.height)},rectangle:function(val,separator){return this.point(val,separator)+(separator||",")+this.size(val,separator)}});Formatter.instance=new Formatter;var Numerical=new function(){function clamp(value,min,max){return value<min?min:value>max?max:value}function getDiscriminant(a,b,c){function split(v){var x=134217729*v;x=v-x+x;return[x,
v-x]}var D=b*b-a*c,E=b*b+a*c;if(3*abs(D)<E){D=split(a);E=split(b);var cd=split(c);b*=b;a*=c;D=b-a+(E[0]*E[0]-b+2*E[0]*E[1]+E[1]*E[1]-(D[0]*cd[0]-a+D[0]*cd[1]+D[1]*cd[0]+D[1]*cd[1]))}return D}function getNormalizationFactor(){var norm=Math.max.apply(Math,arguments);return norm&&(1E-8>norm||1E8<norm)?pow(2,-Math.round(log2(norm))):0}var abscissas=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,
.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,
.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,
.9445750230732326,.9894009349916499]],weights=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,
.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,
.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],abs=Math.abs,sqrt=Math.sqrt,pow=Math.pow,log2=Math.log2||function(x){return Math.log(x)*Math.LOG2E};return{EPSILON:1E-12,MACHINE_EPSILON:1.12E-16,
CURVETIME_EPSILON:1E-8,GEOMETRIC_EPSILON:1E-7,TRIGONOMETRIC_EPSILON:1E-8,KAPPA:4*(sqrt(2)-1)/3,isZero:function(val){return-1E-12<=val&&1E-12>=val},isMachineZero:function(val){return-1.12E-16<=val&&1.12E-16>=val},clamp:clamp,integrate:function(f,a,b,n){var x=abscissas[n-2],w=weights[n-2];b=.5*(b-a);a=b+a;var i=0,m=n+1>>1;for(n=n&1?w[i++]*f(a):0;i<m;){var Ax=b*x[i];n+=w[i++]*(f(a+Ax)+f(a-Ax))}return b*n},findRoot:function(f,df,x,a,b,n,tolerance){for(var i=0;i<n;i++){var fx=f(x),dx=fx/df(x),nx=x-dx;
if(abs(dx)<tolerance){x=nx;break}0<fx?(b=x,x=nx<=a?.5*(a+b):nx):(a=x,x=nx>=b?.5*(a+b):nx)}return clamp(x,a,b)},solveQuadratic:function(a,b,c,roots,min,max){var x2=Infinity;if(1E-12>abs(a)){if(1E-12>abs(b))return 1E-12>abs(c)?-1:0;var x1=-c/b}else{b*=-.5;var D=getDiscriminant(a,b,c);if(D&&1.12E-16>abs(D)){var f=getNormalizationFactor(abs(a),abs(b),abs(c));f&&(a*=f,b*=f,c*=f,D=getDiscriminant(a,b,c))}-1.12E-16<=D&&(x1=0>D?0:sqrt(D),x2=b+(0>b?-x1:x1),0===x2?(x1=c/a,x2=-x1):(x1=x2/a,x2=c/x2))}a=0;c=null==
min;b=min-1E-12;D=max+1E-12;isFinite(x1)&&(c||x1>b&&x1<D)&&(roots[a++]=c?x1:clamp(x1,min,max));x2!==x1&&isFinite(x2)&&(c||x2>b&&x2<D)&&(roots[a++]=c?x2:clamp(x2,min,max));return a},solveCubic:function(a,b,c,d,roots,min,max){function evaluate(x0){x=x0;x0=a*x;b1=x0+b;c2=b1*x+c;qd=(x0+b1)*x+c2;q=c2*x+d}var f=getNormalizationFactor(abs(a),abs(b),abs(c),abs(d)),qd,q;f&&(a*=f,b*=f,c*=f,d*=f);if(1E-12>abs(a)){a=b;var b1=c;var c2=d;var x=Infinity}else if(1E-12>abs(d))b1=b,c2=c,x=0;else{evaluate(-(b/a)/3);
f=q/a;var r=pow(abs(f),1/3);f=0>f?-1:1;var td=-qd/a;r=0<td?1.324717957244746*Math.max(r,sqrt(td)):r;r=x-f*r;if(r!==x){do evaluate(r),r=0===qd?x:x-q/qd/(1+1.12E-16);while(f*r>f*x);abs(a)*x*x>abs(d/x)&&(c2=-d/x,b1=(c2-c)/x)}}f=Numerical.solveQuadratic(a,b1,c2,roots,min,max);r=null==min;isFinite(x)&&(0===f||0<f&&x!==roots[0]&&x!==roots[1])&&(r||x>min-1E-12&&x<max+1E-12)&&(roots[f++]=r?x:clamp(x,min,max));return f}}},UID={_id:1,_pools:{},get:function(name){if(name){var pool=this._pools[name];pool||(pool=
this._pools[name]={_id:1});return pool._id++}return this._id++}},Point=Base.extend({_class:"Point",_readIndex:!0,initialize:function(arg0,arg1){var type=typeof arg0,reading=this.__read,read=0;"number"===type?(type="number"===typeof arg1,this._set(arg0,type?arg1:arg0),reading&&(read=type?2:1)):"undefined"===type||null===arg0?(this._set(0,0),reading&&(read=null===arg0?1:0)):(arg0="string"===type?arg0.split(/[\s,]+/)||[]:arg0,read=1,Array.isArray(arg0)?this._set(+arg0[0],+(1<arg0.length?arg0[1]:arg0[0])):
"x"in arg0?this._set(arg0.x||0,arg0.y||0):"width"in arg0?this._set(arg0.width||0,arg0.height||0):"angle"in arg0?(this._set(arg0.length||0,0),this.setAngle(arg0.angle||0)):(this._set(0,0),read=0));reading&&(this.__read=read);return this},set:"#initialize",_set:function(x,y){this.x=x;this.y=y;return this},equals:function(point){return this===point||point&&(this.x===point.x&&this.y===point.y||Array.isArray(point)&&this.x===point[0]&&this.y===point[1])||!1},clone:function(){return new Point(this.x,this.y)},
toString:function(){var f=Formatter.instance;return"{ x: "+f.number(this.x)+", y: "+f.number(this.y)+" }"},_serialize:function(options){options=options.formatter;return[options.number(this.x),options.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(length){if(this.isZero()){var angle=this._angle||0;this._set(Math.cos(angle)*length,Math.sin(angle)*length)}else length/=this.getLength(),Numerical.isZero(length)&&this.getAngle(),this._set(this.x*
length,this.y*length)},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(angle){this.setAngleInRadians.call(this,angle*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var point=Point.read(arguments),div=this.getLength()*point.getLength();if(Numerical.isZero(div))return NaN;point=this.dot(point)/div;return Math.acos(-1>point?-1:1<point?1:point)}return this.isZero()?this._angle||
0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(angle){this._angle=angle;if(!this.isZero()){var length=this.getLength();this._set(Math.cos(angle)*length,Math.sin(angle)*length)}},getQuadrant:function(){return 0<=this.x?0<=this.y?1:4:0<=this.y?2:3}},{beans:!1,getDirectedAngle:function(){var point=Point.read(arguments);return 180*Math.atan2(this.cross(point),this.dot(point))/Math.PI},getDistance:function(){var args=arguments,point=Point.read(args),x=point.x-this.x;point=point.y-
this.y;x=x*x+point*point;return Base.read(args)?x:Math.sqrt(x)},normalize:function(length){undefined===length&&(length=1);var current=this.getLength();length=0!==current?length/current:0;current=new Point(this.x*length,this.y*length);0<=length&&(current._angle=this._angle);return current},rotate:function(angle,center){if(0===angle)return this.clone();angle=angle*Math.PI/180;var point=center?this.subtract(center):this,sin=Math.sin(angle);angle=Math.cos(angle);point=new Point(point.x*angle-point.y*
sin,point.x*sin+point.y*angle);return center?point.add(center):point},transform:function(matrix){return matrix?matrix._transformPoint(this):this},add:function(){var point=Point.read(arguments);return new Point(this.x+point.x,this.y+point.y)},subtract:function(){var point=Point.read(arguments);return new Point(this.x-point.x,this.y-point.y)},multiply:function(){var point=Point.read(arguments);return new Point(this.x*point.x,this.y*point.y)},divide:function(){var point=Point.read(arguments);return new Point(this.x/
point.x,this.y/point.y)},modulo:function(){var point=Point.read(arguments);return new Point(this.x%point.x,this.y%point.y)},negate:function(){return new Point(-this.x,-this.y)},isInside:function(){return Rectangle.read(arguments).contains(this)},isClose:function(){var args=arguments,point=Point.read(args);args=Base.read(args);return this.getDistance(point)<=args},isCollinear:function(){var point=Point.read(arguments);return Point.isCollinear(this.x,this.y,point.x,point.y)},isColinear:"#isCollinear",
isOrthogonal:function(){var point=Point.read(arguments);return Point.isOrthogonal(this.x,this.y,point.x,point.y)},isZero:function(){var isZero=Numerical.isZero;return isZero(this.x)&&isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(q){return 0<=this.x*(1<q&&4>q?-1:1)&&0<=this.y*(2<q?-1:1)},dot:function(){var point=Point.read(arguments);return this.x*point.x+this.y*point.y},cross:function(){var point=Point.read(arguments);return this.x*point.y-this.y*point.x},
project:function(){var point=Point.read(arguments),scale=point.isZero()?0:this.dot(point)/point.dot(point);return new Point(point.x*scale,point.y*scale)},statics:{min:function(){var args=arguments,point1=Point.read(args);args=Point.read(args);return new Point(Math.min(point1.x,args.x),Math.min(point1.y,args.y))},max:function(){var args=arguments,point1=Point.read(args);args=Point.read(args);return new Point(Math.max(point1.x,args.x),Math.max(point1.y,args.y))},random:function(){return new Point(Math.random(),
Math.random())},isCollinear:function(x1,y1,x2,y2){return Math.abs(x1*y2-y1*x2)<=1E-8*Math.sqrt((x1*x1+y1*y1)*(x2*x2+y2*y2))},isOrthogonal:function(x1,y1,x2,y2){return Math.abs(x1*x2+y1*y2)<=1E-8*Math.sqrt((x1*x1+y1*y1)*(x2*x2+y2*y2))}}},Base.each(["round","ceil","floor","abs"],function(key){var op=Math[key];this[key]=function(){return new Point(op(this.x),op(this.y))}},{})),LinkedPoint=Point.extend({initialize:function(x,y,owner,setter){this._x=x;this._y=y;this._owner=owner;this._setter=setter},_set:function(x,
y,_dontNotify){this._x=x;this._y=y;if(!_dontNotify)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(x){this._x=x;this._owner[this._setter](this)},getY:function(){return this._y},setY:function(y){this._y=y;this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(selected){this._owner._changeSelection(this._getSelection(),selected)},_getSelection:function(){return"setPosition"===this._setter?
4:0}}),Size=Base.extend({_class:"Size",_readIndex:!0,initialize:function(arg0,arg1){var type=typeof arg0,reading=this.__read,read=0;"number"===type?(type="number"===typeof arg1,this._set(arg0,type?arg1:arg0),reading&&(read=type?2:1)):"undefined"===type||null===arg0?(this._set(0,0),reading&&(read=null===arg0?1:0)):(arg0="string"===type?arg0.split(/[\s,]+/)||[]:arg0,read=1,Array.isArray(arg0)?this._set(+arg0[0],+(1<arg0.length?arg0[1]:arg0[0])):"width"in arg0?this._set(arg0.width||0,arg0.height||0):
"x"in arg0?this._set(arg0.x||0,arg0.y||0):(this._set(0,0),read=0));reading&&(this.__read=read);return this},set:"#initialize",_set:function(width,height){this.width=width;this.height=height;return this},equals:function(size){return size===this||size&&(this.width===size.width&&this.height===size.height||Array.isArray(size)&&this.width===size[0]&&this.height===size[1])||!1},clone:function(){return new Size(this.width,this.height)},toString:function(){var f=Formatter.instance;return"{ width: "+f.number(this.width)+
", height: "+f.number(this.height)+" }"},_serialize:function(options){options=options.formatter;return[options.number(this.width),options.number(this.height)]},add:function(){var size=Size.read(arguments);return new Size(this.width+size.width,this.height+size.height)},subtract:function(){var size=Size.read(arguments);return new Size(this.width-size.width,this.height-size.height)},multiply:function(){var size=Size.read(arguments);return new Size(this.width*size.width,this.height*size.height)},divide:function(){var size=
Size.read(arguments);return new Size(this.width/size.width,this.height/size.height)},modulo:function(){var size=Size.read(arguments);return new Size(this.width%size.width,this.height%size.height)},negate:function(){return new Size(-this.width,-this.height)},isZero:function(){var isZero=Numerical.isZero;return isZero(this.width)&&isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(size1,size2){return new Size(Math.min(size1.width,size2.width),Math.min(size1.height,
size2.height))},max:function(size1,size2){return new Size(Math.max(size1.width,size2.width),Math.max(size1.height,size2.height))},random:function(){return new Size(Math.random(),Math.random())}}},Base.each(["round","ceil","floor","abs"],function(key){var op=Math[key];this[key]=function(){return new Size(op(this.width),op(this.height))}},{})),LinkedSize=Size.extend({initialize:function(width,height,owner,setter){this._width=width;this._height=height;this._owner=owner;this._setter=setter},_set:function(width,
height,_dontNotify){this._width=width;this._height=height;if(!_dontNotify)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(width){this._width=width;this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(height){this._height=height;this._owner[this._setter](this)}}),Rectangle=Base.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(arg0,arg1,arg2,arg3){var args=arguments,type=typeof arg0;
if("number"===type){this._set(arg0,arg1,arg2,arg3);var read=4}else"undefined"===type||null===arg0?(this._set(0,0,0,0),read=null===arg0?1:0):1===args.length&&(Array.isArray(arg0)?(this._set.apply(this,arg0),read=1):undefined!==arg0.x||undefined!==arg0.width?(this._set(arg0.x||0,arg0.y||0,arg0.width||0,arg0.height||0),read=1):undefined===arg0.from&&undefined===arg0.to&&(this._set(0,0,0,0),Base.readSupported(args,this)&&(read=1)));if(undefined===read){type=Point.readNamed(args,"from");var next=Base.peek(args);
read=type.x;type=type.y;if(next&&undefined!==next.x||Base.hasNamed(args,"to")){var to=Point.readNamed(args,"to");next=to.x-read;var height=to.y-type;0>next&&(read=to.x,next=-next);0>height&&(type=to.y,height=-height)}else height=Size.read(args),next=height.width,height=height.height;this._set(read,type,next,height);read=args.__index}if(args=args.__filtered)this.__filtered=args;this.__read&&(this.__read=read);return this},set:"#initialize",_set:function(x,y,width,height){this.x=x;this.y=y;this.width=
width;this.height=height;return this},clone:function(){return new Rectangle(this.x,this.y,this.width,this.height)},equals:function(rect){var rt=Base.isPlainValue(rect)?Rectangle.read(arguments):rect;return rt===this||rt&&this.x===rt.x&&this.y===rt.y&&this.width===rt.width&&this.height===rt.height||!1},toString:function(){var f=Formatter.instance;return"{ x: "+f.number(this.x)+", y: "+f.number(this.y)+", width: "+f.number(this.width)+", height: "+f.number(this.height)+" }"},_serialize:function(options){options=
options.formatter;return[options.number(this.x),options.number(this.y),options.number(this.width),options.number(this.height)]},getPoint:function(_dontLink){return new (_dontLink?Point:LinkedPoint)(this.x,this.y,this,"setPoint")},setPoint:function(){var point=Point.read(arguments);this.x=point.x;this.y=point.y},getSize:function(_dontLink){return new (_dontLink?Size:LinkedSize)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var size=Size.read(arguments),sx=this._sx,sy=this._sy,
w=size.width;size=size.height;sx&&(this.x+=(this.width-w)*sx);sy&&(this.y+=(this.height-size)*sy);this.width=w;this.height=size;this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(left){if(!this._fw){var amount=left-this.x;this.width-=.5===this._sx?2*amount:amount}this.x=left;this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(top){if(!this._fh){var amount=top-this.y;this.height-=.5===this._sy?2*amount:amount}this.y=top;this._sy=this._fh=0},getRight:function(){return this.x+
this.width},setRight:function(right){if(!this._fw){var amount=right-this.x;this.width=.5===this._sx?2*amount:amount}this.x=right-this.width;this._sx=1;this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(bottom){if(!this._fh){var amount=bottom-this.y;this.height=.5===this._sy?2*amount:amount}this.y=bottom-this.height;this._sy=1;this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(x){this._fw||.5===this._sx?this.x=x-this.width/2:(this._sx&&(this.x+=
2*(x-this.x)*this._sx),this.width=2*(x-this.x));this._sx=.5;this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(y){this._fh||.5===this._sy?this.y=y-this.height/2:(this._sy&&(this.y+=2*(y-this.y)*this._sy),this.height=2*(y-this.y));this._sy=.5;this._fh=0},getCenter:function(_dontLink){return new (_dontLink?Point:LinkedPoint)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var point=Point.read(arguments);this.setCenterX(point.x);this.setCenterY(point.y);
return this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(arg){return arg&&undefined!==arg.width||4===(Array.isArray(arg)?arg:arguments).length?this._containsRectangle(Rectangle.read(arguments)):this._containsPoint(Point.read(arguments))},_containsPoint:function(point){var x=point.x;point=point.y;return x>=this.x&&point>=this.y&&x<=this.x+this.width&&point<=this.y+this.height},_containsRectangle:function(rect){var x=
rect.x,y=rect.y;return x>=this.x&&y>=this.y&&x+rect.width<=this.x+this.width&&y+rect.height<=this.y+this.height},intersects:function(){var rect=Rectangle.read(arguments),epsilon=Base.read(arguments)||0;return rect.x+rect.width>this.x-epsilon&&rect.y+rect.height>this.y-epsilon&&rect.x<this.x+this.width+epsilon&&rect.y<this.y+this.height+epsilon},intersect:function(){var rect=Rectangle.read(arguments),x1=Math.max(this.x,rect.x),y1=Math.max(this.y,rect.y);return new Rectangle(x1,y1,Math.min(this.x+this.width,
rect.x+rect.width)-x1,Math.min(this.y+this.height,rect.y+rect.height)-y1)},unite:function(){var rect=Rectangle.read(arguments),x1=Math.min(this.x,rect.x),y1=Math.min(this.y,rect.y);return new Rectangle(x1,y1,Math.max(this.x+this.width,rect.x+rect.width)-x1,Math.max(this.y+this.height,rect.y+rect.height)-y1)},include:function(){var point=Point.read(arguments),x1=Math.min(this.x,point.x),y1=Math.min(this.y,point.y);return new Rectangle(x1,y1,Math.max(this.x+this.width,point.x)-x1,Math.max(this.y+this.height,
point.y)-y1)},expand:function(){var amount=Size.read(arguments),hor=amount.width;amount=amount.height;return new Rectangle(this.x-hor/2,this.y-amount/2,this.width+hor,this.height+amount)},scale:function(hor,ver){return this.expand(this.width*hor-this.width,this.height*(undefined===ver?hor:ver)-this.height)}},Base.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(parts,index){var part=parts.join(""),
xFirst=/^[RL]/.test(part);4<=index&&(parts[1]+=xFirst?"Y":"X");index=parts[xFirst?0:1];parts=parts[xFirst?1:0];var getX="get"+index,getY="get"+parts,setX="set"+index,setY="set"+parts,set="set"+part;this["get"+part]=function(_dontLink){return new (_dontLink?Point:LinkedPoint)(this[getX](),this[getY](),this,set)};this[set]=function(){var point=Point.read(arguments);this[setX](point.x);this[setY](point.y)}},{beans:!0})),LinkedRectangle=Rectangle.extend({initialize:function(x,y,width,height,owner,setter){this._set(x,
y,width,height,!0);this._owner=owner;this._setter=setter},_set:function(x,y,width,height,_dontNotify){this._x=x;this._y=y;this._width=width;this._height=height;if(!_dontNotify)this._owner[this._setter](this);return this}},new function(){var proto=Rectangle.prototype;return Base.each(["x","y","width","height"],function(key){var part=Base.capitalize(key),internal="_"+key;this["get"+part]=function(){return this[internal]};this["set"+part]=function(value){this[internal]=value;if(!this._dontNotify)this._owner[this._setter](this)}},
Base.each("Point Size Center Left Top Right Bottom CenterX CenterY TopLeft TopRight BottomLeft BottomRight LeftCenter TopCenter RightCenter BottomCenter".split(" "),function(key){var name="set"+key;this[name]=function(){this._dontNotify=!0;proto[name].apply(this,arguments);this._dontNotify=!1;this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(selected){var owner=this._owner;owner._changeSelection&&owner._changeSelection(2,selected)}}))}),
Matrix=Base.extend({_class:"Matrix",initialize:function Matrix(arg,_dontNotify){var args=arguments,count=args.length,ok=!0;6<=count?this._set.apply(this,args):1===count||2===count?arg instanceof Matrix?this._set(arg._a,arg._b,arg._c,arg._d,arg._tx,arg._ty,_dontNotify):Array.isArray(arg)?this._set.apply(this,_dontNotify?arg.concat([_dontNotify]):arg):ok=!1:count?ok=!1:this.reset();if(!ok)throw Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(a,b,c,d,tx,ty,_dontNotify){this._a=
a;this._b=b;this._c=c;this._d=d;this._tx=tx;this._ty=ty;_dontNotify||this._changed();return this},_serialize:function(options,dictionary){return Base.serialize(this.getValues(),options,!0,dictionary)},_changed:function(){var owner=this._owner;owner&&(owner._applyMatrix?owner.transform(null,!0):owner._changed(25))},clone:function(){return new Matrix(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(mx){return mx===this||mx&&this._a===mx._a&&this._b===mx._b&&this._c===mx._c&&this._d===
mx._d&&this._tx===mx._tx&&this._ty===mx._ty},toString:function(){var f=Formatter.instance;return"[["+[f.number(this._a),f.number(this._c),f.number(this._tx)].join(", ")+"], ["+[f.number(this._b),f.number(this._d),f.number(this._ty)].join(", ")+"]]"},reset:function(_dontNotify){this._a=this._d=1;this._b=this._c=this._tx=this._ty=0;_dontNotify||this._changed();return this},apply:function(recursively,_setApplyMatrix){var owner=this._owner;return owner?(owner.transform(null,Base.pick(recursively,!0),
_setApplyMatrix),this.isIdentity()):!1},translate:function(){var point=Point.read(arguments),x=point.x;point=point.y;this._tx+=x*this._a+point*this._c;this._ty+=x*this._b+point*this._d;this._changed();return this},scale:function(){var args=arguments,scale=Point.read(args);(args=Point.read(args,0,{readNull:!0}))&&this.translate(args);this._a*=scale.x;this._b*=scale.x;this._c*=scale.y;this._d*=scale.y;args&&this.translate(args.negate());this._changed();return this},rotate:function(angle){angle*=Math.PI/
180;var center=Point.read(arguments,1),x=center.x,y=center.y;center=Math.cos(angle);var sin=Math.sin(angle),tx=x-x*center+y*sin;x=y-x*sin-y*center;y=this._a;var b=this._b,c=this._c,d=this._d;this._a=center*y+sin*c;this._b=center*b+sin*d;this._c=-sin*y+center*c;this._d=-sin*b+center*d;this._tx+=tx*y+x*c;this._ty+=tx*b+x*d;this._changed();return this},shear:function(){var args=arguments,shear=Point.read(args);(args=Point.read(args,0,{readNull:!0}))&&this.translate(args);var a=this._a,b=this._b;this._a+=
shear.y*this._c;this._b+=shear.y*this._d;this._c+=shear.x*a;this._d+=shear.x*b;args&&this.translate(args.negate());this._changed();return this},skew:function(){var args=arguments,skew=Point.read(args);args=Point.read(args,0,{readNull:!0});var toRadians=Math.PI/180;skew=new Point(Math.tan(skew.x*toRadians),Math.tan(skew.y*toRadians));return this.shear(skew,args)},append:function(mx,_dontNotify){if(mx){var a1=this._a,b1=this._b,c1=this._c,d1=this._d,a2=mx._a,b2=mx._c,c2=mx._b,d2=mx._d,tx2=mx._tx;mx=
mx._ty;this._a=a2*a1+c2*c1;this._c=b2*a1+d2*c1;this._b=a2*b1+c2*d1;this._d=b2*b1+d2*d1;this._tx+=tx2*a1+mx*c1;this._ty+=tx2*b1+mx*d1;_dontNotify||this._changed()}return this},prepend:function(mx,_dontNotify){if(mx){var a1=this._a,b1=this._b,c1=this._c,d1=this._d,tx1=this._tx,ty1=this._ty,a2=mx._a,b2=mx._c,c2=mx._b,d2=mx._d,tx2=mx._tx;mx=mx._ty;this._a=a2*a1+b2*b1;this._c=a2*c1+b2*d1;this._b=c2*a1+d2*b1;this._d=c2*c1+d2*d1;this._tx=a2*tx1+b2*ty1+tx2;this._ty=c2*tx1+d2*ty1+mx;_dontNotify||this._changed()}return this},
appended:function(mx){return this.clone().append(mx)},prepended:function(mx){return this.clone().prepend(mx)},invert:function(){var a=this._a,b=this._b,c=this._c,d=this._d,tx=this._tx,ty=this._ty,det=a*d-b*c,res=null;det&&!isNaN(det)&&isFinite(tx)&&isFinite(ty)&&(this._a=d/det,this._b=-b/det,this._c=-c/det,this._d=a/det,this._tx=(c*ty-d*tx)/det,this._ty=(b*tx-a*ty)/det,res=this);return res},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",
_shiftless:function(){return new Matrix(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var det=this._a*this._d-this._c*this._b;return det&&!isNaN(det)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(src,dst,count){return 3>arguments.length?this._transformPoint(Point.read(arguments)):
this._transformCoordinates(src,dst,count)},_transformPoint:function(point,dest,_dontNotify){var x=point.x;point=point.y;dest||(dest=new Point);return dest._set(x*this._a+point*this._c+this._tx,x*this._b+point*this._d+this._ty,_dontNotify)},_transformCoordinates:function(src,dst,count){var i=0;for(count*=2;i<count;i+=2){var x=src[i],y=src[i+1];dst[i]=x*this._a+y*this._c+this._tx;dst[i+1]=x*this._b+y*this._d+this._ty}return dst},_transformCorners:function(rect){var x1=rect.x,y1=rect.y,x2=x1+rect.width;
rect=y1+rect.height;x1=[x1,y1,x2,y1,x2,rect,x1,rect];return this._transformCoordinates(x1,x1,4)},_transformBounds:function(bounds,dest,_dontNotify){bounds=this._transformCorners(bounds);for(var min=bounds.slice(0,2),max=min.slice(),i=2;8>i;i++){var val=bounds[i],j=i&1;val<min[j]?min[j]=val:val>max[j]&&(max[j]=val)}dest||(dest=new Rectangle);return dest._set(min[0],min[1],max[0]-min[0],max[1]-min[1],_dontNotify)},inverseTransform:function(){return this._inverseTransform(Point.read(arguments))},_inverseTransform:function(point,
dest,_dontNotify){var a=this._a,b=this._b,c=this._c,d=this._d,tx=this._tx,ty=this._ty,det=a*d-b*c,res=null;det&&!isNaN(det)&&isFinite(tx)&&isFinite(ty)&&(tx=point.x-this._tx,point=point.y-this._ty,dest||(dest=new Point),res=dest._set((tx*d-point*c)/det,(point*a-tx*b)/det,_dontNotify));return res},decompose:function(){var a=this._a,b=this._b,c=this._c,d=this._d,det=a*d-b*c,sqrt=Math.sqrt,atan2=Math.atan2,degrees=180/Math.PI;if(0!==a||0!==b){var r=sqrt(a*a+b*b);sqrt=Math.acos(a/r)*(0<b?1:-1);det=[r,
det/r];a=[atan2(a*c+b*d,r*r),0]}else 0!==c||0!==d?(r=sqrt(c*c+d*d),sqrt=Math.asin(c/r)*(0<d?1:-1),det=[det/r,r],a=[0,atan2(a*c+b*d,r*r)]):(sqrt=0,a=det=[0,0]);return{translation:this.getTranslation(),rotation:sqrt*degrees,scaling:new Point(det),skewing:new Point(a[0]*degrees,a[1]*degrees)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new Point(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},
applyToContext:function(ctx){this.isIdentity()||ctx.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},Base.each("a b c d tx ty".split(" "),function(key){var part=Base.capitalize(key),prop="_"+key;this["get"+part]=function(){return this[prop]};this["set"+part]=function(value){this[prop]=value;this._changed()}},{})),Line=Base.extend({_class:"Line",initialize:function(arg0,arg1,arg2,arg3,arg4){if(4<=arguments.length){this._px=arg0;this._py=arg1;this._vx=arg2;this._vy=arg3;var asVector=arg4}else this._px=
arg0.x,this._py=arg0.y,this._vx=arg1.x,this._vy=arg1.y,asVector=arg2;asVector||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new Point(this._px,this._py)},getVector:function(){return new Point(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(line,isInfinite){return Line.intersect(this._px,this._py,this._vx,this._vy,line._px,line._py,line._vx,line._vy,!0,isInfinite)},getSide:function(point,isInfinite){return Line.getSide(this._px,
this._py,this._vx,this._vy,point.x,point.y,!0,isInfinite)},getDistance:function(point){return Math.abs(this.getSignedDistance(point))},getSignedDistance:function(point){return Line.getSignedDistance(this._px,this._py,this._vx,this._vy,point.x,point.y,!0)},isCollinear:function(line){return Point.isCollinear(this._vx,this._vy,line._vx,line._vy)},isOrthogonal:function(line){return Point.isOrthogonal(this._vx,this._vy,line._vx,line._vy)},statics:{intersect:function(p1x,p1y,v1x,v1y,p2x,p2y,v2x,v2y,asVector,
isInfinite){asVector||(v1x-=p1x,v1y-=p1y,v2x-=p2x,v2y-=p2y);asVector=v1x*v2y-v1y*v2x;if(!Numerical.isMachineZero(asVector)&&(p2x=p1x-p2x,p2y=p1y-p2y,v2x=(v2x*p2y-v2y*p2x)/asVector,v2y=(v1x*p2y-v1y*p2x)/asVector,asVector=1+1E-12,isInfinite||-1E-12<v2x&&v2x<asVector&&-1E-12<v2y&&v2y<asVector))return isInfinite||(v2x=0>=v2x?0:1<=v2x?1:v2x),new Point(p1x+v2x*v1x,p1y+v2x*v1y)},getSide:function(px,py,vx,vy,x,y,asVector,isInfinite){asVector||(vx-=px,vy-=py);px=x-px;py=px*vy-(y-py)*vx;!isInfinite&&Numerical.isMachineZero(py)&&
(py=(px*vx+px*vx)/(vx*vx+vy*vy),0<=py&&1>=py&&(py=0));return 0>py?-1:0<py?1:0},getSignedDistance:function(px,py,vx,vy,x,y,asVector){asVector||(vx-=px,vy-=py);return 0===vx?0<vy?x-px:px-x:0===vy?0>vx?y-py:py-y:((x-px)*vy-(y-py)*vx)/(vy>vx?vy*Math.sqrt(1+vx*vx/(vy*vy)):vx*Math.sqrt(1+vy*vy/(vx*vx)))},getDistance:function(px,py,vx,vy,x,y,asVector){return Math.abs(Line.getSignedDistance(px,py,vx,vy,x,y,asVector))}}}),Project=PaperScopeItem.extend({_class:"Project",_list:"projects",_reference:"project",
_compactSerialize:!0,initialize:function(element){PaperScopeItem.call(this,!0);this._children=[];this._namedChildren={};this._activeLayer=null;this._currentStyle=new Style(null,null,this);this._view=View.create(this,element||CanvasProvider.getCanvas(1,1));this._selectionItems={};this._updateVersion=this._selectionCount=0},_serialize:function(options,dictionary){return Base.serialize(this._children,options,!0,dictionary)},_changed:function(flags,item){if(flags&1){var view=this._view;view&&(view._needsUpdate=
!0,!view._requested&&view._autoUpdate&&view.requestUpdate())}if((view=this._changes)&&item){var changesById=this._changesById,id=item._id,entry=changesById[id];entry?entry.flags|=flags:view.push(changesById[id]={item:item,flags:flags})}},clear:function(){for(var children=this._children,i=children.length-1;0<=i;i--)children[i].remove()},isEmpty:function(){return!this._children.length},remove:function remove(){if(!remove.base.call(this))return!1;this._view&&this._view.remove();return!0},getView:function(){return this._view},
getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(style){this._currentStyle.set(style)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new Layer({project:this,insert:!0})},getSymbolDefinitions:function(){var definitions=[],ids={};this.getItems({class:SymbolItem,match:function(item){item=item._definition;var id=item._id;ids[id]||(ids[id]=
!0,definitions.push(item));return!1}});return definitions},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var selectionItems=this._selectionItems,items=[],id;for(id in selectionItems){var item=selectionItems[id],selection=item._selection;selection&1&&item.isInserted()?items.push(item):selection||this._updateSelection(item)}return items},_updateSelection:function(item){var id=item._id,selectionItems=this._selectionItems;item._selection?selectionItems[id]!==item&&(this._selectionCount++,
selectionItems[id]=item):selectionItems[id]===item&&(this._selectionCount--,delete selectionItems[id])},selectAll:function(){for(var children=this._children,i=0,l=children.length;i<l;i++)children[i].setFullySelected(!0)},deselectAll:function(){var selectionItems=this._selectionItems,i;for(i in selectionItems)selectionItems[i].setFullySelected(!1)},addLayer:function(layer){return this.insertLayer(undefined,layer)},insertLayer:function(index,layer){layer instanceof Layer?(layer._remove(!1,!0),Base.splice(this._children,
[layer],index,0),layer._setProject(this,!0),(index=layer._name)&&layer.setName(index),this._changes&&layer._changed(5),this._activeLayer||(this._activeLayer=layer)):layer=null;return layer},_insertItem:function(index,item,_created){item=this.insertLayer(index,item)||(this._activeLayer||this._insertItem(undefined,new Layer(Item.NO_INSERT),!0)).insertChild(index,item);_created&&item.activate&&item.activate();return item},getItems:function(options){return Item._getItems(this,options)},getItem:function(options){return Item._getItems(this,
options,null,null,!0)[0]||null},importJSON:function(json){this.activate();var layer=this._activeLayer;return Base.importJSON(json,layer&&layer.isEmpty()&&layer)},removeOn:function(type){var sets=this._removeSets;if(sets){"mouseup"===type&&(sets.mousedrag=null);var set=sets[type];if(set){for(var id in set){var item=set[id],key;for(key in sets){var other=sets[key];other&&other!=set&&delete other[item._id]}item.remove()}sets[type]=null}}},draw:function(ctx,matrix,pixelRatio){this._updateVersion++;ctx.save();
matrix.applyToContext(ctx);var children=this._children;pixelRatio=new Base({offset:new Point(0,0),pixelRatio:pixelRatio,viewMatrix:matrix.isIdentity()?null:matrix,matrices:[new Matrix],updateMatrix:!0});for(var i=0,l=children.length;i<l;i++)children[i].draw(ctx,pixelRatio);ctx.restore();if(0<this._selectionCount){ctx.save();ctx.strokeWidth=1;children=this._selectionItems;pixelRatio=this._scope.settings.handleSize;i=this._updateVersion;for(var id in children)children[id]._drawSelection(ctx,matrix,
pixelRatio,children,i);ctx.restore()}}}),Item=Base.extend(Emitter,{statics:{extend:function extend(src){src._serializeFields&&(src._serializeFields=Base.set({},this.prototype._serializeFields,src._serializeFields));return extend.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,
applyMatrix:null,matrix:new Matrix,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var handlers="onMouseDown onMouseUp onMouseDrag onClick onDoubleClick onMouseMove onMouseEnter onMouseLeave".split(" ");return Base.each(handlers,function(name){this._events[name]={install:function(type){this.getView()._countItemEvent(type,1)},uninstall:function(type){this.getView()._countItemEvent(type,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,
!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:handlers}})},{initialize:function(){},_initialize:function(props,point){var hasProps=props&&Base.isPlainObject(props),internal=hasProps&&!0===props.internal,matrix=this._matrix=new Matrix,project=hasProps&&props.project||paper.project,settings=paper.settings;this._id=internal?null:UID.get();this._parent=this._index=null;this._applyMatrix=this._canApplyMatrix&&settings.applyMatrix;point&&matrix.translate(point);
matrix._owner=this;this._style=new Style(project._currentStyle,this,project);internal||hasProps&&0==props.insert||!(settings.insertItems||hasProps&&!0===props.insert)?this._setProject(project):(hasProps&&props.parent||project)._insertItem(undefined,this,!0);hasProps&&props!==Item.NO_INSERT&&this.set(props,{internal:!0,insert:!0,project:!0,parent:!0});return hasProps},_serialize:function(options,dictionary){function serialize(fields){for(var key in fields){var value=that[key];Base.equals(value,"leading"===
key?1.2*fields.fontSize:fields[key])||(props[key]=Base.serialize(value,options,"data"!==key,dictionary))}}var props={},that=this;serialize(this._serializeFields);this instanceof Group||serialize(this._style._defaults);return[this._class,props]},_changed:function(flags){var symbol=this._symbol,cacheParent=this._parent||symbol,project=this._project;flags&8&&(this._bounds=this._position=this._decomposed=undefined);flags&16&&(this._globalMatrix=undefined);cacheParent&&flags&72&&Item._clearBoundsCache(cacheParent);
flags&2&&Item._clearBoundsCache(this);project&&project._changed(flags,this);symbol&&symbol._changed(flags)},getId:function(){return this._id},getName:function(){return this._name},setName:function(name){this._name&&this._removeNamed();if(name===+name+"")throw Error("Names consisting only of numbers are not supported.");var owner=this._getOwner();if(name&&owner){var children=owner._children;owner=owner._namedChildren;(owner[name]=owner[name]||[]).push(this);name in children||(children[name]=this)}this._name=
name||undefined;this._changed(256)},getStyle:function(){return this._style},setStyle:function(style){this.getStyle().set(style)}},Base.each(["locked","visible","blendMode","opacity","guide"],function(name){var part=Base.capitalize(name),key="_"+name,flags={locked:256,visible:265};this["get"+part]=function(){return this[key]};this["set"+part]=function(value){value!=this[key]&&(this[key]=value,this._changed(flags[name]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(selection){selection!==
this._selection&&(this._selection=selection,selection=this._project)&&(selection._updateSelection(this),this._changed(257))},_changeSelection:function(flag,selected){var selection=this._selection;this.setSelection(selected?selection|flag:selection&~flag)},isSelected:function(){if(this._selectChildren)for(var children=this._children,i=0,l=children.length;i<l;i++)if(children[i].isSelected())return!0;return!!(this._selection&1)},setSelected:function(selected){if(this._selectChildren)for(var children=
this._children,i=0,l=children.length;i<l;i++)children[i].setSelected(selected);this._changeSelection(1,selected)},isFullySelected:function(){var children=this._children,selected=!!(this._selection&1);if(children&&selected){selected=0;for(var l=children.length;selected<l;selected++)if(!children[selected].isFullySelected())return!1;return!0}return selected},setFullySelected:function(selected){var children=this._children;if(children)for(var i=0,l=children.length;i<l;i++)children[i].setFullySelected(selected);
this._changeSelection(1,selected)},isClipMask:function(){return this._clipMask},setClipMask:function(clipMask){if(this._clipMask!=(clipMask=!!clipMask)){if(this._clipMask=clipMask)this.setFillColor(null),this.setStrokeColor(null);this._changed(257);this._parent&&this._parent._changed(2048)}},getData:function(){this._data||(this._data={});return this._data},setData:function(data){this._data=data},getPosition:function(_dontLink){_dontLink=_dontLink?Point:LinkedPoint;var position=this._position||(this._position=
this._getPositionFromBounds());return new _dontLink(position.x,position.y,this,"setPosition")},setPosition:function(){this.translate(Point.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(bounds){return this._pivot?this._matrix._transformPoint(this._pivot):(bounds||this.getBounds()).getCenter(!0)},getPivot:function(){var pivot=this._pivot;return pivot?new LinkedPoint(pivot.x,pivot.y,this,"setPivot"):null},setPivot:function(){this._pivot=Point.read(arguments,0,{clone:!0,
readNull:!0});this._position=undefined}},Base.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(options,key){this[key]=function(matrix){return this.getBounds(matrix,options)}},{beans:!0,getBounds:function(matrix,options){var hasMatrix=options||matrix instanceof Matrix,opts=Base.set({},hasMatrix?options:matrix,this._boundsOptions);if(!opts.stroke||this.getStrokeScaling())opts.cacheItem=this;hasMatrix=this._getCachedBounds(hasMatrix&&matrix,opts).rect;
return arguments.length?hasMatrix:new LinkedRectangle(hasMatrix.x,hasMatrix.y,hasMatrix.width,hasMatrix.height,this,"setBounds")},setBounds:function(){var rect=Rectangle.read(arguments),bounds=this.getBounds(),_matrix=this._matrix,matrix=new Matrix,center=rect.getCenter();matrix.translate(center);if(rect.width!=bounds.width||rect.height!=bounds.height)_matrix.isInvertible()||(_matrix.set(_matrix._backup||(new Matrix).translate(_matrix.getTranslation())),bounds=this.getBounds()),matrix.scale(0!==bounds.width?
rect.width/bounds.width:0,0!==bounds.height?rect.height/bounds.height:0);center=bounds.getCenter();matrix.translate(-center.x,-center.y);this.transform(matrix)},_getBounds:function(matrix,options){var children=this._children;if(!children||!children.length)return new Rectangle;Item._updateBoundsCache(this,options.cacheItem);return Item._getBounds(children,matrix,options)},_getBoundsCacheKey:function(options,internal){return[options.stroke?1:0,options.handle?1:0,internal?1:0].join("")},_getCachedBounds:function(matrix,
options,noInternal){matrix=matrix&&matrix._orNullIfIdentity();noInternal=options.internal&&!noInternal;var cacheItem=options.cacheItem,_matrix=noInternal?null:this._matrix._orNullIfIdentity(),cacheKey=cacheItem&&(!matrix||matrix.equals(_matrix))&&this._getBoundsCacheKey(options,noInternal),bounds=this._bounds;Item._updateBoundsCache(this._parent||this._symbol,cacheItem);if(cacheKey&&bounds&&cacheKey in bounds)return noInternal=bounds[cacheKey],{rect:noInternal.rect.clone(),nonscaling:noInternal.nonscaling};
options=this._getBounds(matrix||_matrix,options);matrix=options.rect||options;cacheItem=this._style;options=options.nonscaling||cacheItem.hasStroke()&&!cacheItem.getStrokeScaling();cacheKey&&(bounds||(this._bounds=bounds={}),bounds[cacheKey]={rect:matrix.clone(),nonscaling:options,internal:noInternal});return{rect:matrix,nonscaling:options}},_getStrokeMatrix:function(matrix,options){return(matrix=(options=this.getStrokeScaling()?null:options&&options.internal?this:this._parent||this._symbol&&this._symbol._item)?
options.getViewMatrix().invert():matrix)&&matrix._shiftless()},statics:{_updateBoundsCache:function(parent,item){if(parent&&item){var id=item._id;parent=parent._boundsCache=parent._boundsCache||{ids:{},list:[]};parent.ids[id]||(parent.list.push(item),parent.ids[id]=item)}},_clearBoundsCache:function(item){var cache=item._boundsCache;if(cache){item._bounds=item._position=item._boundsCache=undefined;var i=0;cache=cache.list;for(var l=cache.length;i<l;i++){var other=cache[i];other!==item&&(other._bounds=
other._position=undefined,other._boundsCache&&Item._clearBoundsCache(other))}}},_getBounds:function(items,matrix,options){var x1=Infinity,x2=-x1,y1=x1,y2=x2,nonscaling=!1;options=options||{};for(var i=0,l=items.length;i<l;i++){var item=items[i];if(item._visible&&!item.isEmpty(!0)){item=item._getCachedBounds(matrix&&matrix.appended(item._matrix),options,!0);var rect=item.rect;x1=Math.min(rect.x,x1);y1=Math.min(rect.y,y1);x2=Math.max(rect.x+rect.width,x2);y2=Math.max(rect.y+rect.height,y2);item.nonscaling&&
(nonscaling=!0)}}return{rect:isFinite(x1)?new Rectangle(x1,y1,x2-x1,y2-y1):new Rectangle,nonscaling:nonscaling}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var decomposed=this._decompose();return decomposed?decomposed.rotation:0},setRotation:function(rotation){var current=this.getRotation();if(null!=current&&null!=rotation){var decomposed=this._decomposed;this.rotate(rotation-current);decomposed&&
(decomposed.rotation=rotation,this._decomposed=decomposed)}},getScaling:function(){var decomposed=this._decompose();decomposed=decomposed&&decomposed.scaling;return new LinkedPoint(decomposed?decomposed.x:1,decomposed?decomposed.y:1,this,"setScaling")},setScaling:function(){var current=this.getScaling(),scaling=Point.read(arguments,0,{clone:!0,readNull:!0});if(current&&scaling&&!current.equals(scaling)){var rotation=this.getRotation(),decomposed=this._decomposed,matrix=new Matrix,center=this.getPosition(!0);
matrix.translate(center);rotation&&matrix.rotate(rotation);matrix.scale(scaling.x/current.x,scaling.y/current.y);rotation&&matrix.rotate(-rotation);matrix.translate(center.negate());this.transform(matrix);decomposed&&(decomposed.scaling=scaling,this._decomposed=decomposed)}},getMatrix:function(){return this._matrix},setMatrix:function(){var matrix=this._matrix;matrix.initialize.apply(matrix,arguments)},getGlobalMatrix:function(_dontClone){var matrix=this._globalMatrix;if(matrix)for(var parent=this._parent,
parents=[];parent;){if(!parent._globalMatrix){matrix=null;parent=0;for(var l=parents.length;parent<l;parent++)parents[parent]._globalMatrix=null;break}parents.push(parent);parent=parent._parent}matrix||(matrix=this._globalMatrix=this._matrix.clone(),(parent=this._parent)&&matrix.prepend(parent.getGlobalMatrix(!0)));return _dontClone?matrix:matrix.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(apply){(this._applyMatrix=
this._canApplyMatrix&&!!apply)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(project,installEvents){if(this._project!==project){this._project&&this._installEvents(!1);this._project=project;installEvents=this._children;for(var i=0,l=installEvents&&installEvents.length;i<l;i++)installEvents[i]._setProject(project);installEvents=!0}installEvents&&this._installEvents(!0)},getView:function(){return this._project._view},
_installEvents:function _installEvents(install){_installEvents.base.call(this,install);for(var children=this._children,i=0,l=children&&children.length;i<l;i++)children[i]._installEvents(install)},getLayer:function(){for(var parent=this;parent=parent._parent;)if(parent instanceof Layer)return parent;return null},getParent:function(){return this._parent},setParent:function(item){return item.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(items){this.removeChildren();
this.addChildren(items)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var owner=this._getOwner();return owner&&owner._children[this._index+1]||null},getPreviousSibling:function(){var owner=this._getOwner();return owner&&owner._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(item){return item===this||item&&this._class===
item._class&&this._style.equals(item._style)&&this._matrix.equals(item._matrix)&&this._locked===item._locked&&this._visible===item._visible&&this._blendMode===item._blendMode&&this._opacity===item._opacity&&this._clipMask===item._clipMask&&this._guide===item._guide&&this._equals(item)||!1},_equals:function(item){return Base.equals(this._children,item._children)},clone:function(options){var copy=new this.constructor(Item.NO_INSERT),children=this._children,insert=Base.pick(options?options.insert:undefined,
undefined===options||!0===options);options=Base.pick(options?options.deep:undefined,!0);children&&copy.copyAttributes(this);children&&!options||copy.copyContent(this);children||copy.copyAttributes(this);insert&&copy.insertAbove(this);insert=this._name;children=this._parent;if(insert&&children){children=children._children;options=insert;for(var i=1;children[insert];)insert=options+" "+i++;insert!==options&&copy.setName(insert)}return copy},copyContent:function(source){source=source._children;for(var i=
0,l=source&&source.length;i<l;i++)this.addChild(source[i].clone(!1),!0)},copyAttributes:function(source,excludeMatrix){this.setStyle(source._style);for(var keys="_locked _visible _blendMode _opacity _clipMask _guide".split(" "),i=0,l=keys.length;i<l;i++){var key=keys[i];source.hasOwnProperty(key)&&(this[key]=source[key])}excludeMatrix||this._matrix.set(source._matrix,!0);this.setApplyMatrix(source._applyMatrix);this.setPivot(source._pivot);this.setSelection(source._selection);excludeMatrix=source._data;
source=source._name;this._data=excludeMatrix?Base.clone(excludeMatrix):null;source&&this.setName(source)},rasterize:function(resolution,insert){var bounds=this.getStrokeBounds();resolution=(resolution||this.getView().getResolution())/72;var topLeft=bounds.getTopLeft().floor();bounds=bounds.getBottomRight().ceil();bounds=new Size(bounds.subtract(topLeft));var raster=new Raster(Item.NO_INSERT);if(!bounds.isZero()){var canvas=CanvasProvider.getCanvas(bounds.multiply(resolution)),ctx=canvas.getContext("2d"),
matrix=(new Matrix).scale(resolution).translate(topLeft.negate());ctx.save();matrix.applyToContext(ctx);this.draw(ctx,new Base({matrices:[matrix]}));ctx.restore();raster.setCanvas(canvas)}raster.transform((new Matrix).translate(topLeft.add(bounds.divide(2))).scale(1/resolution));(undefined===insert||insert)&&raster.insertAbove(this);return raster},contains:function(){var matrix=this._matrix;return matrix.isInvertible()&&!!this._contains(matrix._inverseTransform(Point.read(arguments)))},_contains:function(point){var children=
this._children;if(children){for(var i=children.length-1;0<=i;i--)if(children[i].contains(point))return!0;return!1}return point.isInside(this.getInternalBounds())},isInside:function(){return Rectangle.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Path.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(item,_matrix){return item instanceof Item?0<this._asPathItem().getIntersections(item._asPathItem(),null,_matrix,!0).length:
!1}},new function(){function hitTest(){var args=arguments;return this._hitTest(Point.read(args),HitResult.getOptions(args))}function hitTestAll(){var args=arguments,point=Point.read(args);args=HitResult.getOptions(args);var all=[];this._hitTest(point,new Base({all:all},args));return all}function hitTestChildren(point,options,viewMatrix,_exclude){var children=this._children;if(children)for(var i=children.length-1;0<=i;i--){var child=children[i];if((child=child!==_exclude&&child._hitTest(point,options,
viewMatrix))&&!options.all)return child}return null}Project.inject({hitTest:hitTest,hitTestAll:hitTestAll,_hitTest:hitTestChildren});return{hitTest:hitTest,hitTestAll:hitTestAll,_hitTestChildren:hitTestChildren}},{_hitTest:function(point,options,parentViewMatrix){function filter(hit){hit&&match&&!match(hit)&&(hit=null);hit&&options.all&&options.all.push(hit);return hit}function checkPoint(type,part){var pt=part?bounds["get"+part]():that.getPosition();if(1>=point.subtract(pt).divide(tolerancePadding).length)return new HitResult(type,
that,{name:part?Base.hyphenate(part):type,point:pt})}if(this._locked||!this._visible||this._guide&&!options.guides||this.isEmpty())return null;var matrix=this._matrix;parentViewMatrix=parentViewMatrix?parentViewMatrix.appended(matrix):this.getGlobalMatrix().prepend(this.getView()._matrix);var tolerancePadding=options._tolerancePadding=new Size(Path._getStrokePadding(Math.max(options.tolerance,1E-12),matrix._shiftless().invert()));point=matrix._inverseTransform(point);if(!point||!this._children&&!this.getBounds({internal:!0,
stroke:!0,handle:!0}).expand(tolerancePadding.multiply(2))._containsPoint(point))return null;var checkSelf=!(options.guides&&!this._guide||options.selected&&!this.isSelected()||options.type&&options.type!==Base.hyphenate(this._class)||options.class&&!(this instanceof options.class)),match=options.match,that=this,checkPosition=options.position,checkCenter=options.center,checkBounds=options.bounds;if(checkSelf&&this._parent&&(checkPosition||checkCenter||checkBounds)){if(checkCenter||checkBounds)var bounds=
this.getInternalBounds();var res=checkPosition&&checkPoint("position")||checkCenter&&checkPoint("center","Center");if(!res&&checkBounds)for(checkPosition="TopLeft TopRight BottomLeft BottomRight LeftCenter TopCenter RightCenter BottomCenter".split(" "),checkCenter=0;8>checkCenter&&!res;checkCenter++)res=checkPoint("bounds",checkPosition[checkCenter]);res=filter(res)}res||(res=this._hitTestChildren(point,options,parentViewMatrix)||checkSelf&&filter(this._hitTestSelf(point,options,parentViewMatrix,
this.getStrokeScaling()?null:parentViewMatrix._shiftless().invert()))||null);res&&res.point&&(res.point=matrix.transform(res.point));return res},_hitTestSelf:function(point,options){if(options.fill&&this.hasFill()&&this._contains(point))return new HitResult("fill",this)},matches:function(name,compare){function matchObject(obj1,obj2){for(var i in obj1)if(obj1.hasOwnProperty(i)){var val1=obj1[i],val2=obj2[i];if(Base.isPlainObject(val1)&&Base.isPlainObject(val2)){if(!matchObject(val1,val2))return!1}else if(!Base.equals(val1,
val2))return!1}return!0}var type=typeof name;if("object"===type){for(var key in name)if(name.hasOwnProperty(key)&&!this.matches(key,name[key]))return!1;return!0}if("function"===type)return name(this);if("match"===name)return compare(this);type=/^(empty|editable)$/.test(name)?this["is"+Base.capitalize(name)]():"type"===name?Base.hyphenate(this._class):this[name];if("class"===name){if("function"===typeof compare)return this instanceof compare;type=this._class}if("function"===typeof compare)return!!compare(type);
if(compare){if(compare.test)return compare.test(type);if(Base.isPlainObject(compare))return matchObject(compare,type)}return Base.equals(type,compare)},getItems:function(options){return Item._getItems(this,options,this._matrix)},getItem:function(options){return Item._getItems(this,options,this._matrix,null,!0)[0]||null},statics:{_getItems:function _getItems(item,options,matrix,param,firstOnly){if(!param){var obj="object"===typeof options&&options;param=obj&&obj.overlapping;var inside=obj&&obj.inside,
bounds=param||inside,rect=bounds&&Rectangle.read([bounds]);param={items:[],recursive:obj&&!1!==obj.recursive,inside:!!inside,overlapping:!!param,rect:rect,path:param&&new Path.Rectangle({rectangle:rect,insert:!1})};obj&&(options=Base.filter({},options,{recursive:!0,inside:!0,overlapping:!0}))}item=item._children;obj=param.items;matrix=(rect=param.rect)&&(matrix||new Matrix);inside=0;for(var l=item&&item.length;inside<l;inside++){var child=item[inside],childMatrix=matrix&&matrix.appended(child._matrix),
add=!0;if(rect){bounds=child.getBounds(childMatrix);if(!rect.intersects(bounds))continue;rect.contains(bounds)||param.overlapping&&(bounds.contains(rect)||param.path.intersects(child,childMatrix))||(add=!1)}if(add&&child.matches(options)&&(obj.push(child),firstOnly))break;!1!==param.recursive&&_getItems(child,options,childMatrix,param,firstOnly);if(firstOnly&&0<obj.length)break}return obj}}},{importJSON:function(json){json=Base.importJSON(json,this);return json!==this?this.addChild(json):json},addChild:function(item){return this.insertChild(undefined,
item)},insertChild:function(index,item){return(index=item?this.insertChildren(index,[item]):null)&&index[0]},addChildren:function(items){return this.insertChildren(this._children.length,items)},insertChildren:function(index,items){var children=this._children;if(children&&items&&0<items.length){items=Base.slice(items);for(var inserted={},i=items.length-1;0<=i;i--){var item=items[i],id=item&&item._id;!item||inserted[id]?items.splice(i,1):(item._remove(!1,!0),inserted[id]=!0)}Base.splice(children,items,
index,0);index=this._project;children=index._changes;i=0;for(inserted=items.length;i<inserted;i++)item=items[i],id=item._name,item._parent=this,item._setProject(index,!0),id&&item.setName(id),children&&item._changed(5);this._changed(11)}else items=null;return items},_insertItem:"#insertChild",_insertAt:function(item,offset){var owner=item&&item._getOwner(),res=item!==this&&owner?this:null;res&&(res._remove(!1,!0),owner._insertItem(item._index+offset,res));return res},insertAbove:function(item){return this._insertAt(item,
1)},insertBelow:function(item){return this._insertAt(item,0)},sendToBack:function(){var owner=this._getOwner();return owner?owner._insertItem(0,this):null},bringToFront:function(){var owner=this._getOwner();return owner?owner._insertItem(undefined,this):null},appendTop:"#addChild",appendBottom:function(item){return this.insertChild(0,item)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(owner){return owner._insertItem(undefined,this)},copyTo:function(owner){return this.clone(!1).addTo(owner)},
reduce:function(options){var children=this._children;return children&&1===children.length?(options=children[0].reduce(options),this._parent?(options.insertAbove(this),this.remove()):options.remove(),options):this},_removeNamed:function(){var owner=this._getOwner();if(owner){var children=owner._children;owner=owner._namedChildren;var name=this._name,namedArray=owner[name],index=namedArray?namedArray.indexOf(this):-1;-1!==index&&(children[name]==this&&delete children[name],namedArray.splice(index,1),
namedArray.length?children[name]=namedArray[0]:delete owner[name])}},_remove:function(notifySelf,notifyParent){var owner=this._getOwner(),project=this._project,index=this._index;this._style&&this._style._dispose();return owner?(this._name&&this._removeNamed(),null!=index&&(project._activeLayer===this&&(project._activeLayer=this.getNextSibling()||this.getPreviousSibling()),Base.splice(owner._children,null,index,1)),this._installEvents(!1),notifySelf&&project._changes&&this._changed(5),notifyParent&&
owner._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(item){(item=item&&item.insertBelow(this))&&this.remove();return item},removeChildren:function(start,end){if(!this._children)return null;start=start||0;end=Base.pick(end,this._children.length);start=Base.splice(this._children,null,start,end-start);for(end=start.length-1;0<=end;end--)start[end]._remove(!0,!1);0<start.length&&this._changed(11);return start},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();
for(var i=0,l=this._children.length;i<l;i++)this._children[i]._index=i;this._changed(11)}},isEmpty:function(recursively){var children=this._children,numChildren=children?children.length:0;if(recursively){for(var i=0;i<numChildren;i++)if(!children[i].isEmpty(recursively))return!1;return!0}return!numChildren},isEditable:function(){for(var item=this;item;){if(!item._visible||item._locked)return!1;item=item._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},
hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(item$jscomp$0){function getList(item){var list=[];do list.unshift(item);while(item=item._parent);return list}var list1=getList(this);item$jscomp$0=getList(item$jscomp$0);for(var i=0,l=Math.min(list1.length,item$jscomp$0.length);i<l;i++)if(list1[i]!=item$jscomp$0[i])return list1[i]._index<item$jscomp$0[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&0<this._children.length},isInserted:function(){return this._parent?
this._parent.isInserted():!1},isAbove:function(item){return-1===this._getOrder(item)},isBelow:function(item){return 1===this._getOrder(item)},isParent:function(item){return this._parent===item},isChild:function(item){return item&&item._parent===this},isDescendant:function(item){for(var parent=this;parent=parent._parent;)if(parent===item)return!0;return!1},isAncestor:function(item){return item?item.isDescendant(this):!1},isSibling:function(item){return this._parent===item._parent},isGroupedWith:function(item){for(var parent=
this._parent;parent;){if(parent._parent&&/^(Group|Layer|CompoundPath)$/.test(parent._class)&&item.isDescendant(parent))return!0;parent=parent._parent}return!1}},Base.each(["rotate","scale","shear","skew"],function(key){var rotate="rotate"===key;this[key]=function(){var args=arguments,value=(rotate?Base:Point).read(args);args=Point.read(args,0,{readNull:!0});return this.transform((new Matrix)[key](value,args||this.getPosition(!0)))}},{translate:function(){var mx=new Matrix;return this.transform(mx.translate.apply(mx,
arguments))},transform:function(matrix,_applyRecursively,_setApplyMatrix){var _matrix=this._matrix,transformMatrix=matrix&&!matrix.isIdentity(),applyMatrix=_setApplyMatrix&&this._canApplyMatrix||this._applyMatrix&&(transformMatrix||!_matrix.isIdentity()||_applyRecursively&&this._children);if(!transformMatrix&&!applyMatrix)return this;if(transformMatrix){!matrix.isInvertible()&&_matrix.isInvertible()&&(_matrix._backup=_matrix.getValues());_matrix.prepend(matrix,!0);var style=this._style,fillColor=
style.getFillColor(!0);style=style.getStrokeColor(!0);fillColor&&fillColor.transform(matrix);style&&style.transform(matrix)}applyMatrix&&(applyMatrix=this._transformContent(_matrix,_applyRecursively,_setApplyMatrix))&&((_applyRecursively=this._pivot)&&_matrix._transformPoint(_applyRecursively,_applyRecursively,!0),_matrix.reset(!0),_setApplyMatrix&&this._canApplyMatrix&&(this._applyMatrix=!0));_setApplyMatrix=this._bounds;_matrix=this._position;(transformMatrix||applyMatrix)&&this._changed(25);if((_applyRecursively=
transformMatrix&&_setApplyMatrix&&matrix.decompose())&&_applyRecursively.skewing.isZero()&&0===_applyRecursively.rotation%90){for(var key in _setApplyMatrix)if(transformMatrix=_setApplyMatrix[key],transformMatrix.nonscaling)delete _setApplyMatrix[key];else if(applyMatrix||!transformMatrix.internal)transformMatrix=transformMatrix.rect,matrix._transformBounds(transformMatrix,transformMatrix);this._bounds=_setApplyMatrix;if(matrix=_setApplyMatrix[this._getBoundsCacheKey(this._boundsOptions||{})])this._position=
this._getPositionFromBounds(matrix.rect)}else transformMatrix&&_matrix&&this._pivot&&(this._position=matrix._transformPoint(_matrix,_matrix));return this},_transformContent:function(matrix,applyRecursively,setApplyMatrix){var children=this._children;if(children){for(var i=0,l=children.length;i<l;i++)children[i].transform(matrix,applyRecursively,setApplyMatrix);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(Point.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(Point.read(arguments))},
parentToLocal:function(){return this._matrix._inverseTransform(Point.read(arguments))},localToParent:function(){return this._matrix._transformPoint(Point.read(arguments))},fitBounds:function(rectangle,fill){rectangle=Rectangle.read(arguments);var bounds=this.getBounds(),itemRatio=bounds.height/bounds.width,rectRatio=rectangle.height/rectangle.width;itemRatio=(fill?itemRatio>rectRatio:itemRatio<rectRatio)?rectangle.width/bounds.width:rectangle.height/bounds.height;bounds=new Rectangle(new Point,new Size(bounds.width*
itemRatio,bounds.height*itemRatio));bounds.setCenter(rectangle.getCenter());this.setBounds(bounds)}}),{_setStyles:function(ctx,param,viewMatrix){var style=this._style,matrix=this._matrix;style.hasFill()&&(ctx.fillStyle=style.getFillColor().toCanvasStyle(ctx,matrix));if(style.hasStroke()){ctx.strokeStyle=style.getStrokeColor().toCanvasStyle(ctx,matrix);ctx.lineWidth=style.getStrokeWidth();matrix=style.getStrokeJoin();var strokeCap=style.getStrokeCap(),miterLimit=style.getMiterLimit();matrix&&(ctx.lineJoin=
matrix);strokeCap&&(ctx.lineCap=strokeCap);miterLimit&&(ctx.miterLimit=miterLimit);paper.support.nativeDash&&(matrix=style.getDashArray(),strokeCap=style.getDashOffset(),matrix&&matrix.length&&("setLineDash"in ctx?(ctx.setLineDash(matrix),ctx.lineDashOffset=strokeCap):(ctx.mozDash=matrix,ctx.mozDashOffset=strokeCap)))}style.hasShadow()&&(param=param.pixelRatio||1,param=viewMatrix._shiftless().prepend((new Matrix).scale(param,param)),viewMatrix=param.transform(new Point(style.getShadowBlur(),0)),param=
param.transform(this.getShadowOffset()),ctx.shadowColor=style.getShadowColor().toCanvasStyle(ctx),ctx.shadowBlur=viewMatrix.getLength(),ctx.shadowOffsetX=param.x,ctx.shadowOffsetY=param.y)},draw:function(ctx,param,parentStrokeMatrix){this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var matrices=param.matrices,viewMatrix=param.viewMatrix,matrix=this._matrix,globalMatrix=matrices[matrices.length-1].appended(matrix);if(globalMatrix.isInvertible()){viewMatrix=viewMatrix?
viewMatrix.appended(globalMatrix):globalMatrix;matrices.push(globalMatrix);param.updateMatrix&&(this._globalMatrix=globalMatrix);globalMatrix=this._blendMode;var opacity=this._opacity,normalBlend="normal"===globalMatrix,nativeBlend=BlendMode.nativeModes[globalMatrix];normalBlend=normalBlend&&1===opacity||param.dontStart||param.clip||(nativeBlend||normalBlend&&1>opacity)&&this._canComposite();var pixelRatio=param.pixelRatio||1;if(!normalBlend){var bounds=this.getStrokeBounds(viewMatrix);if(!bounds.width||
!bounds.height){matrices.pop();return}var prevOffset=param.offset;var itemOffset=param.offset=bounds.getTopLeft().floor();var mainCtx=ctx;ctx=CanvasProvider.getContext(bounds.getSize().ceil().add(1).multiply(pixelRatio));1!==pixelRatio&&ctx.scale(pixelRatio,pixelRatio)}ctx.save();parentStrokeMatrix=parentStrokeMatrix?parentStrokeMatrix.appended(matrix):this._canScaleStroke&&!this.getStrokeScaling(!0)&&viewMatrix;bounds=!normalBlend&&param.clipItem;var transform=!parentStrokeMatrix||bounds;normalBlend?
(ctx.globalAlpha=opacity,nativeBlend&&(ctx.globalCompositeOperation=globalMatrix)):transform&&ctx.translate(-itemOffset.x,-itemOffset.y);transform&&(normalBlend?matrix:viewMatrix).applyToContext(ctx);bounds&&param.clipItem.draw(ctx,param.extend({clip:!0}));parentStrokeMatrix&&(ctx.setTransform(pixelRatio,0,0,pixelRatio,0,0),(matrix=param.offset)&&ctx.translate(-matrix.x,-matrix.y));this._draw(ctx,param,viewMatrix,parentStrokeMatrix);ctx.restore();matrices.pop();param.clip&&!param.dontFinish&&ctx.clip(this.getFillRule());
normalBlend||(BlendMode.process(globalMatrix,ctx,mainCtx,opacity,itemOffset.subtract(prevOffset).multiply(pixelRatio)),CanvasProvider.release(ctx),param.offset=prevOffset)}}},_isUpdated:function(updateVersion){var parent=this._parent;if(parent instanceof CompoundPath)return parent._isUpdated(updateVersion);var updated=this._updateVersion===updateVersion;!updated&&parent&&parent._visible&&parent._isUpdated(updateVersion)&&(this._updateVersion=updateVersion,updated=!0);return updated},_drawSelection:function(ctx,
matrix,size,selectionItems,updateVersion){var selection=this._selection,itemSelected=selection&1,boundsSelected=selection&2||itemSelected&&this._selectBounds;selection&=4;this._drawSelected||(itemSelected=!1);if((itemSelected||boundsSelected||selection)&&this._isUpdated(updateVersion)){var layer;updateVersion=this.getSelectedColor(!0)||(layer=this.getLayer())&&layer.getSelectedColor(!0);layer=matrix.appended(this.getGlobalMatrix(!0));matrix=size/2;ctx.strokeStyle=ctx.fillStyle=updateVersion?updateVersion.toCanvasStyle(ctx):
"#009dec";itemSelected&&this._drawSelected(ctx,layer,selectionItems);if(selection){selectionItems=this.getPosition(!0);itemSelected=(itemSelected=this._parent)?itemSelected.localToGlobal(selectionItems):selectionItems;selectionItems=itemSelected.x;selection=itemSelected.y;ctx.beginPath();ctx.arc(selectionItems,selection,matrix,0,2*Math.PI,!0);ctx.stroke();updateVersion=[[0,-1],[1,0],[0,1],[-1,0]];var end=size+1;for(itemSelected=0;4>itemSelected;itemSelected++){var delta=updateVersion[itemSelected],
dx=delta[0];delta=delta[1];ctx.moveTo(selectionItems+dx*matrix,selection+delta*matrix);ctx.lineTo(selectionItems+dx*end,selection+delta*end);ctx.stroke()}}if(boundsSelected){boundsSelected=layer._transformCorners(this.getInternalBounds());ctx.beginPath();for(itemSelected=0;8>itemSelected;itemSelected++)ctx[itemSelected?"lineTo":"moveTo"](boundsSelected[itemSelected],boundsSelected[++itemSelected]);ctx.closePath();ctx.stroke();for(itemSelected=0;8>itemSelected;itemSelected++)ctx.fillRect(boundsSelected[itemSelected]-
matrix,boundsSelected[++itemSelected]-matrix,size,size)}}},_canComposite:function(){return!1}},Base.each(["down","drag","up","move"],function(key){this["removeOn"+Base.capitalize(key)]=function(){var hash={};hash[key]=!0;return this.removeOn(hash)}},{removeOn:function(obj){for(var name in obj)if(obj[name]){var key="mouse"+name,project=this._project;project=project._removeSets=project._removeSets||{};project[key]=project[key]||{};project[key][this._id]=this}return this}}),{tween:function(from,to,options){function onFrame(event){tween._handleFrame(1E3*
event.time);tween.running||this.off("frame",onFrame)}options||(options=to,to=from,from=null,options||(options=to,to=null));var duration=null!=options&&("number"===typeof options?options:options.duration),tween=new Tween(this,from,to,duration,options&&options.easing,options&&options.start);if(duration)this.on("frame",onFrame);return tween},tweenTo:function(to,options){return this.tween(null,to,options)},tweenFrom:function(from,options){return this.tween(from,null,options)}}),Group=Item.extend({_class:"Group",
_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(arg){this._children=[];this._namedChildren={};this._initialize(arg)||this.addChildren(Array.isArray(arg)?arg:arguments)},_changed:function _changed(flags){_changed.base.call(this,flags);flags&2050&&(this._clipItem=undefined)},_getClipItem:function(){var clipItem=this._clipItem;if(undefined===clipItem){clipItem=null;for(var children=this._children,i=0,l=children.length;i<l;i++)if(children[i]._clipMask){clipItem=
children[i];break}this._clipItem=clipItem}return clipItem},isClipped:function(){return!!this._getClipItem()},setClipped:function(clipped){var child=this.getFirstChild();child&&child.setClipMask(clipped)},_getBounds:function _getBounds(matrix,options){var clipItem=this._getClipItem();return clipItem?clipItem._getCachedBounds(clipItem._matrix.prepended(matrix),Base.set({},options,{stroke:!1})):_getBounds.base.call(this,matrix,options)},_hitTestChildren:function _hitTestChildren(point,options,viewMatrix){var clipItem=
this._getClipItem();return(!clipItem||clipItem.contains(point))&&_hitTestChildren.base.call(this,point,options,viewMatrix,clipItem)},_draw:function(ctx,param){var clip=param.clip,clipItem=!clip&&this._getClipItem();param=param.extend({clipItem:clipItem,clip:!1});clip?(ctx.beginPath(),param.dontStart=param.dontFinish=!0):clipItem&&clipItem.draw(ctx,param.extend({clip:!0}));clip=this._children;for(var i=0,l=clip.length;i<l;i++){var item=clip[i];item!==clipItem&&item.draw(ctx,param)}}}),Layer=Group.extend({_class:"Layer",
initialize:function(){Group.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function isInserted(){return this._parent?isInserted.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),Shape=Item.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(props,point){this._initialize(props,
point)},_equals:function(item){return this._type===item._type&&this._size.equals(item._size)&&Base.equals(this._radius,item._radius)},copyContent:function(source){this.setType(source._type);this.setSize(source._size);this.setRadius(source._radius)},getType:function(){return this._type},setType:function(type){this._type=type},getShape:"#getType",setShape:"#setType",getSize:function(){var size=this._size;return new LinkedSize(size.width,size.height,this,"setSize")},setSize:function(){var size=Size.read(arguments);
if(!this._size)this._size=size.clone();else if(!this._size.equals(size)){var type=this._type,width=size.width,height=size.height;"rectangle"===type?this._radius.set(Size.min(this._radius,size.divide(2).abs())):"circle"===type?(width=height=(width+height)/2,this._radius=width/2):"ellipse"===type&&this._radius._set(width/2,height/2);this._size._set(width,height);this._changed(9)}},getRadius:function(){var rad=this._radius;return"circle"===this._type?rad:new LinkedSize(rad.width,rad.height,this,"setRadius")},
setRadius:function(radius){var type=this._type;if("circle"===type){if(radius===this._radius)return;type=2*radius;this._radius=radius;this._size._set(type,type)}else if(radius=Size.read(arguments),this._radius){if(this._radius.equals(radius))return;this._radius.set(radius);"rectangle"===type?(type=Size.max(this._size,radius.multiply(2)),this._size.set(type)):"ellipse"===type&&this._size._set(2*radius.width,2*radius.height)}else this._radius=radius.clone();this._changed(9)},isEmpty:function(){return!1},
toPath:function(insert){var path=new (Path[Base.capitalize(this._type)])({center:new Point,size:this._size,radius:this._radius,insert:!1});path.copyAttributes(this);paper.settings.applyMatrix&&path.setApplyMatrix(!0);(undefined===insert||insert)&&path.insertAbove(this);return path},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(ctx,param,viewMatrix,strokeMatrix){var style=this._style,hasFill=style.hasFill(),hasStroke=style.hasStroke(),dontPaint=param.dontFinish||param.clip,
untransformed=!strokeMatrix;if(hasFill||hasStroke||dontPaint){var type=this._type,radius=this._radius,isCircle="circle"===type;param.dontStart||ctx.beginPath();if(untransformed&&isCircle)ctx.arc(0,0,radius,0,2*Math.PI,!0);else{var rx=isCircle?radius:radius.width;radius=isCircle?radius:radius.height;var size=this._size;isCircle=size.width;size=size.height;untransformed&&"rectangle"===type&&0===rx&&0===radius?ctx.rect(-isCircle/2,-size/2,isCircle,size):(untransformed=isCircle/2,type=size/2,isCircle=
.44771525016920644*rx,size=.44771525016920644*radius,isCircle=[-untransformed,-type+radius,-untransformed,-type+size,-untransformed+isCircle,-type,-untransformed+rx,-type,untransformed-rx,-type,untransformed-isCircle,-type,untransformed,-type+size,untransformed,-type+radius,untransformed,type-radius,untransformed,type-size,untransformed-isCircle,type,untransformed-rx,type,-untransformed+rx,type,-untransformed+isCircle,type,-untransformed,type-size,-untransformed,type-radius],strokeMatrix&&strokeMatrix.transform(isCircle,
isCircle,32),ctx.moveTo(isCircle[0],isCircle[1]),ctx.bezierCurveTo(isCircle[2],isCircle[3],isCircle[4],isCircle[5],isCircle[6],isCircle[7]),untransformed!==rx&&ctx.lineTo(isCircle[8],isCircle[9]),ctx.bezierCurveTo(isCircle[10],isCircle[11],isCircle[12],isCircle[13],isCircle[14],isCircle[15]),type!==radius&&ctx.lineTo(isCircle[16],isCircle[17]),ctx.bezierCurveTo(isCircle[18],isCircle[19],isCircle[20],isCircle[21],isCircle[22],isCircle[23]),untransformed!==rx&&ctx.lineTo(isCircle[24],isCircle[25]),
ctx.bezierCurveTo(isCircle[26],isCircle[27],isCircle[28],isCircle[29],isCircle[30],isCircle[31]))}ctx.closePath()}dontPaint||!hasFill&&!hasStroke||(this._setStyles(ctx,param,viewMatrix),hasFill&&(ctx.fill(style.getFillRule()),ctx.shadowColor="rgba(0,0,0,0)"),hasStroke&&ctx.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(matrix,options){var rect=(new Rectangle(this._size)).setCenter(0,0),style=this._style;style=options.stroke&&style.hasStroke()&&style.getStrokeWidth();
matrix&&(rect=matrix._transformBounds(rect));return style?rect.expand(Path._getStrokePadding(style,this._getStrokeMatrix(matrix,options))):rect}},new function(){function getCornerCenter(that,point,expand){var radius=that._radius;if(!radius.isZero()){that=that._size.divide(2);for(var q=1;4>=q;q++){var dir=new Point(1<q&&4>q?-1:1,2<q?-1:1),corner=dir.multiply(that),center=corner.subtract(dir.multiply(radius));if((new Rectangle(expand?corner.add(dir.multiply(expand)):corner,center)).contains(point))return{point:center,
quadrant:q}}}}function isOnEllipseStroke(point,radius,padding,quadrant){point=point.divide(radius);return(!quadrant||point.isInQuadrant(quadrant))&&1>=point.subtract(point.normalize()).multiply(radius).divide(padding).length}return{_contains:function _contains(point){if("rectangle"===this._type){var center=getCornerCenter(this,point);return center?1>=point.subtract(center.point).divide(this._radius).getLength():_contains.base.call(this,point)}return.5>=point.divide(this.size).getLength()},_hitTestSelf:function _hitTestSelf(point,
options,viewMatrix,strokeMatrix){var hit=!1,style=this._style,hitStroke=options.stroke&&style.hasStroke(),hitFill=options.fill&&style.hasFill();if(hitStroke||hitFill){hitFill=this._type;hit=this._radius;var strokeRadius=hitStroke?style.getStrokeWidth()/2:0;strokeRadius=options._tolerancePadding.add(Path._getStrokePadding(strokeRadius,!style.getStrokeScaling()&&strokeMatrix));"rectangle"===hitFill?(style=strokeRadius.multiply(2),(hitFill=getCornerCenter(this,point,style))?hit=isOnEllipseStroke(point.subtract(hitFill.point),
hit,strokeRadius,hitFill.quadrant):(hitFill=(new Rectangle(this._size)).setCenter(0,0),hit=hitFill.expand(style),style=hitFill.expand(style.negate()),hit=hit._containsPoint(point)&&!style._containsPoint(point))):hit=isOnEllipseStroke(point,hit,strokeRadius)}return hit?new HitResult(hitStroke?"stroke":"fill",this):_hitTestSelf.base.apply(this,arguments)}}},{statics:new function(){function createShape(type,point,size,radius,args){var item=Base.create(Shape.prototype);item._type=type;item._size=size;
item._radius=radius;item._initialize(Base.getNamed(args),point);return item}return{Circle:function(){var args=arguments,center=Point.readNamed(args,"center"),radius=Base.readNamed(args,"radius");return createShape("circle",center,new Size(2*radius),radius,args)},Rectangle:function(){var args=arguments,rect=Rectangle.readNamed(args,"rectangle"),radius=Size.min(Size.readNamed(args,"radius"),rect.getSize(!0).divide(2));return createShape("rectangle",rect.getCenter(!0),rect.getSize(!0),radius,args)},
Ellipse:function(){var args=arguments,ellipse=Shape._readEllipse(args),radius=ellipse.radius;return createShape("ellipse",ellipse.center,radius.multiply(2),radius,args)},_readEllipse:function(args){if(Base.hasNamed(args,"radius")){var center=Point.readNamed(args,"center");args=Size.readNamed(args,"radius")}else args=Rectangle.readNamed(args,"rectangle"),center=args.getCenter(!0),args=args.getSize(!0).divide(2);return{center:center,radius:args}}}}}),Raster=Item.extend({_class:"Raster",_applyMatrix:!1,
_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:!0,beans:!0,initialize:function(source,position){if(!this._initialize(source,undefined!==position&&Point.read(arguments))){var type=typeof source;if((type="string"===type?document.getElementById(source):"object"===type?source:null)&&type!==Item.NO_INSERT)if(type.getContent||null!=type.naturalHeight)var image=type;else type&&(type=Size.read(arguments),type.isZero()||
(image=CanvasProvider.getCanvas(type)));image?this.setImage(image):this.setSource(source)}this._size||(this._size=new Size,this._loaded=!1)},_equals:function(item){return this.getSource()===item.getSource()},copyContent:function(source){var image=source._image,canvas=source._canvas;image?this._setImage(image):canvas&&(image=CanvasProvider.getCanvas(source._size),image.getContext("2d").drawImage(canvas,0,0),this._setImage(image));this._crossOrigin=source._crossOrigin},getSize:function(){var size=this._size;
return new LinkedSize(size?size.width:0,size?size.height:0,this,"setSize")},setSize:function(){var size=Size.read(arguments);if(!size.equals(this._size))if(0<size.width&&0<size.height){var element=this.getElement();this._setImage(CanvasProvider.getCanvas(size));element&&this.getContext(!0).drawImage(element,0,0,size.width,size.height)}else this._canvas&&CanvasProvider.release(this._canvas),this._size=size.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(width){this.setSize(width,
this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(height){this.setSize(this.getWidth(),height)},getLoaded:function(){return this._loaded},isEmpty:function(){var size=this._size;return!size||0===size.width&&0===size.height},getResolution:function(){var matrix=this._matrix,orig=(new Point(0,0)).transform(matrix),u=(new Point(1,0)).transform(matrix).subtract(orig);matrix=(new Point(0,1)).transform(matrix).subtract(orig);return new Size(72/u.getLength(),
72/matrix.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(image){function emit(event){var view=that.getView(),type=event&&event.type||"load";view&&that.responds(type)&&(paper=view._scope,that.emit(type,new Event(event)))}var that=this;this._setImage(image);this._loaded?setTimeout(emit,0):image&&DomEvent.add(image,{load:function(event){that._setImage(image);emit(event)},error:emit})},_setImage:function(image){this._canvas&&CanvasProvider.release(this._canvas);
image&&image.getContext?(this._image=null,this._canvas=image,this._loaded=!0):(this._image=image,this._canvas=null,this._loaded=!!(image&&image.src&&image.complete));this._size=new Size(image?image.naturalWidth||image.width:0,image?image.naturalHeight||image.height:0);this._context=null;this._changed(1033)},getCanvas:function(){if(!this._canvas){var ctx=CanvasProvider.getContext(this._size);try{this._image&&ctx.drawImage(this._image,0,0),this._canvas=ctx.canvas}catch(e){CanvasProvider.release(ctx)}}return this._canvas},
setCanvas:"#setImage",getContext:function(_change){this._context||(this._context=this.getCanvas().getContext("2d"));_change&&(this._image=null,this._changed(1025));return this._context},setContext:function(context){this._context=context},getSource:function(){var image=this._image;return image&&image.src||this.toDataURL()},setSource:function(src){var image=new self$jscomp$0.Image,crossOrigin=this._crossOrigin;crossOrigin&&(image.crossOrigin=crossOrigin);src&&(image.src=src);this.setImage(image)},getCrossOrigin:function(){var image=
this._image;return image&&image.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(crossOrigin){this._crossOrigin=crossOrigin;var image=this._image;image&&(image.crossOrigin=crossOrigin)},getSmoothing:function(){return this._smoothing},setSmoothing:function(smoothing){this._smoothing=smoothing;this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var rect=Rectangle.read(arguments),ctx=CanvasProvider.getContext(rect.getSize());
ctx.drawImage(this.getCanvas(),rect.x,rect.y,rect.width,rect.height,0,0,rect.width,rect.height);return ctx.canvas},getSubRaster:function(){var rect=Rectangle.read(arguments),raster=new Raster(Item.NO_INSERT);raster._setImage(this.getSubCanvas(rect));raster.translate(rect.getCenter().subtract(this.getSize().divide(2)));raster._matrix.prepend(this._matrix);raster.insertAbove(this);return raster},toDataURL:function(){var image=this._image;image=image&&image.src;return/^data:/.test(image)?image:(image=
this.getCanvas())?image.toDataURL.apply(image,arguments):null},drawImage:function(image){var point=Point.read(arguments,1);this.getContext(!0).drawImage(image,point.x,point.y)},getAverageColor:function(object){if(object)if(object instanceof PathItem){var path=object;var bounds=object.getBounds()}else"object"===typeof object&&("width"in object?bounds=new Rectangle(object):"x"in object&&(bounds=new Rectangle(object.x-.5,object.y-.5,1,1)));else bounds=this.getBounds();if(!bounds)return null;object=Math.min(bounds.width,
32);var height=Math.min(bounds.height,32),ctx=Raster._sampleContext;ctx?ctx.clearRect(0,0,33,33):ctx=Raster._sampleContext=CanvasProvider.getContext(new Size(32));ctx.save();bounds=(new Matrix).scale(object/bounds.width,height/bounds.height).translate(-bounds.x,-bounds.y);bounds.applyToContext(ctx);path&&path.draw(ctx,new Base({clip:!0,matrices:[bounds]}));this._matrix.applyToContext(ctx);path=this.getElement();bounds=this._size;path&&ctx.drawImage(path,-bounds.width/2,-bounds.height/2);ctx.restore();
object=ctx.getImageData(.5,.5,Math.ceil(object),Math.ceil(height)).data;height=[0,0,0];path=ctx=0;for(bounds=object.length;path<bounds;path+=4){var alpha=object[path+3];ctx+=alpha;alpha/=255;height[0]+=object[path]*alpha;height[1]+=object[path+1]*alpha;height[2]+=object[path+2]*alpha}for(path=0;3>path;path++)height[path]/=ctx;return ctx?Color.read(height):null},getPixel:function(){var point=Point.read(arguments);point=this.getContext().getImageData(point.x,point.y,1,1).data;return new Color("rgb",
[point[0]/255,point[1]/255,point[2]/255],point[3]/255)},setPixel:function(){var args=arguments,point=Point.read(args),color=Color.read(args);args=color._convert("rgb");color=color._alpha;var ctx=this.getContext(!0),imageData=ctx.createImageData(1,1),data=imageData.data;data[0]=255*args[0];data[1]=255*args[1];data[2]=255*args[2];data[3]=null!=color?255*color:255;ctx.putImageData(imageData,point.x,point.y)},clear:function(){var size=this._size;this.getContext(!0).clearRect(0,0,size.width+1,size.height+
1)},createImageData:function(){var size=Size.read(arguments);return this.getContext().createImageData(size.width,size.height)},getImageData:function(){var rect=Rectangle.read(arguments);rect.isEmpty()&&(rect=new Rectangle(this._size));return this.getContext().getImageData(rect.x,rect.y,rect.width,rect.height)},setImageData:function(data){var point=Point.read(arguments,1);this.getContext(!0).putImageData(data,point.x,point.y)},_getBounds:function(matrix,options){options=(new Rectangle(this._size)).setCenter(0,
0);return matrix?matrix._transformBounds(options):options},_hitTestSelf:function(point){if(this._contains(point)){var that=this;return new HitResult("pixel",that,{offset:point.add(that._size.divide(2)).round(),color:{get:function(){return that.getPixel(this.offset)}}})}},_draw:function(ctx,param,viewMatrix){var element=this.getElement();element&&0<element.width&&0<element.height&&(ctx.globalAlpha=this._opacity,this._setStyles(ctx,param,viewMatrix),DomElement.setPrefixed(ctx,"imageSmoothingEnabled",
this._smoothing),ctx.drawImage(element,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),SymbolItem=Item.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(arg0,arg1){this._initialize(arg0,undefined!==arg1&&Point.read(arguments,1))||this.setDefinition(arg0 instanceof SymbolDefinition?arg0:new SymbolDefinition(arg0))},_equals:function(item){return this._definition===item._definition},
copyContent:function(source){this.setDefinition(source._definition)},getDefinition:function(){return this._definition},setDefinition:function(definition){this._definition=definition;this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(matrix,options){var item=this._definition._item;return item._getCachedBounds(item._matrix.prepended(matrix),options)},_hitTestSelf:function(point,options,viewMatrix){options=
options.extend({all:!1});if(point=this._definition._item._hitTest(point,options,viewMatrix))point.item=this;return point},_draw:function(ctx,param){this._definition._item.draw(ctx,param)}}),SymbolDefinition=Base.extend({_class:"SymbolDefinition",initialize:function(item,dontCenter){this._id=UID.get();this.project=paper.project;item&&this.setItem(item,dontCenter)},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._class,this._item],options,!1,
dictionary)})},_changed:function(flags){flags&8&&Item._clearBoundsCache(this);flags&1&&this.project._changed(flags)},getItem:function(){return this._item},setItem:function(item,_dontCenter){item._symbol&&(item=item.clone());this._item&&(this._item._symbol=null);this._item=item;item.remove();item.setSelected(!1);_dontCenter||item.setPosition(new Point);item._symbol=this;this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(position){return new SymbolItem(this,position)},
clone:function(){return new SymbolDefinition(this._item.clone(!1))},equals:function(symbol){return symbol===this||symbol&&this._item.equals(symbol._item)||!1}}),HitResult=Base.extend({_class:"HitResult",initialize:function(type,item,values){this.type=type;this.item=item;values&&this.inject(values)},statics:{getOptions:function(args){args=args&&Base.read(args);return new Base({type:null,tolerance:paper.settings.hitTolerance,fill:!args,stroke:!args,segments:!args,handles:!1,ends:!1,position:!1,center:!1,
bounds:!1,guides:!1,selected:!1},args)}}}),Segment=Base.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(arg0,arg1,arg2,arg3,arg4,arg5){var count=arguments.length;if(0<count)if(null==arg0||"object"===typeof arg0)if(1===count&&arg0&&"point"in arg0){var point=arg0.point;var handleIn=arg0.handleIn;var handleOut=arg0.handleOut;var selection=arg0.selection}else point=arg0,handleIn=arg1,handleOut=arg2,selection=arg3;else point=[arg0,arg1],handleIn=undefined!==arg2?[arg2,arg3]:null,handleOut=
undefined!==arg4?[arg4,arg5]:null;new SegmentPoint(point,this,"_point");new SegmentPoint(handleIn,this,"_handleIn");new SegmentPoint(handleOut,this,"_handleOut");selection&&this.setSelection(selection)},_serialize:function(options,dictionary){var point=this._point,selection=this._selection;point=selection||this.hasHandles()?[point,this._handleIn,this._handleOut]:point;selection&&point.push(selection);return Base.serialize(point,options,!0,dictionary)},_changed:function(point){var path=this._path;
if(path){var curves=path._curves,index=this._index,curve;curves&&(point&&point!==this._point&&point!==this._handleIn||!(curve=0<index?curves[index-1]:path._closed?curves[curves.length-1]:null)||curve._changed(),point&&point!==this._point&&point!==this._handleOut||!(curve=curves[index])||curve._changed());path._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(Point.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(Point.read(arguments))},
getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(Point.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var handleIn=this._handleIn,handleOut=this._handleOut;return!handleIn.isZero()&&!handleOut.isZero()&&handleIn.isCollinear(handleOut)},clearHandles:function(){this._handleIn._set(0,0);this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(selection){var oldSelection=
this._selection,path=this._path;this._selection=selection=selection||0;path&&selection!==oldSelection&&(path._updateSelection(this,oldSelection,selection),path._changed(257))},_changeSelection:function(flag,selected){var selection=this._selection;this.setSelection(selected?selection|flag:selection&~flag)},isSelected:function(){return!!(this._selection&7)},setSelected:function(selected){this._changeSelection(7,selected)},getIndex:function(){return undefined!==this._index?this._index:null},getPath:function(){return this._path||
null},getCurve:function(){var path=this._path,index=this._index;return path?(0<index&&!path._closed&&index===path._segments.length-1&&index--,path.getCurves()[index]||null):null},getLocation:function(){var curve=this.getCurve();return curve?new CurveLocation(curve,this===curve._segment1?0:1):null},getNext:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index+1]||this._path._closed&&segments[0])||null},smooth:function(options,_first,_last){options=options||
{};var type=options.type,factor=options.factor,prev=this.getPrevious();options=this.getNext();var p0=(prev||this)._point,p1=this._point,p2=(options||this)._point,d1=p0.getDistance(p1),d2=p1.getDistance(p2);if(type&&"catmull-rom"!==type)if("geometric"===type)prev&&options&&(options=p0.subtract(p2),p0=undefined===factor?.4:factor,p1=p0*d1/(d1+d2),_first||this.setHandleIn(options.multiply(p1)),_last||this.setHandleOut(options.multiply(p1-p0)));else throw Error("Smoothing method '"+type+"' not supported.");
else factor=undefined===factor?.5:factor,d1=Math.pow(d1,factor),type=d1*d1,d2=Math.pow(d2,factor),factor=d2*d2,!_first&&prev&&(_first=2*factor+3*d2*d1+type,prev=3*d2*(d2+d1),this.setHandleIn(0!==prev?new Point((factor*p0._x+_first*p1._x-type*p2._x)/prev-p1._x,(factor*p0._y+_first*p1._y-type*p2._y)/prev-p1._y):new Point)),!_last&&options&&(_first=2*type+3*d1*d2+factor,prev=3*d1*(d1+d2),this.setHandleOut(0!==prev?new Point((type*p2._x+_first*p1._x-factor*p0._x)/prev-p1._x,(type*p2._y+_first*p1._y-factor*
p0._y)/prev-p1._y):new Point))},getPrevious:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index-1]||this._path._closed&&segments[segments.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var path=this._path;return path&&this._index===path._segments.length-1||!1},reverse:function(){var handleIn=this._handleIn,handleOut=this._handleOut,tmp=handleIn.clone();handleIn.set(handleOut);handleOut.set(tmp)},reversed:function(){return new Segment(this._point,
this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut)},equals:function(segment){return segment===this||segment&&this._class===segment._class&&this._point.equals(segment._point)&&this._handleIn.equals(segment._handleIn)&&this._handleOut.equals(segment._handleOut)||!1},toString:function(){var parts=["point: "+this._point];this._handleIn.isZero()||parts.push("handleIn: "+
this._handleIn);this._handleOut.isZero()||parts.push("handleOut: "+this._handleOut);return"{ "+parts.join(", ")+" }"},transform:function(matrix){this._transformCoordinates(matrix,Array(6),!0);this._changed()},interpolate:function(from,to,factor){var u=1-factor,point1=from._point,point2=to._point,handleIn1=from._handleIn,handleIn2=to._handleIn;to=to._handleOut;from=from._handleOut;this._point._set(u*point1._x+factor*point2._x,u*point1._y+factor*point2._y,!0);this._handleIn._set(u*handleIn1._x+factor*
handleIn2._x,u*handleIn1._y+factor*handleIn2._y,!0);this._handleOut._set(u*from._x+factor*to._x,u*from._y+factor*to._y,!0);this._changed()},_transformCoordinates:function(matrix,coords,change){var point=this._point,handleIn=change&&this._handleIn.isZero()?null:this._handleIn,handleOut=change&&this._handleOut.isZero()?null:this._handleOut,x=point._x,y=point._y,i=2;coords[0]=x;coords[1]=y;handleIn&&(coords[i++]=handleIn._x+x,coords[i++]=handleIn._y+y);handleOut&&(coords[i++]=handleOut._x+x,coords[i++]=
handleOut._y+y);matrix&&(matrix._transformCoordinates(coords,coords,i/2),x=coords[0],y=coords[1],change?(point._x=x,point._y=y,i=2,handleIn&&(handleIn._x=coords[i++]-x,handleIn._y=coords[i++]-y),handleOut&&(handleOut._x=coords[i++]-x,handleOut._y=coords[i++]-y)):(handleIn||(coords[i++]=x,coords[i++]=y),handleOut||(coords[i++]=x,coords[i++]=y)));return coords}}),SegmentPoint=Point.extend({initialize:function(point,owner,key){var x;if(point)if(undefined!==(x=point[0]))var y=point[1];else{var selected=
point;undefined===(x=selected.x)&&(selected=Point.read(arguments),x=selected.x);y=selected.y;selected=selected.selected}else x=y=0;this._x=x;this._y=y;this._owner=owner;owner[key]=this;selected&&this.setSelected(!0)},_set:function(x,y){this._x=x;this._y=y;this._owner._changed(this);return this},getX:function(){return this._x},setX:function(x){this._x=x;this._owner._changed(this)},getY:function(){return this._y},setY:function(y){this._y=y;this._owner._changed(this)},isZero:function(){var isZero=Numerical.isZero;
return isZero(this._x)&&isZero(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(selected){this._owner._changeSelection(this._getSelection(),selected)},_getSelection:function(){var owner=this._owner;return this===owner._point?1:this===owner._handleIn?2:this===owner._handleOut?4:0}}),Curve=Base.extend({_class:"Curve",beans:!0,initialize:function(arg0,arg1,arg2,arg3,arg4,arg5,arg6,arg7){var count=arguments.length;if(3===count){this._path=arg0;
var seg1=arg1;var seg2=arg2}else if(count)if(1===count)if("segment1"in arg0)seg1=new Segment(arg0.segment1),seg2=new Segment(arg0.segment2);else if("point1"in arg0){var point1=arg0.point1;var handle1=arg0.handle1;var handle2=arg0.handle2;var point2=arg0.point2}else Array.isArray(arg0)&&(point1=[arg0[0],arg0[1]],point2=[arg0[6],arg0[7]],handle1=[arg0[2]-arg0[0],arg0[3]-arg0[1]],handle2=[arg0[4]-arg0[6],arg0[5]-arg0[7]]);else 2===count?(seg1=new Segment(arg0),seg2=new Segment(arg1)):4===count?(point1=
arg0,handle1=arg1,handle2=arg2,point2=arg3):8===count&&(point1=[arg0,arg1],point2=[arg6,arg7],handle1=[arg2-arg0,arg3-arg1],handle2=[arg4-arg6,arg5-arg7]);else seg1=new Segment,seg2=new Segment;this._segment1=seg1||new Segment(point1,null,handle1);this._segment2=seg2||new Segment(point2,handle2,null)},_serialize:function(options,dictionary){return Base.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],options,!0,
dictionary)},_changed:function(){this._length=this._bounds=undefined},clone:function(){return new Curve(this._segment1,this._segment2)},toString:function(){var parts=["point1: "+this._segment1._point];this._segment1._handleOut.isZero()||parts.push("handle1: "+this._segment1._handleOut);this._segment2._handleIn.isZero()||parts.push("handle2: "+this._segment2._handleIn);parts.push("point2: "+this._segment2._point);return"{ "+parts.join(", ")+" }"},classify:function(){return Curve.classify(this.getValues())},
remove:function(){var removed=!1;if(this._path){removed=this._segment2;var handleOut=removed._handleOut;(removed=removed.remove())&&this._segment1._handleOut.set(handleOut)}return removed},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(Point.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(Point.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(Point.read(arguments))},
getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(Point.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var curves=this._path&&this._path._curves;return curves&&(curves[this._segment1._index+1]||this._path._closed&&curves[0])||null},getPrevious:function(){var curves=this._path&&
this._path._curves;return curves&&(curves[this._segment1._index-1]||this._path._closed&&curves[curves.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var path=this._path;return path&&this._segment1._index===path._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(selected){this.getPoint1().setSelected(selected);this.getHandle1().setSelected(selected);
this.getHandle2().setSelected(selected);this.getPoint2().setSelected(selected)},getValues:function(matrix){return Curve.getValues(this._segment1,this._segment2,matrix)},getPoints:function(){for(var coords=this.getValues(),points=[],i=0;8>i;i+=2)points.push(new Point(coords[i],coords[i+1]));return points}},{getLength:function(){null==this._length&&(this._length=Curve.getLength(this.getValues(),0,1));return this._length},getArea:function(){return Curve.getArea(this.getValues())},getLine:function(){return new Line(this._segment1._point,
this._segment2._point)},getPart:function(from,to){return new Curve(Curve.getPart(this.getValues(),from,to))},getPartLength:function(from,to){return Curve.getLength(this.getValues(),from,to)},divideAt:function(location){return this.divideAtTime(location&&location.curve===this?location.time:this.getTimeAt(location))},divideAtTime:function(time,_setHandles){var res=null;if(1E-8<=time&&.99999999>=time){res=Curve.subdivide(this.getValues(),time);time=res[0];res=res[1];var setHandles=_setHandles||this.hasHandles();
_setHandles=this._segment1;var seg2=this._segment2,path=this._path;setHandles&&(_setHandles._handleOut._set(time[2]-time[0],time[3]-time[1]),seg2._handleIn._set(res[4]-res[6],res[5]-res[7]));var x=time[6],y=time[7];time=new Segment(new Point(x,y),setHandles&&new Point(time[4]-x,time[5]-y),setHandles&&new Point(res[2]-x,res[3]-y));path?(path.insert(_setHandles._index+1,time),res=this.getNext()):(this._segment2=time,this._changed(),res=new Curve(time,seg2))}return res},splitAt:function(location){var path=
this._path;return path?path.splitAt(location):null},splitAtTime:function(time){return this.splitAt(this.getLocationAtTime(time))},divide:function(offset,isTime){return this.divideAtTime(undefined===offset?.5:isTime?offset:this.getTimeAt(offset))},split:function(offset,isTime){return this.splitAtTime(undefined===offset?.5:isTime?offset:this.getTimeAt(offset))},reversed:function(){return new Curve(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,
0);this._segment2._handleIn._set(0,0)},statics:{getValues:function(segment1,segment2,matrix,straight){var p1=segment1._point;segment1=segment1._handleOut;var h2=segment2._handleIn,p2=segment2._point;segment2=p1.x;p1=p1.y;var x2=p2.x;p2=p2.y;straight=straight?[segment2,p1,segment2,p1,x2,p2,x2,p2]:[segment2,p1,segment2+segment1._x,p1+segment1._y,x2+h2._x,p2+h2._y,x2,p2];matrix&&matrix._transformCoordinates(straight,straight,4);return straight},subdivide:function(v,t){var x0=v[0],y0=v[1],x1=v[2],y1=
v[3],x2=v[4],y2=v[5],x3=v[6];v=v[7];undefined===t&&(t=.5);var u=1-t,x4=u*x0+t*x1,y4=u*y0+t*y1,x5=u*x1+t*x2,y5=u*y1+t*y2;x2=u*x2+t*x3;y2=u*y2+t*v;y1=u*x4+t*x5;x1=u*y4+t*y5;x5=u*x5+t*x2;y5=u*y5+t*y2;var x9=u*y1+t*x5;t=u*x1+t*y5;return[[x0,y0,x4,y4,y1,x1,x9,t],[x9,t,x5,y5,x2,y2,x3,v]]},getMonoCurves:function(v,dir){var curves=[];dir=dir?0:1;var o0=v[dir+0],o1=v[dir+2],o2=v[dir+4],o3=v[dir+6];o0>=o1===o1>=o2&&o1>=o2===o2>=o3||Curve.isStraight(v)?curves.push(v):(dir=[],(o0=Numerical.solveQuadratic(3*(o1-
o2)-o0+o3,2*(o0+o2)-4*o1,o1-o0,dir,1E-8,.99999999))?(dir.sort(),o1=dir[0],v=Curve.subdivide(v,o1),curves.push(v[0]),1<o0&&(o1=(dir[1]-o1)/(1-o1),v=Curve.subdivide(v[1],o1),curves.push(v[0])),curves.push(v[1])):curves.push(v));return curves},solveCubic:function(v,coord,val,roots,min,max){var v0=v[coord],v1=v[coord+2],v2=v[coord+4];v=v[coord+6];coord=0;v0<val&&v<val&&v1<val&&v2<val||v0>val&&v>val&&v1>val&&v2>val||(coord=3*(v1-v0),v1=3*(v2-v1)-coord,coord=Numerical.solveCubic(v-v0-coord-v1,v1,coord,
v0-val,roots,min,max));return coord},getTimeOf:function(v,point){var p0=new Point(v[0],v[1]),p3=new Point(v[6],v[7]);if(null===(point.isClose(p0,1E-12)?0:point.isClose(p3,1E-12)?1:null))for(var coords=[point.x,point.y],roots=[],c=0;2>c;c++)for(var count=Curve.solveCubic(v,c,coords[c],roots,0,1),i=0;i<count;i++){var u=roots[i];if(point.isClose(Curve.getPoint(v,u),1E-7))return u}return point.isClose(p0,1E-7)?0:point.isClose(p3,1E-7)?1:null},getNearestTime:function(v,point){function refine(t){if(0<=
t&&1>=t){var dist=point.getDistance(Curve.getPoint(v,t),!0);if(dist<minDist)return minDist=dist,minT=t,!0}}if(Curve.isStraight(v)){var x0=v[0],y0=v[1],vx=v[6]-x0,vy=v[7]-y0,det=vx*vx+vy*vy;if(0===det)return 0;det=((point.x-x0)*vx+(point.y-y0)*vy)/det;return 1E-12>det?0:.999999999999<det?1:Curve.getTimeOf(v,new Point(x0+det*vx,y0+det*vy))}var minDist=Infinity,minT=0;for(x0=0;100>=x0;x0++)refine(x0/100);for(x0=.005;1E-8<x0;)refine(minT-x0)||refine(minT+x0)||(x0/=2);return minT},getPart:function(v,from,
to){var flip=from>to;if(flip){var tmp=from;from=to;to=tmp}0<from&&(v=Curve.subdivide(v,from)[1]);1>to&&(v=Curve.subdivide(v,(to-from)/(1-from))[0]);return flip?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v},isFlatEnough:function(v,flatness){var x0=v[0],y0=v[1],x3=v[6],y3=v[7],ux=3*v[2]-2*x0-x3,uy=3*v[3]-2*y0-y3;x0=3*v[4]-2*x3-x0;v=3*v[5]-2*y3-y0;return Math.max(ux*ux,x0*x0)+Math.max(uy*uy,v*v)<=16*flatness*flatness},getArea:function(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6];v=v[7];
return 3*((v-y0)*(x1+x2)-(x3-x0)*(y1+y2)+y1*(x0-x2)-x1*(y0-y2)+v*(x2+x0/3)-x3*(y2+y0/3))/20},getBounds:function(v){for(var min=v.slice(0,2),max=min.slice(),roots=[0,0],i=0;2>i;i++)Curve._addBounds(v[i],v[i+2],v[i+4],v[i+6],i,0,min,max,roots);return new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1])},_addBounds:function(v0,v1,v2,v3,coord,padding$jscomp$0,min,max,roots){function add(value,padding){var left=value-padding;value+=padding;left<min[coord]&&(min[coord]=left);value>max[coord]&&(max[coord]=
value)}padding$jscomp$0/=2;var minPad=min[coord]-padding$jscomp$0,maxPad=max[coord]+padding$jscomp$0;if(v0<minPad||v1<minPad||v2<minPad||v3<minPad||v0>maxPad||v1>maxPad||v2>maxPad||v3>maxPad)if(v1<v0!=v1<v3&&v2<v0!=v2<v3)add(v0,padding$jscomp$0),add(v3,padding$jscomp$0);else for(minPad=Numerical.solveQuadratic(3*(v1-v2)-v0+v3,2*(v0+v2)-4*v1,v1-v0,roots),add(v3,0),maxPad=0;maxPad<minPad;maxPad++){var t=roots[maxPad],u=1-t;1E-8<=t&&.99999999>=t&&add(u*u*u*v0+3*u*u*t*v1+3*u*t*t*v2+t*t*t*v3,padding$jscomp$0)}}}},
Base.each(["getBounds","getStrokeBounds","getHandleBounds"],function(name){this[name]=function(){this._bounds||(this._bounds={});var bounds=this._bounds[name];bounds||(bounds=this._bounds[name]=Path[name]([this._segment1,this._segment2],!1,this._path));return bounds.clone()}},{}),Base.each({isStraight:function(p1,h1,h2,p2){if(h1.isZero()&&h2.isZero())return!0;var v=p2.subtract(p1);if(!v.isZero()&&v.isCollinear(h1)&&v.isCollinear(h2)){var l=new Line(p1,p2);if(1E-7>l.getDistance(p1.add(h1))&&1E-7>l.getDistance(p2.add(h2)))return p1=
v.dot(v),h1=v.dot(h1)/p1,h2=v.dot(h2)/p1,0<=h1&&1>=h1&&0>=h2&&-1<=h2}return!1},isLinear:function(p1,h1,h2,p2){p1=p2.subtract(p1).divide(3);return h1.equals(p1)&&h2.negate().equals(p1)}},function(test,name){this[name]=function(epsilon){var seg1=this._segment1,seg2=this._segment2;return test(seg1._point,seg1._handleOut,seg2._handleIn,seg2._point,epsilon)};this.statics[name]=function(v,epsilon){var x0=v[0],y0=v[1],x3=v[6],y3=v[7];return test(new Point(x0,y0),new Point(v[2]-x0,v[3]-y0),new Point(v[4]-
x3,v[5]-y3),new Point(x3,y3),epsilon)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(epsilon){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(epsilon||0)},isCollinear:function(curve){return curve&&this.isStraight()&&curve.isStraight()&&this.getLine().isCollinear(curve.getLine())},isHorizontal:function(){return this.isStraight()&&1E-8>Math.abs(this.getTangentAtTime(.5).y)},
isVertical:function(){return this.isStraight()&&1E-8>Math.abs(this.getTangentAtTime(.5).x)}}),{beans:!1,getLocationAt:function(offset,_isTime){return this.getLocationAtTime(_isTime?offset:this.getTimeAt(offset))},getLocationAtTime:function(t){return null!=t&&0<=t&&1>=t?new CurveLocation(this,t):null},getTimeAt:function(offset,start){return Curve.getTimeAt(this.getValues(),offset,start)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var tangent=Point.read(arguments);return tangent.isZero()?
[]:Curve.getTimesWithTangent(this.getValues(),tangent)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(Point.read(arguments)))},getOffsetOf:function(){var loc=this.getLocationOf.apply(this,arguments);return loc?loc.getOffset():null},getTimeOf:function(){return Curve.getTimeOf(this.getValues(),Point.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var point=Point.read(arguments),values=this.getValues(),
t=Curve.getNearestTime(values,point);values=Curve.getPoint(values,t);return new CurveLocation(this,t,values,null,point.getDistance(values))},getNearestPoint:function(){var loc=this.getNearestLocation.apply(this,arguments);return loc?loc.getPoint():loc}},new function(){var methods="getPoint getTangent getNormal getWeightedTangent getWeightedNormal getCurvature".split(" ");return Base.each(methods,function(name){this[name+"At"]=function(location,_isTime){var values=this.getValues();return Curve[name](values,
_isTime?location:Curve.getTimeAt(values,location))};this[name+"AtTime"]=function(time){return Curve[name](this.getValues(),time)}},{statics:{_evaluateMethods:methods}})},new function(){function getLengthIntegrand(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],ax=9*(x1-x2)+3*(v[6]-x0),bx=6*(x0+x2)-12*x1,cx=3*(x1-x0),ay=9*(y1-y2)+3*(v[7]-y0),by=6*(y0+y2)-12*y1,cy=3*(y1-y0);return function(t){var dx=(ax*t+bx)*t+cx;t=(ay*t+by)*t+cy;return Math.sqrt(dx*dx+t*t)}}function evaluate(v,t,type,normalized){if(null==
t||0>t||1<t)return null;var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7];v=Numerical.isZero;v(x1-x0)&&v(y1-y0)&&(x1=x0,y1=y0);v(x2-x3)&&v(y2-y3)&&(x2=x3,y2=y3);var cx=3*(x1-x0);v=3*(x2-x1)-cx;var ax=x3-x0-cx-v,cy=3*(y1-y0),by=3*(y2-y1)-cy,ay=y3-y0-cy-by;0===type?(x0=0===t?x0:1===t?x3:((ax*t+v)*t+cx)*t+x0,y0=0===t?y0:1===t?y3:((ay*t+by)*t+cy)*t+y0):(1E-8>t?(x0=cx,y0=cy):.99999999<t?(x0=3*(x3-x2),y0=3*(y3-y2)):(x0=(3*ax*t+2*v)*t+cx,y0=(3*ay*t+2*by)*t+cy),normalized&&(0===x0&&0===
y0&&(1E-8>t||.99999999<t)&&(x0=x2-x1,y0=y2-y1),normalized=Math.sqrt(x0*x0+y0*y0))&&(x0/=normalized,y0/=normalized),3===type&&(normalized=Math.pow(x0*x0+y0*y0,1.5),x0=0!==normalized?(x0*(6*ay*t+2*by)-y0*(6*ax*t+2*v))/normalized:0,y0=0));return 2===type?new Point(y0,-x0):new Point(x0,y0)}return{statics:{classify:function(v){function type$jscomp$0(type,t1,t2){var hasRoots=undefined!==t1,t1Ok=hasRoots&&0<t1&&1>t1,t2Ok=hasRoots&&0<t2&&1>t2;!hasRoots||(t1Ok||t2Ok)&&("loop"!==type||t1Ok&&t2Ok)||(type="arch",
t1Ok=t2Ok=!1);return{type:type,roots:t1Ok||t2Ok?t1Ok&&t2Ok?t1<t2?[t1,t2]:[t2,t1]:[t1Ok?t1:t2]:null}}var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6];v=v[7];var a2=x1*(y0-v)+y1*(x3-x0)+x0*v-y0*x3;y1=3*(x2*(y1-y0)+y2*(x0-x1)+x1*y0-y1*x0);x1=y1-a2;x0=x1-a2+(x0*(v-y2)+y0*(x2-x3)+x3*y2-v*x2);y0=Math.sqrt(x0*x0+x1*x1+y1*y1);x2=0!==y0?1/y0:0;y0=Numerical.isZero;x0*=x2;x1*=x2;y1*=x2;if(y0(x0))return y0(x1)?type$jscomp$0(y0(y1)?"line":"quadratic"):type$jscomp$0("serpentine",y1/(3*x1));y1=3*x1*x1-
4*x0*y1;if(y0(y1))return type$jscomp$0("cusp",x1/(2*x0));y0=0<y1?Math.sqrt(y1/3):Math.sqrt(-y1);x0*=2;return type$jscomp$0(0<y1?"serpentine":"loop",(x1+y0)/x0,(x1-y0)/x0)},getLength:function(v,a,b,ds){undefined===a&&(a=0);undefined===b&&(b=1);return Curve.isStraight(v)?(1>b&&(v=Curve.subdivide(v,b)[0],a/=b),0<a&&(v=Curve.subdivide(v,a)[1]),a=v[6]-v[0],b=v[7]-v[1],Math.sqrt(a*a+b*b)):Numerical.integrate(ds||getLengthIntegrand(v),a,b,Math.max(2,Math.min(16,Math.ceil(32*Math.abs(b-a)))))},getTimeAt:function(v,
offset,start){undefined===start&&(start=0>offset?1:0);if(0===offset)return start;var abs=Math.abs,forward=0<offset,a=forward?start:0,b=forward?1:start,ds=getLengthIntegrand(v);v=Curve.getLength(v,a,b,ds);var diff=abs(offset)-v;if(1E-12>abs(diff))return forward?b:a;if(1E-12<diff)return null;var length=0;return Numerical.findRoot(function(t){length+=Numerical.integrate(ds,start,t,Math.max(2,Math.min(16,Math.ceil(32*Math.abs(t-start)))));start=t;return length-offset},ds,start+offset/v,a,b,32,1E-12)},
getPoint:function(v,t){return evaluate(v,t,0,!1)},getTangent:function(v,t){return evaluate(v,t,1,!0)},getWeightedTangent:function(v,t){return evaluate(v,t,1,!1)},getNormal:function(v,t){return evaluate(v,t,2,!0)},getWeightedNormal:function(v,t){return evaluate(v,t,2,!1)},getCurvature:function(v,t){return evaluate(v,t,3,!1).x},getPeaks:function(v){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],ax=-x0+3*x1-3*x2+v[6];x2=3*x0-6*x1+3*x2;x0=-3*x0+3*x1;v=-y0+3*y1-3*y2+v[7];y2=3*y0-6*y1+3*y2;y0=-3*y0+
3*y1;y1=[];Numerical.solveCubic(9*(ax*ax+v*v),9*(ax*x2+y2*v),2*(x2*x2+y2*y2)+3*(x0*ax+y0*v),x0*x2+y2*y0,y1,1E-8,.99999999);return y1.sort()}}}},new function(){function addLocation(locations,include,c1,t1,c2,t2,overlap){var excludeStart=!overlap&&c1.getPrevious()===c2,excludeEnd=!overlap&&c1!==c2&&c1.getNext()===c2;null!==t1&&t1>=(excludeStart?1E-8:0)&&t1<=(excludeEnd?.99999999:1)&&null!==t2&&t2>=(excludeEnd?1E-8:0)&&t2<=(excludeStart?.99999999:1)&&(c1=new CurveLocation(c1,t1,null,overlap),c2=new CurveLocation(c2,
t2,null,overlap),c1._intersection=c2,c2._intersection=c1,include&&!include(c1)||CurveLocation.insert(locations,c1,!0))}function addCurveIntersections(v1,v2,c1,c2,locations,include,flip,recursion,calls,tMin,tMax,uMin,uMax){if(4096<=++calls||40<=++recursion)return calls;var q0x=v2[0],q0y=v2[1],q3x=v2[6],q3y=v2[7],getSignedDistance=Line.getSignedDistance,d1=getSignedDistance(q0x,q0y,q3x,q3y,v2[2],v2[3]),d2=getSignedDistance(q0x,q0y,q3x,q3y,v2[4],v2[5]),factor=0<d1*d2?.75:4/9,dMin=factor*Math.min(0,d1,
d2);factor*=Math.max(0,d1,d2);var dp0=getSignedDistance(q0x,q0y,q3x,q3y,v1[0],v1[1]),dp1=getSignedDistance(q0x,q0y,q3x,q3y,v1[2],v1[3]),dp2=getSignedDistance(q0x,q0y,q3x,q3y,v1[4],v1[5]);q0x=getSignedDistance(q0x,q0y,q3x,q3y,v1[6],v1[7]);q3y=[0,dp0];getSignedDistance=[1/3,dp1];var p2=[2/3,dp2],p3=[1,q0x];q0y=dp1-(2*dp0+q0x)/3;q3x=dp2-(dp0+2*q0x)/3;if(0>q0y*q3x)q3y=[[q3y,getSignedDistance,p3],[q3y,p2,p3]];else{var distRatio=q0y/q3x;q3y=[2<=distRatio?[q3y,getSignedDistance,p3]:.5>=distRatio?[q3y,p2,
p3]:[q3y,getSignedDistance,p2,p3],[q3y,p3]]}q3x=0>(q0y||q3x)?q3y.reverse():q3y;q0y=q3x[0];q3x=q3x[1];var tMinClip,tMaxClip;if(0===d1&&0===d2&&0===dp0&&0===dp1&&0===dp2&&0===q0x||null==(tMinClip=clipConvexHull(q0y,q3x,dMin,factor))||null==(tMaxClip=clipConvexHull(q0y.reverse(),q3x.reverse(),dMin,factor)))return calls;d1=tMin+(tMax-tMin)*tMinClip;tMin+=(tMax-tMin)*tMaxClip;1E-9>Math.max(uMax-uMin,tMin-d1)?(v1=(d1+tMin)/2,v2=(uMin+uMax)/2,addLocation(locations,include,flip?c2:c1,flip?v2:v1,flip?c1:c2,
flip?v1:v2)):(v1=Curve.getPart(v1,tMinClip,tMaxClip),tMax=uMax-uMin,.8<tMaxClip-tMinClip?tMin-d1>tMax?(tMinClip=Curve.subdivide(v1,.5),v1=(d1+tMin)/2,calls=addCurveIntersections(v2,tMinClip[0],c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,d1,v1),calls=addCurveIntersections(v2,tMinClip[1],c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,v1,tMin)):(tMinClip=Curve.subdivide(v2,.5),v2=(uMin+uMax)/2,calls=addCurveIntersections(tMinClip[0],v1,c2,c1,locations,include,!flip,recursion,calls,
uMin,v2,d1,tMin),calls=addCurveIntersections(tMinClip[1],v1,c2,c1,locations,include,!flip,recursion,calls,v2,uMax,d1,tMin)):calls=0===tMax||1E-9<=tMax?addCurveIntersections(v2,v1,c2,c1,locations,include,!flip,recursion,calls,uMin,uMax,d1,tMin):addCurveIntersections(v1,v2,c1,c2,locations,include,flip,recursion,calls,d1,tMin,uMin,uMax));return calls}function clipConvexHull(hullTop,hullBottom,dMin,dMax){return hullTop[0][1]<dMin?clipConvexHullPart(hullTop,!0,dMin):hullBottom[0][1]>dMax?clipConvexHullPart(hullBottom,
!1,dMax):hullTop[0][0]}function clipConvexHullPart(part,top,threshold){for(var px=part[0][0],py=part[0][1],i=1,l=part.length;i<l;i++){var qx=part[i][0],qy=part[i][1];if(top?qy>=threshold:qy<=threshold)return qy===threshold?qx:px+(threshold-py)*(qx-px)/(qy-py);px=qx;py=qy}return null}function getCurveLineIntersections(v,px,py,vx,vy){var isZero=Numerical.isZero;if(isZero(vx)&&isZero(vy))return v=Curve.getTimeOf(v,new Point(px,py)),null===v?[]:[v];vy=Math.atan2(-vy,vx);vx=Math.sin(vy);vy=Math.cos(vy);
isZero=[];for(var roots=[],i=0;8>i;i+=2){var x=v[i]-px,y=v[i+1]-py;isZero.push(x*vy-y*vx,x*vx+y*vy)}Curve.solveCubic(isZero,1,0,roots,0,1);return roots}function addCurveLineIntersections(v1,v2,c1,c2,locations,include,flip){var x1=v2[0],y1=v2[1];x1=getCurveLineIntersections(v1,x1,y1,v2[6]-x1,v2[7]-y1);y1=0;for(var l=x1.length;y1<l;y1++){var t1=x1[y1],p1=Curve.getPoint(v1,t1);p1=Curve.getTimeOf(v2,p1);null!==p1&&addLocation(locations,include,flip?c2:c1,flip?p1:t1,flip?c1:c2,flip?t1:p1)}}function addLineIntersection(v1,
v2,c1,c2,locations,include){var pt=Line.intersect(v1[0],v1[1],v1[6],v1[7],v2[0],v2[1],v2[6],v2[7]);pt&&addLocation(locations,include,c1,Curve.getTimeOf(v1,pt),c2,Curve.getTimeOf(v2,pt))}function getCurveIntersections(v1,v2,c1,c2,locations,include){var min=Math.min,max=Math.max;if(max(v1[0],v1[2],v1[4],v1[6])+1E-12>min(v2[0],v2[2],v2[4],v2[6])&&min(v1[0],v1[2],v1[4],v1[6])-1E-12<max(v2[0],v2[2],v2[4],v2[6])&&max(v1[1],v1[3],v1[5],v1[7])+1E-12>min(v2[1],v2[3],v2[5],v2[7])&&min(v1[1],v1[3],v1[5],v1[7])-
1E-12<max(v2[1],v2[3],v2[5],v2[7]))if(max=getOverlaps(v1,v2))for(min=0;2>min;min++)v1=max[min],addLocation(locations,include,c1,v1[0],c2,v1[1],!0);else{min=Curve.isStraight(v1);max=Curve.isStraight(v2);var straight=min&&max,flip=min&&!max,before=locations.length;(straight?addLineIntersection:min||max?addCurveLineIntersections:addCurveIntersections)(flip?v2:v1,flip?v1:v2,flip?c2:c1,flip?c1:c2,locations,include,flip,0,0,0,1,0,1);if(!straight||locations.length===before)for(min=0;4>min;min++)max=min>>
1,straight=min&1,before=6*max,flip=6*straight,before=new Point(v1[before],v1[before+1]),flip=new Point(v2[flip],v2[flip+1]),before.isClose(flip,1E-12)&&addLocation(locations,include,c1,max,c2,straight)}return locations}function getSelfIntersection(v1,c1,locations,include){v1=Curve.classify(v1);"loop"===v1.type&&(v1=v1.roots,addLocation(locations,include,c1,v1[0],c1,v1[1]));return locations}function getOverlaps(v1,v2){function getSquaredLineLength(v){var x=v[6]-v[0];v=v[7]-v[1];return x*x+v*v}var abs=
Math.abs,getDistance=Line.getDistance,straight1=Curve.isStraight(v1),straight2=Curve.isStraight(v2),straightBoth=straight1&&straight2,flip=getSquaredLineLength(v1)<getSquaredLineLength(v2),l1=flip?v2:v1;flip=flip?v1:v2;var px=l1[0],py=l1[1],vx=l1[6]-px,vy=l1[7]-py;if(1E-7>getDistance(px,py,vx,vy,flip[0],flip[1],!0)&&1E-7>getDistance(px,py,vx,vy,flip[6],flip[7],!0))!straightBoth&&1E-7>getDistance(px,py,vx,vy,l1[2],l1[3],!0)&&1E-7>getDistance(px,py,vx,vy,l1[4],l1[5],!0)&&1E-7>getDistance(px,py,vx,vy,
flip[2],flip[3],!0)&&1E-7>getDistance(px,py,vx,vy,flip[4],flip[5],!0)&&(straight1=straight2=straightBoth=!0);else if(straightBoth)return null;if(straight1^straight2)return null;straight1=[v1,v2];getDistance=[];for(straight2=0;4>straight2&&2>getDistance.length&&(l1=straight2&1,px=l1^1,flip=straight2>>1,px=Curve.getTimeOf(straight1[l1],new Point(straight1[px][flip?6:0],straight1[px][flip?7:1])),null!=px&&(l1=l1?[flip,px]:[px,flip],(!getDistance.length||1E-8<abs(l1[0]-getDistance[0][0])&&1E-8<abs(l1[1]-
getDistance[0][1]))&&getDistance.push(l1)),!(2<straight2)||getDistance.length);straight2++);2!==getDistance.length?getDistance=null:!straightBoth&&(v1=Curve.getPart(v1,getDistance[0][0],getDistance[1][0]),v2=Curve.getPart(v2,getDistance[0][1],getDistance[1][1]),1E-7<abs(v2[2]-v1[2])||1E-7<abs(v2[3]-v1[3])||1E-7<abs(v2[4]-v1[4])||1E-7<abs(v2[5]-v1[5]))&&(getDistance=null);return getDistance}return{getIntersections:function(curve){var v1=this.getValues(),v2=curve&&curve!==this&&curve.getValues();return v2?
getCurveIntersections(v1,v2,this,curve,[]):getSelfIntersection(v1,this,[])},statics:{getOverlaps:getOverlaps,getIntersections:function(curves1,curves2,include,matrix1,matrix2,_returnFirst){var self=!curves2;self&&(curves2=curves1);for(var length1=curves1.length,length2=curves2.length,values1=Array(length1),values2=self?values1:Array(length2),locations=[],i=0;i<length1;i++)values1[i]=curves1[i].getValues(matrix1);if(!self)for(i=0;i<length2;i++)values2[i]=curves2[i].getValues(matrix2);matrix1=CollisionDetection.findCurveBoundsCollisions(values1,
values2,1E-7);for(matrix2=0;matrix2<length1;matrix2++){length2=curves1[matrix2];i=values1[matrix2];self&&getSelfIntersection(i,length2,locations,include);var collisions1=matrix1[matrix2];if(collisions1)for(var j=0;j<collisions1.length;j++){if(_returnFirst&&locations.length)return locations;var index2=collisions1[j];(!self||index2>matrix2)&&getCurveIntersections(i,values2[index2],length2,curves2[index2],locations,include)}}return locations},getCurveLineIntersections:getCurveLineIntersections,getTimesWithTangent:function(v,
tangent){var x0=v[0],y0=v[1],x1=v[2],y1=v[3],x2=v[4],y2=v[5],x3=v[6],y3=v[7];v=tangent.normalize();tangent=v.x;v=v.y;x3=3*x3-9*x2+9*x1-3*x0;y3=3*y3-9*y2+9*y1-3*y0;x2=6*x2-12*x1+6*x0;y2=6*y2-12*y1+6*y0;x0=3*x1-3*x0;x1=3*y1-3*y0;y1=2*x3*v-2*y3*tangent;y0=[];Math.abs(y1)<Numerical.CURVETIME_EPSILON?(y1=x3*y2-y3*x2,0!=y1&&(tangent=-(x3*x1-y3*x0)/y1,0<=tangent&&1>=tangent&&y0.push(tangent))):(x0=(x2*x2-4*x3*x0)*v*v+(-2*x2*y2+4*y3*x0+4*x3*x1)*tangent*v+(y2*y2-4*y3*x1)*tangent*tangent,tangent=x2*v-y2*tangent,
0<=x0&&0!=y1&&(x0=Math.sqrt(x0),v=-(tangent+x0)/y1,tangent=(-tangent+x0)/y1,0<=v&&1>=v&&y0.push(v),0<=tangent&&1>=tangent&&y0.push(tangent)));return y0}}}}),CurveLocation=Base.extend({_class:"CurveLocation",initialize:function(curve,time,point,_overlap,_distance){if(.99999999<=time){var next=curve.getNext();next&&(time=0,curve=next)}this._setCurve(curve);this._time=time;this._point=point||curve.getPointAtTime(time);this._overlap=_overlap;this._distance=_distance;this._intersection=this._next=this._previous=
null},_setCurve:function(curve){var path=curve._path;this._version=(this._path=path)?path._version:0;this._curve=curve;this._segment=null;this._segment1=curve._segment1;this._segment2=curve._segment2},_setSegment:function(segment){this._setCurve(segment.getCurve());this._segment=segment;this._time=segment===this._segment1?0:1;this._point=segment._point.clone()},getSegment:function(){var segment=this._segment;if(!segment){var curve=this.getCurve(),time=this.getTime();0===time?segment=curve._segment1:
1===time?segment=curve._segment2:null!=time&&(segment=curve.getPartLength(0,time)<curve.getPartLength(time,1)?curve._segment1:curve._segment2);this._segment=segment}return segment},getCurve:function(){function trySegment(segment){if((segment=segment&&segment.getCurve())&&null!=(that._time=segment.getTimeOf(that._point)))return that._setCurve(segment),segment}var path=this._path,that=this;path&&path._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);return this._curve||
trySegment(this._segment)||trySegment(this._segment1)||trySegment(this._segment2.getPrevious())},getPath:function(){var curve=this.getCurve();return curve&&curve._path},getIndex:function(){var curve=this.getCurve();return curve&&curve.getIndex()},getTime:function(){var curve=this.getCurve(),time=this._time;return curve&&null==time?this._time=curve.getTimeOf(this._point):time},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var offset=this._offset;if(null==offset){offset=
0;var path=this.getPath(),index=this.getIndex();if(path&&null!=index){path=path.getCurves();for(var i=0;i<index;i++)offset+=path[i].getLength()}this._offset=offset+=this.getCurveOffset()}return offset},getCurveOffset:function(){var offset=this._curveOffset;if(null==offset){offset=this.getCurve();var time=this.getTime();this._curveOffset=offset=null!=time&&offset&&offset.getPartLength(0,time)}return offset},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},
divide:function(){var curve=this.getCurve();(curve=curve&&curve.divideAtTime(this.getTime()))&&this._setSegment(curve._segment1);return curve},split:function(){var curve=this.getCurve(),path=curve._path;(curve=curve&&curve.splitAtTime(this.getTime()))&&this._setSegment(path.getLastSegment());return curve},equals:function(loc,_ignoreOther){var res=this===loc;if(!res&&loc instanceof CurveLocation){var c1=this.getCurve(),c2=loc.getCurve();c1=c1._path;if(c1===c2._path){res=Math.abs;c2=res(this.getOffset()-
loc.getOffset());var i1=!_ignoreOther&&this._intersection;loc=!_ignoreOther&&loc._intersection;res=(1E-7>c2||c1&&1E-7>res(c1.getLength()-c2))&&(!i1&&!loc||i1&&loc&&i1.equals(loc,!0))}}return res},toString:function(){var parts=[],point=this.getPoint(),f=Formatter.instance;point&&parts.push("point: "+point);point=this.getIndex();null!=point&&parts.push("index: "+point);point=this.getTime();null!=point&&parts.push("time: "+f.number(point));null!=this._distance&&parts.push("distance: "+f.number(this._distance));
return"{ "+parts.join(", ")+" }"},isTouching:function(){var inter=this._intersection;if(inter&&this.getTangent().isCollinear(inter.getTangent())){var curve1=this.getCurve();inter=inter.getCurve();return!(curve1.isStraight()&&inter.isStraight()&&curve1.getLine().intersect(inter.getLine()))}return!1},isCrossing:function(){function addOffsets(curve,end){var v=curve.getValues(),roots=Curve.classify(v).roots||Curve.getPeaks(v);curve=roots.length;end=Curve.getLength(v,end&&curve?roots[curve-1]:0,!end&&
curve?roots[0]:1);offsets.push(curve?end:end/64)}function isInRange(angle,min,max){return min<max?angle>min&&angle<max:angle>min||angle<max}var inter=this._intersection;if(!inter)return!1;var t1=this.getTime(),t2=inter.getTime(),t1Inside=1E-8<=t1&&.99999999>=t1,t2Inside=1E-8<=t2&&.99999999>=t2;if(t1Inside&&t2Inside)return!this.isTouching();var c2=this.getCurve(),c1=c2&&1E-8>t1?c2.getPrevious():c2,c4=inter.getCurve();inter=c4&&1E-8>t2?c4.getPrevious():c4;.99999999<t1&&(c2=c2.getNext());.99999999<t2&&
(c4=c4.getNext());if(!(c1&&c2&&inter&&c4))return!1;var offsets=[];t1Inside||(addOffsets(c1,!0),addOffsets(c2,!1));t2Inside||(addOffsets(inter,!0),addOffsets(c4,!1));var pt=this.getPoint(),offset=Math.min.apply(Math,offsets);t1=t1Inside?c2.getTangentAtTime(t1):c2.getPointAt(offset).subtract(pt);c1=t1Inside?t1.negate():c1.getPointAt(-offset).subtract(pt);t2=t2Inside?c4.getTangentAtTime(t2):c4.getPointAt(offset).subtract(pt);inter=t2Inside?t2.negate():inter.getPointAt(-offset).subtract(pt);t2Inside=
c1.getAngle();pt=t1.getAngle();inter=inter.getAngle();t2=t2.getAngle();return!!(t1Inside?isInRange(t2Inside,inter,t2)^isInRange(pt,inter,t2)&&isInRange(t2Inside,t2,inter)^isInRange(pt,t2,inter):isInRange(inter,t2Inside,pt)^isInRange(t2,t2Inside,pt)&&isInRange(inter,pt,t2Inside)^isInRange(t2,pt,t2Inside))},hasOverlap:function(){return!!this._overlap}},Base.each(Curve._evaluateMethods,function(name){var get=name+"At";this[name]=function(){var curve=this.getCurve(),time=this.getTime();return null!=time&&
curve&&curve[get](time,!0)}},{preserve:!0}),new function(){function insert(locations,loc,merge){function search(index,dir){for(index+=dir;-1<=index&&index<=length;index+=dir){var loc2=locations[(index%length+length)%length];if(!loc.getPoint().isClose(loc2.getPoint(),1E-7))break;if(loc.equals(loc2))return loc2}return null}for(var length=locations.length,l=0,r=length-1;l<=r;){var m=l+r>>>1,loc2$jscomp$0=locations[m],found;if(merge&&(found=loc.equals(loc2$jscomp$0)?loc2$jscomp$0:search(m,-1)||search(m,
1)))return loc._overlap&&(found._overlap=found._intersection._overlap=!0),found;var path1=loc.getPath(),path2=loc2$jscomp$0.getPath();0>(path1!==path2?path1._id-path2._id:loc.getIndex()+loc.getTime()-(loc2$jscomp$0.getIndex()+loc2$jscomp$0.getTime()))?r=m-1:l=m+1}locations.splice(l,0,loc);return loc}return{statics:{insert:insert,expand:function(locations){for(var expanded=locations.slice(),i=locations.length-1;0<=i;i--)insert(expanded,locations[i]._intersection,!1);return expanded}}}}),PathItem=Item.extend({_class:"PathItem",
_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(arg){if(Base.isPlainObject(arg)){var segments=arg.segments;var data=arg.pathData}else Array.isArray(arg)?segments=arg:"string"===typeof arg&&(data=arg);if(segments)var compound=(data=segments[0])&&Array.isArray(data[0]);else data&&(compound=1<(data.match(/m/gi)||[]).length||/z\s*\S+/i.test(data));return new (compound?CompoundPath:Path)(arg)}},_asPathItem:function(){return this},isClockwise:function(){return 0<=
this.getArea()},setClockwise:function(clockwise){this.isClockwise()!=!!clockwise&&this.reverse()},setPathData:function(data){function getCoord(index,coord){index=+coords[index];relative&&(index+=current[coord]);return index}function getPoint(index){return new Point(getCoord(index,"x"),getCoord(index+1,"y"))}data=data&&data.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig);var coords,relative=!1,current=new Point,start=new Point;this.clear();for(var i=0,l=data&&data.length;i<l;i++){var part=data[i],command=part[0],
lower=command.toLowerCase();part=(coords=part.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&coords.length;relative=command===lower;"z"!==previous||/[mz]/.test(lower)||this.moveTo(current);switch(lower){case "m":case "l":var previous="m"===lower;for(command=0;command<part;command+=2)this[previous?"moveTo":"lineTo"](current=getPoint(command)),previous&&(start=current,previous=!1);var control=current;break;case "h":case "v":previous="h"===lower?"x":"y";current=current.clone();for(command=0;command<
part;command++)current[previous]=getCoord(command,previous),this.lineTo(current);control=current;break;case "c":for(command=0;command<part;command+=6)this.cubicCurveTo(getPoint(command),control=getPoint(command+2),current=getPoint(command+4));break;case "s":for(command=0;command<part;command+=4)this.cubicCurveTo(/[cs]/.test(previous)?current.multiply(2).subtract(control):current,control=getPoint(command),current=getPoint(command+2)),previous=lower;break;case "q":for(command=0;command<part;command+=
4)this.quadraticCurveTo(control=getPoint(command),current=getPoint(command+2));break;case "t":for(command=0;command<part;command+=2)this.quadraticCurveTo(control=/[qt]/.test(previous)?current.multiply(2).subtract(control):current,current=getPoint(command)),previous=lower;break;case "a":for(command=0;command<part;command+=7)this.arcTo(current=getPoint(command+5),new Size(+coords[command],+coords[command+1]),+coords[command+2],+coords[command+4],+coords[command+3]);break;case "z":this.closePath(1E-12),
current=start}previous=lower}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(point){point=point.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(point):{};return point.onPath||!!("evenodd"===this.getFillRule()?point.windingL&1||point.windingR&1:point.winding)},getIntersections:function(path,include,_matrix,_returnFirst){var self=this===path||!path,matrix1=this._matrix._orNullIfIdentity();_matrix=self?matrix1:(_matrix||path._matrix)._orNullIfIdentity();
return self||this.getBounds(matrix1).intersects(path.getBounds(_matrix),1E-12)?Curve.getIntersections(this.getCurves(),!self&&path.getCurves(),include,matrix1,_matrix,_returnFirst):[]},getCrossings:function(path){return this.getIntersections(path,function(inter){return inter.isCrossing()})},getNearestLocation:function(){for(var point=Point.read(arguments),curves=this.getCurves(),minDist=Infinity,minLoc=null,i=0,l=curves.length;i<l;i++){var loc=curves[i].getNearestLocation(point);loc._distance<minDist&&
(minDist=loc._distance,minLoc=loc)}return minLoc},getNearestPoint:function(){var loc=this.getNearestLocation.apply(this,arguments);return loc?loc.getPoint():loc},interpolate:function(from,to,factor){var isPath=!this._children,name=isPath?"_segments":"_children",itemsFrom=from[name],itemsTo=to[name];name=this[name];if(!itemsFrom||!itemsTo||itemsFrom.length!==itemsTo.length)throw Error("Invalid operands in interpolate() call: "+from+", "+to);var current=name.length;to=itemsTo.length;if(current<to)for(var ctor=
isPath?Segment:Path;current<to;current++)this.add(new ctor);else if(current>to)this[isPath?"removeSegments":"removeChildren"](to,current);for(current=0;current<to;current++)name[current].interpolate(itemsFrom[current],itemsTo[current],factor);isPath&&(this.setClosed(from._closed),this._changed(9))},compare:function(path){var ok=!1;if(path){var paths1=this._children||[this];path=path._children?path._children.slice():[path];var length1=paths1.length,length2=path.length,matched=[],count=0;ok=!0;var boundsOverlaps=
CollisionDetection.findBoundsOverlaps(paths1,path,Numerical.GEOMETRIC_EPSILON);for(--length1;0<=length1&&ok;length1--){var path1=paths1[length1];ok=!1;var pathBoundsOverlaps=boundsOverlaps[length1];if(pathBoundsOverlaps)for(var i2=pathBoundsOverlaps.length-1;0<=i2&&!ok;i2--)path1.compare(path[pathBoundsOverlaps[i2]])&&(matched[pathBoundsOverlaps[i2]]||(matched[pathBoundsOverlaps[i2]]=!0,count++),ok=!0)}ok=ok&&count===length2}return ok}}),Path=PathItem.extend({_class:"Path",_serializeFields:{segments:[],
closed:!1},initialize:function(arg){this._closed=!1;this._segments=[];this._version=0;var args=arguments;(args=Array.isArray(arg)?"object"===typeof arg[0]?arg:args:!arg||undefined!==arg.size||undefined===arg.x&&undefined===arg.point?null:args)&&0<args.length?this.setSegments(args):(this._curves=undefined,this._segmentSelection=0,args||"string"!==typeof arg||(this.setPathData(arg),arg=null));this._initialize(!args&&arg)},_equals:function(item){return this._closed===item._closed&&Base.equals(this._segments,
item._segments)},copyContent:function(source){this.setSegments(source._segments);this._closed=source._closed},_changed:function _changed(flags){_changed.base.call(this,flags);if(flags&8)if(this._length=this._area=undefined,flags&32)this._version++;else{if(this._curves){flags=0;for(var l=this._curves.length;flags<l;flags++)this._curves[flags]._changed()}}else flags&64&&(this._bounds=undefined)},getStyle:function(){var parent=this._parent;return(parent instanceof CompoundPath?parent:this)._style},getSegments:function(){return this._segments},
setSegments:function(segments){var fullySelected=this.isFullySelected(),length=segments&&segments.length;this._segmentSelection=this._segments.length=0;this._curves=undefined;if(length){var last=segments[length-1];"boolean"===typeof last&&(this.setClosed(last),length--);this._add(Segment.readList(segments,0,{},length))}fullySelected&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var curves=
this._curves,segments=this._segments;if(!curves){var length=this._countCurves();curves=this._curves=Array(length);for(var i=0;i<length;i++)curves[i]=new Curve(this,segments[i],segments[i+1]||segments[0])}return curves},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var curves=this.getCurves();return curves[curves.length-1]},isClosed:function(){return this._closed},setClosed:function(closed){if(this._closed!=(closed=!!closed)){this._closed=closed;if(this._curves){var length=
this._curves.length=this._countCurves();closed&&(this._curves[length-1]=new Curve(this,this._segments[length-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(_matrix,_precision){function addSegment(segment,skipLine){segment._transformCoordinates(_matrix,coords);curX=coords[0];curY=coords[1];first?(parts.push("M"+f.pair(curX,curY)),first=!1):(inX=coords[2],inY=coords[3],inX===curX&&inY===curY&&outX===prevX&&outY===prevY?skipLine||(segment=curX-prevX,skipLine=curY-prevY,parts.push(0===
segment?"v"+f.number(skipLine):0===skipLine?"h"+f.number(segment):"l"+f.pair(segment,skipLine))):parts.push("c"+f.pair(outX-prevX,outY-prevY)+" "+f.pair(inX-prevX,inY-prevY)+" "+f.pair(curX-prevX,curY-prevY)));prevX=curX;prevY=curY;outX=coords[4];outY=coords[5]}var segments=this._segments,length=segments.length,f=new Formatter(_precision),coords=Array(6),first=!0,curX,curY,prevX,prevY,inX,inY,outX,outY,parts=[];if(!length)return"";for(_precision=0;_precision<length;_precision++)addSegment(segments[_precision]);
this._closed&&0<length&&(addSegment(segments[0],!0),parts.push("z"));return parts.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(matrix){for(var segments=this._segments,coords=Array(6),i=0,l=segments.length;i<l;i++)segments[i]._transformCoordinates(matrix,coords,!0);return!0},_add:function(segs,index){var segments=this._segments,curves=this._curves,amount=segs.length,append=null==index;index=append?segments.length:index;for(var i=0;i<amount;i++){var segment=
segs[i];segment._path&&(segment=segs[i]=segment.clone());segment._path=this;segment._index=index+i;segment._selection&&this._updateSelection(segment,0,segment._selection)}if(append)Base.push(segments,segs);else for(segments.splice.apply(segments,[index,0].concat(segs)),i=index+amount,append=segments.length;i<append;i++)segments[i]._index=i;if(curves){i=this._countCurves();segments=index=0<index&&index+amount-1===i?index-1:index;amount=Math.min(index+amount,i);segs._curves&&(curves.splice.apply(curves,
[index,0].concat(segs._curves)),segments+=segs._curves.length);for(i=segments;i<amount;i++)curves.splice(i,0,new Curve(this,null,null));this._adjustCurves(index,amount)}this._changed(41);return segs},_adjustCurves:function(start,end){for(var segments=this._segments,curves=this._curves,curve,i=start;i<end;i++)curve=curves[i],curve._path=this,curve._segment1=segments[i],curve._segment2=segments[i+1]||segments[0],curve._changed();if(curve=curves[this._closed&&!start?segments.length-1:start-1])curve._segment2=
segments[start]||segments[0],curve._changed();if(curve=curves[end])curve._segment1=segments[end],curve._changed()},_countCurves:function(){var length=this._segments.length;return!this._closed&&0<length?length-1:length},add:function(segment1){var args=arguments;return 1<args.length&&"number"!==typeof segment1?this._add(Segment.readList(args)):this._add([Segment.read(args)])[0]},insert:function(index,segment1){var args=arguments;return 2<args.length&&"number"!==typeof segment1?this._add(Segment.readList(args,
1),index):this._add([Segment.read(args,1)],index)[0]},addSegment:function(){return this._add([Segment.read(arguments)])[0]},insertSegment:function(index){return this._add([Segment.read(arguments,1)],index)[0]},addSegments:function(segments){return this._add(Segment.readList(segments))},insertSegments:function(index,segments){return this._add(Segment.readList(segments),index)},removeSegment:function(index){return this.removeSegments(index,index+1)[0]||null},removeSegments:function(start,end,_includeCurves){start=
start||0;end=Base.pick(end,this._segments.length);var segments=this._segments,curves=this._curves,count=segments.length,removed=segments.splice(start,end-start),amount=removed.length;if(!amount)return removed;for(var i=0;i<amount;i++){var segment=removed[i];segment._selection&&this._updateSelection(segment,segment._selection,0);segment._index=segment._path=null}i=start;for(segment=segments.length;i<segment;i++)segments[i]._index=i;if(curves){start=0<start&&end===count+(this._closed?1:0)?start-1:start;
curves=curves.splice(start,amount);for(i=curves.length-1;0<=i;i--)curves[i]._path=null;_includeCurves&&(removed._curves=curves.slice(1));this._adjustCurves(start,start)}this._changed(41);return removed},clear:"#removeSegments",hasHandles:function(){for(var segments=this._segments,i=0,l=segments.length;i<l;i++)if(segments[i].hasHandles())return!0;return!1},clearHandles:function(){for(var segments=this._segments,i=0,l=segments.length;i<l;i++)segments[i].clearHandles()},getLength:function(){if(null==
this._length){for(var curves=this.getCurves(),length=0,i=0,l=curves.length;i<l;i++)length+=curves[i].getLength();this._length=length}return this._length},getArea:function(){var area=this._area;if(null==area){for(var segments=this._segments,closed=this._closed,i=area=0,l=segments.length;i<l;i++){var last=i+1===l;area+=Curve.getArea(Curve.getValues(segments[i],segments[last?0:i+1],null,last&&!closed))}this._area=area}return area},isFullySelected:function(){var length=this._segments.length;return this.isSelected()&&
0<length&&this._segmentSelection===7*length},setFullySelected:function(selected){selected&&this._selectSegments(!0);this.setSelected(selected)},setSelection:function setSelection(selection){selection&1||this._selectSegments(!1);setSelection.base.call(this,selection)},_selectSegments:function(selected){var segments=this._segments,length=segments.length;selected=selected?7:0;this._segmentSelection=selected*length;for(var i=0;i<length;i++)segments[i]._selection=selected},_updateSelection:function(segment,
oldSelection,newSelection){segment._selection=newSelection;0<(this._segmentSelection+=newSelection-oldSelection)&&this.setSelected(!0)},divideAt:function(location){location=this.getLocationAt(location);var curve;return location&&(curve=location.getCurve().divideAt(location.getCurveOffset()))?curve._segment1:null},splitAt:function(location){var loc=this.getLocationAt(location);location=loc&&loc.index;loc=loc&&loc.time;.99999999<loc&&(location++,loc=0);var curves=this.getCurves();return 0<=location&&
location<curves.length?(1E-8<=loc&&curves[location++].divideAtTime(loc),location=this.removeSegments(location,this._segments.length,!0),this._closed?(this.setClosed(!1),loc=this):(loc=new Path(Item.NO_INSERT),loc.insertAbove(this),loc.copyAttributes(this)),loc._add(location,0),this.addSegment(location[0]),loc):null},split:function(index,time){var curve;index=undefined===time?index:(curve=this.getCurves()[index])&&curve.getLocationAtTime(time);return null!=index?this.splitAt(index):null},join:function(path,
tolerance){tolerance=tolerance||0;if(path&&path!==this){var segments=path._segments,last1=this.getLastSegment(),last2=path.getLastSegment();if(!last2)return this;last1&&last1._point.isClose(last2._point,tolerance)&&path.reverse();last2=path.getFirstSegment();last1&&last1._point.isClose(last2._point,tolerance)?(last1.setHandleOut(last2._handleOut),this._add(segments.slice(1))):((last1=this.getFirstSegment())&&last1._point.isClose(last2._point,tolerance)&&path.reverse(),last2=path.getLastSegment(),
last1&&last1._point.isClose(last2._point,tolerance)?(last1.setHandleIn(last2._handleIn),this._add(segments.slice(0,segments.length-1),0)):this._add(segments.slice()));path._closed&&this._add([segments[0]]);path.remove()}path=this.getFirstSegment();segments=this.getLastSegment();path!==segments&&path._point.isClose(segments._point,tolerance)&&(path.setHandleIn(segments._handleIn),segments.remove(),this.setClosed(!0));return this},reduce:function(options){for(var curves=this.getCurves(),tolerance=(options=
options&&options.simplify)?1E-7:0,i=curves.length-1;0<=i;i--){var curve=curves[i];!curve.hasHandles()&&(!curve.hasLength(tolerance)||options&&curve.isCollinear(curve.getNext()))&&curve.remove()}return this},reverse:function(){this._segments.reverse();for(var i=0,l=this._segments.length;i<l;i++){var segment=this._segments[i],handleIn=segment._handleIn;segment._handleIn=segment._handleOut;segment._handleOut=handleIn;segment._index=i}this._curves=null;this._changed(9)},flatten:function(flatness){flatness=
(new PathFlattener(this,flatness||.25,256,!0)).parts;for(var length=flatness.length,segments=[],i=0;i<length;i++)segments.push(new Segment(flatness[i].curve.slice(0,2)));!this._closed&&0<length&&segments.push(new Segment(flatness[length-1].curve.slice(6)));this.setSegments(segments)},simplify:function(tolerance){(tolerance=(new PathFitter(this)).fit(tolerance||2.5))&&this.setSegments(tolerance);return!!tolerance},smooth:function(options){function getIndex(value,_default){var index=value&&value.index;
if(null!=index){var path=value.path;if(path&&path!==that)throw Error(value._class+" "+index+" of "+path+" is not part of "+that);_default&&value instanceof Curve&&index++}else index="number"===typeof value?value:_default;return Math.min(0>index&&closed?index%length:0>index?index+length:index,length-1)}var that=this,opts=options||{},type=opts.type||"asymmetric";options=this._segments;var length=options.length,closed=this._closed,loop=closed&&undefined===opts.from&&undefined===opts.to,from=getIndex(opts.from,
0),to=getIndex(opts.to,length-1);if(from>to)if(closed)from-=length;else{var tmp=from;from=to;to=tmp}if(/^(?:asymmetric|continuous)$/.test(type)){var asymmetric="asymmetric"===type;type=Math.min;opts=to-from+1;var n=opts-1,paddingRight=opts=tmp=loop?type(opts,4):1,knots=[];closed||(opts=type(1,from),paddingRight=type(1,length-to-1));n+=opts+paddingRight;if(!(1>=n)){type=0;for(var j=from-opts;type<=n;type++,j++)knots[type]=options[(0>j?j+length:j)%length]._point;j=knots[0]._x+2*knots[1]._x;var y=knots[0]._y+
2*knots[1]._y,f=2,n_1=n-1,rx=[j],ry=[y],rf=[f];to=[];tmp=[];for(type=1;type<n;type++){var internal=type<n_1,u=internal?4:asymmetric?3:8,v=internal?2:asymmetric?0:1,m=(internal?1:asymmetric?1:2)/f;f=rf[type]=(internal?4:asymmetric?2:7)-m;j=rx[type]=u*knots[type]._x+v*knots[type+1]._x-m*j;y=ry[type]=u*knots[type]._y+v*knots[type+1]._y-m*y}to[n_1]=rx[n_1]/rf[n_1];tmp[n_1]=ry[n_1]/rf[n_1];for(type=n-2;0<=type;type--)to[type]=(rx[type]-to[type+1])/rf[type],tmp[type]=(ry[type]-tmp[type+1])/rf[type];to[n]=
(3*knots[n]._x-to[n_1])/2;tmp[n]=(3*knots[n]._y-tmp[n_1])/2;type=opts;asymmetric=n-paddingRight;for(j=from;type<=asymmetric;type++,j++)from=options[0>j?j+length:j],paddingRight=from._point,n=to[type]-paddingRight._x,paddingRight=tmp[type]-paddingRight._y,(loop||type<asymmetric)&&from.setHandleOut(n,paddingRight),(loop||type>opts)&&from.setHandleIn(-n,-paddingRight)}}else for(type=from;type<=to;type++)options[0>type?type+length:type].smooth(opts,!loop&&type===from,!loop&&type===to)},toShape:function(insert){function isCollinear(i,
j){i=segments[i];var seg2=i.getNext();j=segments[j];var seg4=j.getNext();return i._handleOut.isZero()&&seg2._handleIn.isZero()&&j._handleOut.isZero()&&seg4._handleIn.isZero()&&seg2._point.subtract(i._point).isCollinear(seg4._point.subtract(j._point))}function isOrthogonal(i){i=segments[i];var seg1=i.getPrevious(),seg3=i.getNext();return seg1._handleOut.isZero()&&i._handleIn.isZero()&&i._handleOut.isZero()&&seg3._handleIn.isZero()&&i._point.subtract(seg1._point).isOrthogonal(seg3._point.subtract(i._point))}
function isArc(i){var seg1=segments[i],seg2=seg1.getNext();i=seg1._handleOut;var handle2=seg2._handleIn;if(i.isOrthogonal(handle2)){seg1=seg1._point;seg2=seg2._point;var corner=(new Line(seg1,i,!0)).intersect(new Line(seg2,handle2,!0),!0);return corner&&Numerical.isZero(i.getLength()/corner.subtract(seg1).getLength()-.5522847498307936)&&Numerical.isZero(handle2.getLength()/corner.subtract(seg2).getLength()-.5522847498307936)}return!1}function getDistance(i,j){return segments[i]._point.getDistance(segments[j]._point)}
if(!this._closed)return null;var segments=this._segments;if(!this.hasHandles()&&4===segments.length&&isCollinear(0,2)&&isCollinear(1,3)&&isOrthogonal(1)){var type=Shape.Rectangle;var size=new Size(getDistance(0,3),getDistance(0,1));var topCenter=segments[1]._point.add(segments[2]._point).divide(2)}else if(8===segments.length&&isArc(0)&&isArc(2)&&isArc(4)&&isArc(6)&&isCollinear(1,5)&&isCollinear(3,7)){type=Shape.Rectangle;size=new Size(getDistance(1,6),getDistance(0,3));var radius=size.subtract(new Size(getDistance(0,
7),getDistance(1,2))).divide(2);topCenter=segments[3]._point.add(segments[4]._point).divide(2)}else 4===segments.length&&isArc(0)&&isArc(1)&&isArc(2)&&isArc(3)&&(Numerical.isZero(getDistance(0,2)-getDistance(1,3))?(type=Shape.Circle,radius=getDistance(0,2)/2):(type=Shape.Ellipse,radius=new Size(getDistance(2,0)/2,getDistance(3,1)/2)),topCenter=segments[1]._point);if(type){var center=this.getPosition(!0);type=new type({center:center,size:size,radius:radius,insert:!1});type.copyAttributes(this,!0);
type._matrix.prepend(this._matrix);type.rotate(topCenter.subtract(center).getAngle()+90);(undefined===insert||insert)&&type.insertAbove(this);return type}return null},toPath:"#clone",compare:function compare(path){if(!path||path instanceof CompoundPath)return compare.base.call(this,path);var curves1=this.getCurves();path=path.getCurves();var length1=curves1.length,length2=path.length;if(!length1||!length2)return length1==length2;for(var v1=curves1[0].getValues(),values2=[],pos1=0,pos2,end1=0,end2,
i=0;i<length2;i++){var v2=path[i].getValues();values2.push(v2);var overlaps=Curve.getOverlaps(v1,v2);if(overlaps){pos2=!i&&0<overlaps[0][0]?length2-1:i;end2=overlaps[0][1];break}}i=Math.abs;v2=values2[pos2];for(var start2;v1&&v2;){if((overlaps=Curve.getOverlaps(v1,v2))&&1E-8>i(overlaps[0][0]-end1)){end1=overlaps[1][0];1===end1&&(v1=++pos1<length1?curves1[pos1].getValues():null,end1=0);var t2=overlaps[0][1];if(1E-8>i(t2-end2)){start2||(start2=[pos2,t2]);end2=overlaps[1][1];1===end2&&(++pos2>=length2&&
(pos2=0),v2=values2[pos2]||path[pos2].getValues(),end2=0);if(!v1)return start2[0]===pos2&&start2[1]===end2;continue}}break}return!1},_hitTestSelf:function(point$jscomp$0,options,viewMatrix,strokeMatrix){function isCloseEnough(pt,padding){return 1>=point$jscomp$0.subtract(pt).divide(padding).length}function checkSegmentPoint(seg,pt,name){if(!options.selected||pt.isSelected()){var anchor=seg._point;pt!==anchor&&(pt=pt.add(anchor));if(isCloseEnough(pt,strokePadding))return new HitResult(name,that,{segment:seg,
point:pt})}}function checkSegmentPoints(seg,ends){return(ends||options.segments)&&checkSegmentPoint(seg,seg._point,"segment")||!ends&&options.handles&&(checkSegmentPoint(seg,seg._handleIn,"handle-in")||checkSegmentPoint(seg,seg._handleOut,"handle-out"))}function addToArea(point){area.add(point)}function checkSegmentStroke(segment){var isJoin=closed||0<segment._index&&segment._index<numSegments-1;if("round"===(isJoin?join:cap))return isCloseEnough(segment._point,strokePadding);area=new Path({internal:!0,
closed:!0});isJoin?segment.isSmooth()||Path._addBevelJoin(segment,join,strokeRadius,miterLimit,null,strokeMatrix,addToArea,!0):"square"===cap&&Path._addSquareCap(segment,cap,strokeRadius,null,strokeMatrix,addToArea,!0);if(!area.isEmpty()){var loc;return area.contains(point$jscomp$0)||(loc=area.getNearestLocation(point$jscomp$0))&&isCloseEnough(loc.getPoint(),tolerancePadding)}}var that=this,style=this.getStyle();viewMatrix=this._segments;var numSegments=viewMatrix.length,closed=this._closed,tolerancePadding=
options._tolerancePadding,strokePadding=tolerancePadding,area,loc$jscomp$0,res,hitStroke=options.stroke&&style.hasStroke(),hitFill=options.fill&&style.hasFill(),hitCurves=options.curves,strokeRadius=hitStroke?style.getStrokeWidth()/2:hitFill&&0<options.tolerance||hitCurves?0:null;if(null!==strokeRadius)if(0<strokeRadius){var join=style.getStrokeJoin();var cap=style.getStrokeCap();var miterLimit=style.getMiterLimit();strokePadding=strokePadding.add(Path._getStrokePadding(strokeRadius,strokeMatrix))}else join=
cap="round";if(options.ends&&!options.segments&&!closed){if(res=checkSegmentPoints(viewMatrix[0],!0)||checkSegmentPoints(viewMatrix[numSegments-1],!0))return res}else if(options.segments||options.handles)for(style=0;style<numSegments;style++)if(res=checkSegmentPoints(viewMatrix[style]))return res;if(null!==strokeRadius){if(loc$jscomp$0=this.getNearestLocation(point$jscomp$0))style=loc$jscomp$0.getTime(),0===style||1===style&&1<numSegments?checkSegmentStroke(loc$jscomp$0.getSegment())||(loc$jscomp$0=
null):isCloseEnough(loc$jscomp$0.getPoint(),strokePadding)||(loc$jscomp$0=null);if(!loc$jscomp$0&&"miter"===join&&1<numSegments)for(style=0;style<numSegments;style++)if(res=viewMatrix[style],point$jscomp$0.getDistance(res._point)<=miterLimit*strokeRadius&&checkSegmentStroke(res)){loc$jscomp$0=res.getLocation();break}}return!loc$jscomp$0&&hitFill&&this._contains(point$jscomp$0)||loc$jscomp$0&&!hitStroke&&!hitCurves?new HitResult("fill",this):loc$jscomp$0?new HitResult(hitStroke?"stroke":"curve",this,
{location:loc$jscomp$0,point:loc$jscomp$0.getPoint()}):null}},Base.each(Curve._evaluateMethods,function(name){this[name+"At"]=function(offset){return(offset=this.getLocationAt(offset))&&offset[name]()}},{beans:!1,getLocationOf:function(){for(var point=Point.read(arguments),curves=this.getCurves(),i=0,l=curves.length;i<l;i++){var loc=curves[i].getLocationOf(point);if(loc)return loc}return null},getOffsetOf:function(){var loc=this.getLocationOf.apply(this,arguments);return loc?loc.getOffset():null},
getLocationAt:function(offset){if("number"===typeof offset){for(var curves=this.getCurves(),length=0,i=0,l=curves.length;i<l;i++){var start=length,curve=curves[i];length+=curve.getLength();if(length>offset)return curve.getLocationAt(offset-start)}if(0<curves.length&&offset<=this.getLength())return new CurveLocation(curves[curves.length-1],1)}else if(offset&&offset.getPath&&offset.getPath()===this)return offset;return null},getOffsetsWithTangent:function(){var tangent=Point.read(arguments);if(tangent.isZero())return[];
for(var offsets=[],curveStart=0,curves=this.getCurves(),i=0,l=curves.length;i<l;i++){for(var curve=curves[i],curveTimes=curve.getTimesWithTangent(tangent),j=0,m=curveTimes.length;j<m;j++){var offset=curveStart+curve.getOffsetAtTime(curveTimes[j]);0>offsets.indexOf(offset)&&offsets.push(offset)}curveStart+=curve.length}return offsets}}),new function(){function drawHandles(ctx,segments,matrix,size){function drawHandle(index){var hX=coords[index];index=coords[index+1];if(pX!=hX||pY!=index)ctx.beginPath(),
ctx.moveTo(pX,pY),ctx.lineTo(hX,index),ctx.stroke(),ctx.beginPath(),ctx.arc(hX,index,half,0,2*Math.PI,!0),ctx.fill()}if(!(0>=size))for(var half=size/2,miniSize=size-2,miniHalf=half-1,coords=Array(6),pX,pY,i=0,l=segments.length;i<l;i++){var segment=segments[i],selection=segment._selection;segment._transformCoordinates(matrix,coords);pX=coords[0];pY=coords[1];selection&2&&drawHandle(2);selection&4&&drawHandle(4);ctx.fillRect(pX-half,pY-half,size,size);0<miniSize&&!(selection&1)&&(segment=ctx.fillStyle,
ctx.fillStyle="#ffffff",ctx.fillRect(pX-miniHalf,pY-miniHalf,miniSize,miniSize),ctx.fillStyle=segment)}}function drawSegments(ctx,path,matrix){function drawSegment(segment){if(matrix)segment._transformCoordinates(matrix,coords),curX=coords[0],curY=coords[1];else{var point=segment._point;curX=point._x;curY=point._y}first?(ctx.moveTo(curX,curY),first=!1):(matrix?(inX=coords[2],inY=coords[3]):(point=segment._handleIn,inX=curX+point._x,inY=curY+point._y),inX===curX&&inY===curY&&outX===prevX&&outY===prevY?
ctx.lineTo(curX,curY):ctx.bezierCurveTo(outX,outY,inX,inY,curX,curY));prevX=curX;prevY=curY;matrix?(outX=coords[4],outY=coords[5]):(point=segment._handleOut,outX=prevX+point._x,outY=prevY+point._y)}for(var segments=path._segments,length=segments.length,coords=Array(6),first=!0,curX,curY,prevX,prevY,inX,inY,outX,outY,i=0;i<length;i++)drawSegment(segments[i]);path._closed&&0<length&&drawSegment(segments[0])}return{_draw:function(ctx,param,viewMatrix,strokeMatrix){function getOffset(i){return dashArray[(i%
dashLength+dashLength)%dashLength]}var dontStart=param.dontStart,dontPaint=param.dontFinish||param.clip,style=this.getStyle(),hasFill=style.hasFill(),hasStroke=style.hasStroke(),dashArray=style.getDashArray(),dashLength=!paper.support.nativeDash&&hasStroke&&dashArray&&dashArray.length;dontStart||ctx.beginPath();if(hasFill||hasStroke&&!dashLength||dontPaint)drawSegments(ctx,this,strokeMatrix),this._closed&&ctx.closePath();if(!dontPaint&&(hasFill||hasStroke)&&(this._setStyles(ctx,param,viewMatrix),
hasFill&&(ctx.fill(style.getFillRule()),ctx.shadowColor="rgba(0,0,0,0)"),hasStroke)){if(dashLength){dontStart||ctx.beginPath();param=new PathFlattener(this,.25,32,!1,strokeMatrix);viewMatrix=param.length;style=-style.getDashOffset();dontStart=0;for(style%=viewMatrix;0<style;)style-=getOffset(dontStart--)+getOffset(dontStart--);for(;style<viewMatrix;)strokeMatrix=style+getOffset(dontStart++),(0<style||0<strokeMatrix)&&param.drawPart(ctx,Math.max(style,0),Math.max(strokeMatrix,0)),style=strokeMatrix+
getOffset(dontStart++)}ctx.stroke()}},_drawSelected:function(ctx,matrix){ctx.beginPath();drawSegments(ctx,this,matrix);ctx.stroke();drawHandles(ctx,this._segments,matrix,paper.settings.handleSize)}}},new function(){function getCurrentSegment(that){that=that._segments;if(!that.length)throw Error("Use a moveTo() command first");return that[that.length-1]}return{moveTo:function(){var segments=this._segments;1===segments.length&&this.removeSegment(0);segments.length||this._add([new Segment(Point.read(arguments))])},
moveBy:function(){throw Error("moveBy() is unsupported on Path items.");},lineTo:function(){this._add([new Segment(Point.read(arguments))])},cubicCurveTo:function(){var args=arguments,handle1=Point.read(args),handle2=Point.read(args);args=Point.read(args);var current=getCurrentSegment(this);current.setHandleOut(handle1.subtract(current._point));this._add([new Segment(args,handle2.subtract(args))])},quadraticCurveTo:function(){var args=arguments,handle=Point.read(args);args=Point.read(args);var current=
getCurrentSegment(this)._point;this.cubicCurveTo(handle.add(current.subtract(handle).multiply(1/3)),handle.add(args.subtract(handle).multiply(1/3)),args)},curveTo:function(){var args=arguments,through=Point.read(args),to=Point.read(args);args=Base.pick(Base.read(args),.5);var t1=1-args,current=getCurrentSegment(this)._point;through=through.subtract(current.multiply(t1*t1)).subtract(to.multiply(args*args)).divide(2*args*t1);if(through.isNaN())throw Error("Cannot put a curve through points with parameter \x3d "+
args);this.quadraticCurveTo(through,to)},arcTo:function(){var args=arguments,abs=Math.abs,sqrt=Math.sqrt,current=getCurrentSegment(this),from=current._point,to=Point.read(args),peek=Base.peek(args);peek=Base.pick(peek,!0);if("boolean"===typeof peek){args=from.add(to).divide(2);var through=args.add(args.subtract(from).rotate(peek?-90:90))}else if(2>=Base.remain(args))through=to,to=Point.read(args);else if(!from.equals(to)){var radius=Size.read(args);var center=Numerical.isZero;if(center(radius.width)||
center(radius.height))return this.lineTo(to);var matrix=Base.read(args);peek=!!Base.read(args);center=!!Base.read(args);args=from.add(to).divide(2);var extent=from.subtract(args).rotate(-matrix);var vector=extent.x;var y=extent.y;extent=abs(radius.width);radius=abs(radius.height);var rxSq=extent*extent,rySq=radius*radius,xSq=vector*vector,ySq=y*y,factor=sqrt(xSq/rxSq+ySq/rySq);1<factor&&(extent*=factor,radius*=factor,rxSq=extent*extent,rySq=radius*radius);factor=(rxSq*rySq-rxSq*ySq-rySq*xSq)/(rxSq*
ySq+rySq*xSq);1E-12>abs(factor)&&(factor=0);if(0>factor)throw Error("Cannot create an arc with the given arguments");center=(new Point(extent*y/radius,-radius*vector/extent)).multiply((center===peek?-1:1)*sqrt(factor)).rotate(matrix).add(args);matrix=(new Matrix).translate(center).rotate(matrix).scale(extent,radius);vector=matrix._inverseTransform(from);extent=vector.getDirectedAngle(matrix._inverseTransform(to));!peek&&0<extent?extent-=360:peek&&0>extent&&(extent+=360)}if(through){center=new Line(from.add(through).divide(2),
through.subtract(from).rotate(90),!0);vector=new Line(through.add(to).divide(2),to.subtract(through).rotate(90),!0);sqrt=new Line(from,to);through=sqrt.getSide(through);center=center.intersect(vector,!0);if(!center){if(!through)return this.lineTo(to);throw Error("Cannot create an arc with the given arguments");}vector=from.subtract(center);extent=vector.getDirectedAngle(to.subtract(center));from=sqrt.getSide(center,!0);0===from?extent=through*abs(extent):through===from&&(extent+=0>extent?360:-360)}if(extent){abs=
abs(extent);abs=360<=abs?4:Math.ceil((abs-1E-7)/90);from=extent/abs;through=from*Math.PI/360;through=4/3*Math.sin(through)/(1+Math.cos(through));sqrt=[];for(peek=0;peek<=abs;peek++)extent=to,args=null,peek<abs&&(args=vector.rotate(90).multiply(through),matrix?(extent=matrix._transformPoint(vector),args=matrix._transformPoint(vector.add(args)).subtract(extent)):extent=center.add(vector)),peek?(y=vector.rotate(-90).multiply(through),matrix&&(y=matrix._transformPoint(vector.add(y)).subtract(extent)),
sqrt.push(new Segment(extent,y,args))):current.setHandleOut(args),vector=vector.rotate(from);this._add(sqrt)}},lineBy:function(){var to=Point.read(arguments),current=getCurrentSegment(this)._point;this.lineTo(current.add(to))},curveBy:function(){var args=arguments,through=Point.read(args),to=Point.read(args);args=Base.read(args);var current=getCurrentSegment(this)._point;this.curveTo(current.add(through),current.add(to),args)},cubicCurveBy:function(){var args=arguments,handle1=Point.read(args),handle2=
Point.read(args);args=Point.read(args);var current=getCurrentSegment(this)._point;this.cubicCurveTo(current.add(handle1),current.add(handle2),current.add(args))},quadraticCurveBy:function(){var args=arguments,handle=Point.read(args);args=Point.read(args);var current=getCurrentSegment(this)._point;this.quadraticCurveTo(current.add(handle),current.add(args))},arcBy:function(){var args=arguments,current=getCurrentSegment(this)._point,point=current.add(Point.read(args)),clockwise=Base.pick(Base.peek(args),
!0);"boolean"===typeof clockwise?this.arcTo(point,clockwise):this.arcTo(point,current.add(Point.read(args)))},closePath:function(tolerance){this.setClosed(!0);this.join(this,tolerance)}}},{_getBounds:function(matrix,options){return Path[options.handle?"getHandleBounds":options.stroke?"getStrokeBounds":"getBounds"](this._segments,this._closed,this,matrix,options)},statics:{getBounds:function(segments,closed,path,matrix,options,strokePadding){function processSegment(segment){segment._transformCoordinates(matrix,
coords);for(segment=0;2>segment;segment++)Curve._addBounds(prevCoords[segment],prevCoords[segment+4],coords[segment+2],coords[segment],segment,strokePadding?strokePadding[segment]:0,min,max,roots);segment=prevCoords;prevCoords=coords;coords=segment}path=segments[0];if(!path)return new Rectangle;var coords=Array(6),prevCoords=path._transformCoordinates(matrix,Array(6)),min=prevCoords.slice(0,2),max=min.slice(),roots=Array(2);options=1;for(var l=segments.length;options<l;options++)processSegment(segments[options]);
closed&&processSegment(path);return new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1])},getStrokeBounds:function(segments,closed,path,matrix,options){function addPoint(point){bounds=bounds.include(point)}function addJoin(segment,join){"round"===join||segment.isSmooth()?bounds=bounds.unite(joinBounds.setCenter(segment._point.transform(matrix))):Path._addBevelJoin(segment,join,strokeRadius,miterLimit,matrix,strokeMatrix,addPoint)}function addCap(segment,cap){"round"===cap?bounds=bounds.unite(joinBounds.setCenter(segment._point.transform(matrix))):
Path._addSquareCap(segment,cap,strokeRadius,matrix,strokeMatrix,addPoint)}var style=path.getStyle(),stroke=style.hasStroke(),strokeWidth=style.getStrokeWidth(),strokeMatrix=stroke&&path._getStrokeMatrix(matrix,options),strokePadding=stroke&&Path._getStrokePadding(strokeWidth,strokeMatrix),bounds=Path.getBounds(segments,closed,path,matrix,options,strokePadding);if(!stroke)return bounds;var strokeRadius=strokeWidth/2;path=style.getStrokeJoin();options=style.getStrokeCap();var miterLimit=style.getMiterLimit(),
joinBounds=new Rectangle(new Size(strokePadding));style=segments.length-(closed?0:1);for(strokePadding=1;strokePadding<style;strokePadding++)addJoin(segments[strokePadding],path);closed?addJoin(segments[0],path):0<style&&(addCap(segments[0],options),addCap(segments[segments.length-1],options));return bounds},_getStrokePadding:function(radius,matrix){if(!matrix)return[radius,radius];var hor=(new Point(radius,0)).transform(matrix);radius=(new Point(0,radius)).transform(matrix);var phi=hor.getAngleInRadians();
hor=hor.getLength();radius=radius.getLength();matrix=Math.sin(phi);var cos=Math.cos(phi),tan=Math.tan(phi);phi=Math.atan2(radius*tan,hor);tan=Math.atan2(radius,tan*hor);return[Math.abs(hor*Math.cos(phi)*cos+radius*Math.sin(phi)*matrix),Math.abs(radius*Math.sin(tan)*cos+hor*Math.cos(tan)*matrix)]},_addBevelJoin:function(segment,join,radius,miterLimit,matrix,strokeMatrix,addPoint,isArea){segment=segment.getCurve();var curve1=segment.getPrevious();matrix=segment.getPoint1().transform(matrix);curve1=
curve1.getNormalAtTime(1).multiply(radius).transform(strokeMatrix);strokeMatrix=segment.getNormalAtTime(0).multiply(radius).transform(strokeMatrix);segment=curve1.getDirectedAngle(strokeMatrix);if(0>segment||180<=segment)curve1=curve1.negate(),strokeMatrix=strokeMatrix.negate();isArea&&addPoint(matrix);addPoint(matrix.add(curve1));"miter"===join&&(join=(new Line(matrix.add(curve1),new Point(-curve1.y,curve1.x),!0)).intersect(new Line(matrix.add(strokeMatrix),new Point(-strokeMatrix.y,strokeMatrix.x),
!0),!0))&&matrix.getDistance(join)<=miterLimit*radius&&addPoint(join);addPoint(matrix.add(strokeMatrix))},_addSquareCap:function(segment,cap,radius,matrix,strokeMatrix,addPoint,isArea){matrix=segment._point.transform(matrix);segment=segment.getLocation();radius=segment.getNormal().multiply(0===segment.getTime()?radius:-radius).transform(strokeMatrix);"square"===cap&&(isArea&&(addPoint(matrix.subtract(radius)),addPoint(matrix.add(radius))),matrix=matrix.add(radius.rotate(-90)));addPoint(matrix.add(radius));
addPoint(matrix.subtract(radius))},getHandleBounds:function(segments,closed,path,matrix,options){closed=path.getStyle();var strokePadding;if(options.stroke&&closed.hasStroke()){var joinPadding=path._getStrokeMatrix(matrix,options);path=strokePadding=closed.getStrokeWidth()/2;"miter"===closed.getStrokeJoin()&&(path=strokePadding*closed.getMiterLimit());"square"===closed.getStrokeCap()&&(path=Math.max(path,strokePadding*Math.SQRT2));strokePadding=Path._getStrokePadding(strokePadding,joinPadding);joinPadding=
Path._getStrokePadding(path,joinPadding)}closed=Array(6);path=Infinity;options=-path;for(var y1=path,y2=options,i=0,l=segments.length;i<l;i++){segments[i]._transformCoordinates(matrix,closed);for(var j=0;6>j;j+=2){var padding=j?strokePadding:joinPadding,paddingX=padding?padding[0]:0,paddingY=padding?padding[1]:0,x=closed[j],y=closed[j+1];padding=x-paddingX;paddingX=x+paddingX;x=y-paddingY;paddingY=y+paddingY;padding<path&&(path=padding);paddingX>options&&(options=paddingX);x<y1&&(y1=x);paddingY>y2&&
(y2=paddingY)}}return new Rectangle(path,y1,options-path,y2-y1)}}});Path.inject({statics:new function(){function createPath(segments,closed,args){args=Base.getNamed(args);var path=new Path(args&&0==args.insert&&Item.NO_INSERT);path._add(segments);path._closed=closed;return path.set(args,{insert:!0})}function createEllipse(center,radius,args){for(var segments=Array(4),i=0;4>i;i++){var segment=ellipseSegments[i];segments[i]=new Segment(segment._point.multiply(radius).add(center),segment._handleIn.multiply(radius),
segment._handleOut.multiply(radius))}return createPath(segments,!0,args)}var ellipseSegments=[new Segment([-1,0],[0,.5522847498307936],[0,-.5522847498307936]),new Segment([0,-1],[-.5522847498307936,0],[.5522847498307936,0]),new Segment([1,0],[0,-.5522847498307936],[0,.5522847498307936]),new Segment([0,1],[.5522847498307936,0],[-.5522847498307936,0])];return{Line:function(){var args=arguments;return createPath([new Segment(Point.readNamed(args,"from")),new Segment(Point.readNamed(args,"to"))],!1,args)},
Circle:function(){var args=arguments,center=Point.readNamed(args,"center"),radius=Base.readNamed(args,"radius");return createEllipse(center,new Size(radius),args)},Rectangle:function(){var args=arguments,rect=Rectangle.readNamed(args,"rectangle"),radius=Size.readNamed(args,"radius",0,{readNull:!0}),bl=rect.getBottomLeft(!0),tl=rect.getTopLeft(!0),tr=rect.getTopRight(!0),br=rect.getBottomRight(!0);if(!radius||radius.isZero())bl=[new Segment(bl),new Segment(tl),new Segment(tr),new Segment(br)];else{radius=
Size.min(radius,rect.getSize(!0).divide(2));rect=radius.width;radius=radius.height;var hx=.5522847498307936*rect,hy=.5522847498307936*radius;bl=[new Segment(bl.add(rect,0),null,[-hx,0]),new Segment(bl.subtract(0,radius),[0,hy]),new Segment(tl.add(0,radius),null,[0,-hy]),new Segment(tl.add(rect,0),[-hx,0],null),new Segment(tr.subtract(rect,0),null,[hx,0]),new Segment(tr.add(0,radius),[0,-hy],null),new Segment(br.subtract(0,radius),null,[0,hy]),new Segment(br.subtract(rect,0),[hx,0])]}return createPath(bl,
!0,args)},RoundRectangle:"#Rectangle",Ellipse:function(){var args=arguments,ellipse=Shape._readEllipse(args);return createEllipse(ellipse.center,ellipse.radius,args)},Oval:"#Ellipse",Arc:function(){var args=arguments,from=Point.readNamed(args,"from"),through=Point.readNamed(args,"through"),to=Point.readNamed(args,"to");args=Base.getNamed(args);var path=new Path(args&&0==args.insert&&Item.NO_INSERT);path.moveTo(from);path.arcTo(through,to);return path.set(args)},RegularPolygon:function(){var args=
arguments,center=Point.readNamed(args,"center"),sides=Base.readNamed(args,"sides"),radius=Base.readNamed(args,"radius"),step=360/sides,three=0===sides%3;radius=new Point(0,three?-radius:radius);three=three?-1:.5;for(var segments=Array(sides),i=0;i<sides;i++)segments[i]=new Segment(center.add(radius.rotate((i+three)*step)));return createPath(segments,!0,args)},Star:function(){for(var args=arguments,center=Point.readNamed(args,"center"),points=2*Base.readNamed(args,"points"),radius1=Base.readNamed(args,
"radius1"),radius2=Base.readNamed(args,"radius2"),step=360/points,vector=new Point(0,-1),segments=Array(points),i=0;i<points;i++)segments[i]=new Segment(center.add(vector.rotate(step*i).multiply(i%2?radius2:radius1)));return createPath(segments,!0,args)}}}});var CompoundPath=PathItem.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(arg){this._children=[];this._namedChildren={};this._initialize(arg)||("string"===typeof arg?this.setPathData(arg):this.addChildren(Array.isArray(arg)?
arg:arguments))},insertChildren:function insertChildren(index,items){var list=items,first=list[0];first&&"number"===typeof first[0]&&(list=[list]);for(first=items.length-1;0<=first;first--){var item=list[first];list!==items||item instanceof Path||(list=Base.slice(list));Array.isArray(item)?list[first]=new Path({segments:item,insert:!1}):item instanceof CompoundPath&&(list.splice.apply(list,[first,1].concat(item.removeChildren())),item.remove())}return insertChildren.base.call(this,index,list)},reduce:function reduce(options){for(var children=
this._children,i=children.length-1;0<=i;i--){var path=children[i].reduce(options);path.isEmpty()&&path.remove()}return children.length?reduce.base.call(this):(path=new Path(Item.NO_INSERT),path.copyAttributes(this),path.insertAbove(this),this.remove(),path)},isClosed:function(){for(var children=this._children,i=0,l=children.length;i<l;i++)if(!children[i]._closed)return!1;return!0},setClosed:function(closed){for(var children=this._children,i=0,l=children.length;i<l;i++)children[i].setClosed(closed)},
getFirstSegment:function(){var first=this.getFirstChild();return first&&first.getFirstSegment()},getLastSegment:function(){var last=this.getLastChild();return last&&last.getLastSegment()},getCurves:function(){for(var children=this._children,curves=[],i=0,l=children.length;i<l;i++)Base.push(curves,children[i].getCurves());return curves},getFirstCurve:function(){var first=this.getFirstChild();return first&&first.getFirstCurve()},getLastCurve:function(){var last=this.getLastChild();return last&&last.getLastCurve()},
getArea:function(){for(var children=this._children,area=0,i=0,l=children.length;i<l;i++)area+=children[i].getArea();return area},getLength:function(){for(var children=this._children,length=0,i=0,l=children.length;i<l;i++)length+=children[i].getLength();return length},getPathData:function(_matrix,_precision){for(var children=this._children,paths=[],i=0,l=children.length;i<l;i++){var child=children[i],mx=child._matrix;paths.push(child.getPathData(_matrix&&!mx.isIdentity()?_matrix.appended(mx):_matrix,
_precision))}return paths.join("")},_hitTestChildren:function _hitTestChildren(point,options,viewMatrix){return _hitTestChildren.base.call(this,point,options.class===Path||"path"===options.type?options:Base.set({},options,{fill:!1}),viewMatrix)},_draw:function(ctx,param,viewMatrix,strokeMatrix){var children=this._children;if(children.length){param=param.extend({dontStart:!0,dontFinish:!0});ctx.beginPath();for(var i=0,l=children.length;i<l;i++)children[i].draw(ctx,param,strokeMatrix);param.clip||(this._setStyles(ctx,
param,viewMatrix),param=this._style,param.hasFill()&&(ctx.fill(param.getFillRule()),ctx.shadowColor="rgba(0,0,0,0)"),param.hasStroke()&&ctx.stroke())}},_drawSelected:function(ctx,matrix,selectionItems){for(var children=this._children,i=0,l=children.length;i<l;i++){var child=children[i],mx=child._matrix;selectionItems[child._id]||child._drawSelected(ctx,mx.isIdentity()?matrix:matrix.appended(mx))}}},new function(){function getCurrentPath(that,check){that=that._children;if(check&&!that.length)throw Error("Use a moveTo() command first");
return that[that.length-1]}return Base.each("lineTo cubicCurveTo quadraticCurveTo curveTo arcTo lineBy cubicCurveBy quadraticCurveBy curveBy arcBy".split(" "),function(key){this[key]=function(){var path=getCurrentPath(this,!0);path[key].apply(path,arguments)}},{moveTo:function(){var current=getCurrentPath(this),path=current&&current.isEmpty()?current:new Path(Item.NO_INSERT);path!==current&&this.addChild(path);path.moveTo.apply(path,arguments)},moveBy:function(){var current=getCurrentPath(this,!0);
current=current&&current.getLastSegment();var point=Point.read(arguments);this.moveTo(current?point.add(current._point):point)},closePath:function(tolerance){getCurrentPath(this,!0).closePath(tolerance)}})},Base.each(["reverse","flatten","simplify","smooth"],function(key){this[key]=function(param){for(var children=this._children,res,i=0,l=children.length;i<l;i++)res=children[i][key](param)||res;return res}},{}));PathItem.inject(new function(){function preparePath(path,resolve){var res=path.clone(!1).reduce({simplify:!0}).transform(null,
!0,!0);if(resolve){resolve=res._children||[res];for(var i=0,l=resolve.length;i<l;i++)path=resolve[i],path._closed||path.isEmpty()||(path.closePath(1E-12),path.getFirstSegment().setHandleIn(0,0),path.getLastSegment().setHandleOut(0,0));res=res.resolveCrossings().reorient("nonzero"===res.getFillRule(),!0)}return res}function createResult(paths,simplify,path1,path2,options){var result=new CompoundPath(Item.NO_INSERT);result.addChildren(paths,!0);result=result.reduce({simplify:simplify});options&&0==
options.insert||result.insertAbove(path2&&path1.isSibling(path2)&&path1.getIndex()<path2.getIndex()?path2:path1);result.copyAttributes(path1,!0);return result}function filterIntersection(inter){return inter.hasOverlap()||inter.isCrossing()}function traceBoolean(path1,path2,operation,options){function collectPaths(paths){for(var i=0,l=paths.length;i<l;i++){var path=paths[i];Base.push(segments,path._segments);Base.push(curves,path.getCurves());path._overlapsOnly=!0}}function getCurves(indices){for(var list=
[],i=0,l=indices&&indices.length;i<l;i++)list.push(curves[indices[i]]);return list}if(options&&(0==options.trace||options.stroke)&&/^(subtract|intersect)$/.test(operation))return splitBoolean(path1,path2,operation);var _path1=preparePath(path1,!0),_path2=path2&&path1!==path2&&preparePath(path2,!0),operator=operators[operation];operator[operation]=!0;_path2&&(operator.subtract||operator.exclude)^_path2.isClockwise()^_path1.isClockwise()&&_path2.reverse();operation=divideLocations(CurveLocation.expand(_path1.getIntersections(_path2,
filterIntersection)));var paths1=_path1._children||[_path1],paths2=_path2&&(_path2._children||[_path2]),segments=[],curves=[];if(operation.length){collectPaths(paths1);paths2&&collectPaths(paths2);paths2=Array(curves.length);paths1=0;for(var l$jscomp$0=curves.length;paths1<l$jscomp$0;paths1++)paths2[paths1]=curves[paths1].getValues();l$jscomp$0=CollisionDetection.findCurveBoundsCollisions(paths2,paths2,0,!0);paths2={};for(paths1=0;paths1<curves.length;paths1++){var curve=curves[paths1],id=curve._path._id;
(paths2[id]=paths2[id]||{})[curve.getIndex()]={hor:getCurves(l$jscomp$0[paths1].hor),ver:getCurves(l$jscomp$0[paths1].ver)}}paths1=0;for(l$jscomp$0=operation.length;paths1<l$jscomp$0;paths1++)propagateWinding(operation[paths1]._segment,_path1,_path2,paths2,operator);paths1=0;for(l$jscomp$0=segments.length;paths1<l$jscomp$0;paths1++)operation=segments[paths1],curve=operation._intersection,operation._winding||propagateWinding(operation,_path1,_path2,paths2,operator),curve&&curve._overlap||(operation._path._overlapsOnly=
!1);_path1=tracePaths(segments,operator)}else _path1=reorientPaths(paths2?paths1.concat(paths2):paths1.slice(),function(w){return!!operator[w]});return createResult(_path1,!0,path1,path2,options)}function splitBoolean(path1,path2,operation){function addPath(path){if(!added[path._id]&&(divide||_path2.contains(path.getPointAt(path.getLength()/2))^subtract))return paths.unshift(path),added[path._id]=!0}var _path1=preparePath(path1),_path2=preparePath(path2),crossings=_path1.getIntersections(_path2,filterIntersection),
subtract="subtract"===operation,divide="divide"===operation,added={},paths=[];for(operation=crossings.length-1;0<=operation;operation--){var path$jscomp$0=crossings[operation].split();path$jscomp$0&&(addPath(path$jscomp$0)&&path$jscomp$0.getFirstSegment().setHandleIn(0,0),_path1.getLastSegment().setHandleOut(0,0))}addPath(_path1);return createResult(paths,!1,path1,path2)}function linkIntersections(from,to){for(var prev=from;prev;){if(prev===to)return;prev=prev._previous}for(;from._next&&from._next!==
to;)from=from._next;if(!from._next){for(;to._previous;)to=to._previous;from._next=to;to._previous=from}}function clearCurveHandles(curves){for(var i=curves.length-1;0<=i;i--)curves[i].clearHandles()}function reorientPaths(paths,isInside,clockwise){var length=paths&&paths.length;if(length){var lookup=Base.each(paths,function(path,i){this[path._id]={container:null,winding:path.isClockwise()?1:-1,index:i}},{}),sorted=paths.slice().sort(function(a,b){return abs(b.getArea())-abs(a.getArea())}),first=sorted[0],
collisions=CollisionDetection.findItemBoundsCollisions(sorted,null,Numerical.GEOMETRIC_EPSILON);null==clockwise&&(clockwise=first.isClockwise());for(first=0;first<length;first++){var path1=sorted[first],entry1=lookup[path1._id],containerWinding=0,indices=collisions[first];if(indices)for(var point=null,j=indices.length-1;0<=j;j--)if(indices[j]<first){point=point||path1.getInteriorPoint();var path2=sorted[indices[j]];if(path2.contains(point)){indices=lookup[path2._id];containerWinding=indices.winding;
entry1.winding+=containerWinding;entry1.container=indices.exclude?indices.container:path2;break}}isInside(entry1.winding)===isInside(containerWinding)?(entry1.exclude=!0,paths[entry1.index]=null):(entry1=entry1.container,path1.setClockwise(entry1?!entry1.isClockwise():clockwise))}}return paths}function divideLocations(locations,include,clearLater){for(var results=include&&[],clearHandles=!1,clearCurves=clearLater||[],clearLookup=clearLater&&{},renormalizeLocs,prevCurve,prevTime,i=(clearLater&&clearLater.length)-
1;0<=i;i--){var curve=clearLater[i];curve._path&&(clearLookup[curve._path._id+"."+curve._segment1._index]=!0)}for(i=locations.length-1;0<=i;i--){var loc=locations[i],time=loc._time,origTime=time,exclude=include&&!include(loc);if(curve=loc._curve)curve!==prevCurve?(clearHandles=!curve.hasHandles()||clearLookup&&clearLookup[curve._path._id+"."+curve._segment1._index],renormalizeLocs=[],prevTime=null,prevCurve=curve):1E-8<=prevTime&&(time/=prevTime);if(exclude)renormalizeLocs&&renormalizeLocs.push(loc);
else{include&&results.unshift(loc);prevTime=origTime;if(1E-8>time)curve=curve._segment1;else if(.99999999<time)curve=curve._segment2;else for(origTime=curve.divideAtTime(time,!0),clearHandles&&clearCurves.push(curve,origTime),curve=origTime._segment1,origTime=renormalizeLocs.length-1;0<=origTime;origTime--)exclude=renormalizeLocs[origTime],exclude._time=(exclude._time-time)/(1-time);loc._setSegment(curve);time=curve._intersection;loc=loc._intersection;if(time)for(linkIntersections(time,loc),loc=time;loc;)linkIntersections(loc._intersection,
time),loc=loc._next;else curve._intersection=loc}}clearLater||clearCurveHandles(clearCurves);return results||locations}function getWinding(point,curves,dir,closed,dontFlip){function handleCurve(v){var o0=v[io+0],o1=v[io+2],o2=v[io+4],o3=v[io+6];if(po<=max(o0,o1,o2,o3)&&po>=min(o0,o1,o2,o3))for(o0=v[ia+0],o1=v[ia+2],o2=v[ia+4],o3=v[ia+6],v=paL>max(o0,o1,o2,o3)||paR<min(o0,o1,o2,o3)?[v]:Curve.getMonoCurves(v,dir),o0=0,o1=v.length;o0<o1;o0++){o2=v[o0];o3=o2[io+0];var o3$jscomp$0=o2[io+6];if(po<min(o3,
o3$jscomp$0)||po>max(o3,o3$jscomp$0))o2=void 0;else{var a0=o2[ia+0],a1=o2[ia+2],a2=o2[ia+4],a3=o2[ia+6];if(o3===o3$jscomp$0){if(a0<paR&&a3>paL||a3<paR&&a0>paL)onPath=!0;o2=void 0}else{a1=po===o3?0:po===o3$jscomp$0?1:paL>max(a0,a1,a2,a3)||paR<min(a0,a1,a2,a3)?1:0<Curve.solveCubic(o2,io,po,roots,0,1)?roots[0]:1;a3=0===a1?a0:1===a1?a3:Curve.getPoint(o2,a1)[dir?"y":"x"];o3$jscomp$0=o3>o3$jscomp$0?1:-1;a2=vPrev[io]>vPrev[io+6]?1:-1;var a3Prev=vPrev[ia+6];po!==o3?(a3<paL?pathWindingL+=o3$jscomp$0:a3>paR?
pathWindingR+=o3$jscomp$0:onPath=!0,a3>pa-1E-6&&a3<pa+1E-6&&(quality/=2)):(o3$jscomp$0!==a2?a0<paL?pathWindingL+=o3$jscomp$0:a0>paR&&(pathWindingR+=o3$jscomp$0):a0!=a3Prev&&(a3Prev<paR&&a3>paR?(pathWindingR+=o3$jscomp$0,onPath=!0):a3Prev>paL&&a3<paL&&(pathWindingL+=o3$jscomp$0,onPath=!0)),quality/=4);vPrev=o2;o2=!dontFlip&&a3>paL&&a3<paR&&0===Curve.getTangent(o2,a1)[dir?"x":"y"]&&getWinding(point,curves,!dir,closed,!0)}}if(o2)return o2}}for(var curvesList=Array.isArray(curves)?curves:curves[dir?"hor":
"ver"],ia=dir?1:0,io=ia^1,pv=[point.x,point.y],pa=pv[ia],po=pv[io],paL=pa-1E-9,paR=pa+1E-9,windingR=pv=0,pathWindingL=0,pathWindingR=0,onPath=!1,onAnyPath=!1,quality=1,roots=[],vPrev,vClose,i=0,l=curvesList.length;i<l;i++){var curve=curvesList[i],path=curve._path,v$jscomp$0=curve.getValues();if(!i||curvesList[i-1]._path!==path)if(vPrev=null,path._closed||(vClose=Curve.getValues(path.getLastCurve().getSegment2(),curve.getSegment1(),null,!closed),vClose[io]!==vClose[io+6]&&(vPrev=vClose)),!vPrev){vPrev=
v$jscomp$0;for(var prev=path.getLastCurve();prev&&prev!==curve;){var v2=prev.getValues();if(v2[io]!==v2[io+6]){vPrev=v2;break}prev=prev.getPrevious()}}if(curve=handleCurve(v$jscomp$0))return curve;if(i+1===l||curvesList[i+1]._path!==path){if(vClose&&(curve=handleCurve(vClose)))return curve;!onPath||pathWindingL||pathWindingR||(pathWindingL=pathWindingR=path.isClockwise(closed)^dir?1:-1);pv+=pathWindingL;windingR+=pathWindingR;pathWindingL=pathWindingR=0;onPath&&(onAnyPath=!0,onPath=!1);vClose=null}}pv=
abs(pv);windingR=abs(windingR);return{winding:max(pv,windingR),windingL:pv,windingR:windingR,quality:quality,onPath:onAnyPath}}function propagateWinding(segment,path1,path2,curveCollisionsMap,operator){var chain=[],start=segment,totalLength=0;do{var curve=segment.getCurve();if(curve){var length=curve.getLength();chain.push({segment:segment,curve:curve,length:length});totalLength+=length}segment=segment.getNext()}while(segment&&!segment._intersection&&segment!==start);start=[.5,.25,.75];segment={winding:0,
quality:-1};for(var i=0;i<start.length&&.5>segment.quality;i++){length=totalLength*start[i];for(var j=0,l=chain.length;j<l;j++){curve=chain[j];var curveLength=curve.length;if(length<=curveLength){curve=curve.curve;curveLength=curve._path;var parent=curveLength._parent;parent=parent instanceof CompoundPath?parent:curveLength;var t=Numerical.clamp(curve.getTimeAt(length),.001,.999),pt=curve.getPointAtTime(t);t=abs(curve.getTangentAtTime(t).y)<Math.SQRT1_2;var wind=null;if(operator.subtract&&path2){var pathWinding=
(parent===path1?path2:path1)._getWinding(pt,t,!0);if(parent===path1&&pathWinding.winding||parent===path2&&!pathWinding.winding)if(1>pathWinding.quality)continue;else wind={winding:0,quality:1}}wind=wind||getWinding(pt,curveCollisionsMap[curveLength._id][curve.getIndex()],t,!0);wind.quality>segment.quality&&(segment=wind);break}length-=curveLength}}for(j=chain.length-1;0<=j;j--)chain[j].segment._winding=segment}function tracePaths(segments,operator){function isValid(seg){var winding;return!(!seg||
seg._visited||operator&&(!operator[(winding=seg._winding||{}).winding]||operator.unite&&2===winding.winding&&winding.windingL&&winding.windingR))}function isStart(seg){if(seg)for(var i=0,l=starts.length;i<l;i++)if(seg===starts[i])return!0;return!1}function visitPath(path){path=path._segments;for(var i=0,l=path.length;i<l;i++)path[i]._visited=!0}function getCrossingSegments(segment,collectStarts){function collect(inter,end){for(;inter&&inter!==end;){var other=inter._segment,path=other&&other._path;
if(path){path=other.getNext()||path.getFirstSegment();var nextInter=path._intersection;other!==segment&&(isStart(other)||isStart(path)||path&&isValid(other)&&(isValid(path)||nextInter&&isValid(nextInter._segment)))&&crossings.push(other);collectStarts&&starts.push(other)}inter=inter._next}}var inter$jscomp$0=segment._intersection,start=inter$jscomp$0,crossings=[];collectStarts&&(starts=[segment]);if(inter$jscomp$0){for(collect(inter$jscomp$0);inter$jscomp$0&&inter$jscomp$0._prev;)inter$jscomp$0=inter$jscomp$0._prev;
collect(inter$jscomp$0,start)}return crossings}var paths=[],starts;segments.sort(function(seg1,seg2){var inter1=seg1._intersection,inter2=seg2._intersection,over1=!(!inter1||!inter1._overlap),path1=seg1._path,path2=seg2._path;return over1^!(!inter2||!inter2._overlap)?over1?1:-1:!inter1^!inter2?inter1?1:-1:path1!==path2?path1._id-path2._id:seg1._index-seg2._index});for(var i$jscomp$0=0,l$jscomp$0=segments.length;i$jscomp$0<l$jscomp$0;i$jscomp$0++){var seg$jscomp$0=segments[i$jscomp$0],valid=isValid(seg$jscomp$0),
path$jscomp$0=null,finished=!1,closed=!0,branches=[],visited;if(valid&&seg$jscomp$0._path._overlapsOnly){var path1$jscomp$0=seg$jscomp$0._path,path2$jscomp$0=seg$jscomp$0._intersection._segment._path;path1$jscomp$0.compare(path2$jscomp$0)&&(path1$jscomp$0.getArea()&&paths.push(path1$jscomp$0.clone(!1)),visitPath(path1$jscomp$0),visitPath(path2$jscomp$0),valid=!1)}for(;valid;){path1$jscomp$0=!path$jscomp$0;path2$jscomp$0=getCrossingSegments(seg$jscomp$0,path1$jscomp$0);var other$jscomp$0=path2$jscomp$0.shift();
finished=!path1$jscomp$0&&(isStart(seg$jscomp$0)||isStart(other$jscomp$0));var cross=!finished&&other$jscomp$0;if(path1$jscomp$0){path$jscomp$0=new Path(Item.NO_INSERT);var branch=null}if(finished){if(seg$jscomp$0.isFirst()||seg$jscomp$0.isLast())closed=seg$jscomp$0._path._closed;seg$jscomp$0._visited=!0;break}cross&&branch&&(branches.push(branch),branch=null);branch||(cross&&path2$jscomp$0.push(seg$jscomp$0),branch={start:path$jscomp$0._segments.length,crossings:path2$jscomp$0,visited:visited=[],
handleIn:handleIn});cross&&(seg$jscomp$0=other$jscomp$0);if(!isValid(seg$jscomp$0)){path$jscomp$0.removeSegments(branch.start);seg$jscomp$0=0;for(path1$jscomp$0=visited.length;seg$jscomp$0<path1$jscomp$0;seg$jscomp$0++)visited[seg$jscomp$0]._visited=!1;visited.length=0;do if(seg$jscomp$0=branch&&branch.crossings.shift(),!seg$jscomp$0||!seg$jscomp$0._path)if(seg$jscomp$0=null,branch=branches.pop()){visited=branch.visited;var handleIn=branch.handleIn}while(branch&&!isValid(seg$jscomp$0));if(!seg$jscomp$0)break}path1$jscomp$0=
seg$jscomp$0.getNext();path$jscomp$0.add(new Segment(seg$jscomp$0._point,handleIn,path1$jscomp$0&&seg$jscomp$0._handleOut));seg$jscomp$0._visited=!0;visited.push(seg$jscomp$0);seg$jscomp$0=path1$jscomp$0||seg$jscomp$0._path.getFirstSegment();handleIn=path1$jscomp$0&&path1$jscomp$0._handleIn}finished&&(closed&&(path$jscomp$0.getFirstSegment().setHandleIn(handleIn),path$jscomp$0.setClosed(closed)),0!==path$jscomp$0.getArea()&&paths.push(path$jscomp$0))}return paths}var min=Math.min,max=Math.max,abs=
Math.abs,operators={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};return{_getWinding:function(point,dir,closed){return getWinding(point,this.getCurves(),dir,closed)},unite:function(path,options){return traceBoolean(this,path,"unite",options)},intersect:function(path,options){return traceBoolean(this,path,"intersect",options)},subtract:function(path,options){return traceBoolean(this,path,"subtract",options)},exclude:function(path,options){return traceBoolean(this,path,
"exclude",options)},divide:function(path,options){return options&&(0==options.trace||options.stroke)?splitBoolean(this,path,"divide"):createResult([this.subtract(path,options),this.intersect(path,options)],!0,this,path,options)},resolveCrossings:function(){function hasOverlap(seg,path){return(seg=seg&&seg._intersection)&&seg._overlap&&seg._path===path}var children=this._children,paths=children||[this],hasOverlaps=!1,hasCrossings=!1,intersections=this.getIntersections(null,function(inter){return inter.hasOverlap()&&
(hasOverlaps=!0)||inter.isCrossing()&&(hasCrossings=!0)}),clearCurves=hasOverlaps&&hasCrossings&&[];intersections=CurveLocation.expand(intersections);if(hasOverlaps)for(var overlaps=divideLocations(intersections,function(inter){return inter.hasOverlap()},clearCurves),i=overlaps.length-1;0<=i;i--){var overlap=overlaps[i],path$jscomp$0=overlap._path;overlap=overlap._segment;var prev=overlap.getPrevious(),next=overlap.getNext();hasOverlap(prev,path$jscomp$0)&&hasOverlap(next,path$jscomp$0)&&(overlap.remove(),
prev._handleOut._set(0,0),next._handleIn._set(0,0),prev===overlap||prev.getCurve().hasLength()||(next._handleIn.set(prev._handleIn),prev.remove()))}hasCrossings&&(divideLocations(intersections,hasOverlaps&&function(inter){var curve1=inter.getCurve(),seg1=inter.getSegment(),other=inter._intersection;inter=other._curve;other=other._segment;if(curve1&&inter&&curve1._path&&inter._path)return!0;seg1&&(seg1._intersection=null);other&&(other._intersection=null)},clearCurves),clearCurves&&clearCurveHandles(clearCurves),
paths=tracePaths(Base.each(paths,function(path){Base.push(this,path._segments)},[])));intersections=paths.length;if(1<intersections&&children){paths!==children&&this.setChildren(paths);var item=this}else 1!==intersections||children||(paths[0]!==this&&this.setSegments(paths[0].removeSegments()),item=this);item||(item=new CompoundPath(Item.NO_INSERT),item.addChildren(paths),item=item.reduce(),item.copyAttributes(this),this.replaceWith(item));return item},reorient:function(nonZero,clockwise){var children=
this._children;children&&children.length?this.setChildren(reorientPaths(this.removeChildren(),function(w){return!!(nonZero?w:w&1)},clockwise)):undefined!==clockwise&&this.setClockwise(clockwise);return this},getInteriorPoint:function(){var point=this.getBounds().getCenter(!0);if(!this.contains(point)){for(var curves=this.getCurves(),y=point.y,intercepts=[],roots=[],i=0,l=curves.length;i<l;i++){var v=curves[i].getValues(),o0=v[1],o1=v[3],o2=v[5],o3=v[7];if(y>=min(o0,o1,o2,o3)&&y<=max(o0,o1,o2,o3))for(v=
Curve.getMonoCurves(v),o0=0,o1=v.length;o0<o1;o0++){o2=v[o0];o3=o2[1];var mo3=o2[7];o3!==mo3&&(y>=o3&&y<=mo3||y>=mo3&&y<=o3)&&(o2=y===o3?o2[0]:y===mo3?o2[6]:1===Curve.solveCubic(o2,1,y,roots,0,1)?Curve.getPoint(o2,roots[0]).x:(o2[0]+o2[6])/2,intercepts.push(o2))}}1<intercepts.length&&(intercepts.sort(function(a,b){return a-b}),point.x=(intercepts[0]+intercepts[1])/2)}return point}}});var PathFlattener=Base.extend({_class:"PathFlattener",initialize:function(path,flatness,maxRecursion,ignoreStraight,
matrix){function addCurve(segment1,segment2){segment2=Curve.getValues(segment1,segment2,matrix);curves.push(segment2);computeParts(segment2,segment1._index,0,1)}function computeParts(curve,index,t1,t2){if(!(t2-t1>minSpan)||ignoreStraight&&Curve.isStraight(curve)||Curve.isFlatEnough(curve,flatness||.25)){t1=curve[6]-curve[0];var dy=curve[7]-curve[1];t1=Math.sqrt(t1*t1+dy*dy);0<t1&&(length+=t1,parts.push({offset:length,curve:curve,index:index,time:t2}))}else curve=Curve.subdivide(curve,.5),dy=(t1+t2)/
2,computeParts(curve[0],index,t1,dy),computeParts(curve[1],index,dy,t2)}var curves=[],parts=[],length=0,minSpan=1/(maxRecursion||32);maxRecursion=path._segments;for(var segment1$jscomp$0=maxRecursion[0],segment2$jscomp$0,i=1,l=maxRecursion.length;i<l;i++)segment2$jscomp$0=maxRecursion[i],addCurve(segment1$jscomp$0,segment2$jscomp$0),segment1$jscomp$0=segment2$jscomp$0;path._closed&&addCurve(segment2$jscomp$0||segment1$jscomp$0,maxRecursion[0]);this.curves=curves;this.parts=parts;this.length=length;
this.index=0},_get:function(offset){for(var parts=this.parts,length=parts.length,i,j=this.index;i=j,j&&!(parts[--j].offset<offset););for(;i<length;i++)if(j=parts[i],j.offset>=offset)return this.index=i,parts=(length=parts[i-1])&&length.index===j.index?length.time:0,length=length?length.offset:0,{index:j.index,time:parts+(j.time-parts)*(offset-length)/(j.offset-length)};return{index:parts[length-1].index,time:1}},drawPart:function(ctx,from,to){from=this._get(from);to=this._get(to);for(var i=from.index,
l=to.index;i<=l;i++){var curve=Curve.getPart(this.curves[i],i===from.index?from.time:0,i===to.index?to.time:1);i===from.index&&ctx.moveTo(curve[0],curve[1]);ctx.bezierCurveTo.apply(ctx,curve.slice(2))}}},Base.each(Curve._evaluateMethods,function(name){this[name+"At"]=function(offset){offset=this._get(offset);return Curve[name](this.curves[offset.index],offset.time)}},{})),PathFitter=Base.extend({initialize:function(path){var points=this.points=[],segments=path._segments;path=path._closed;for(var i=
0,prev,l=segments.length;i<l;i++){var point=segments[i].point;prev&&prev.equals(point)||points.push(prev=point.clone())}path&&(points.unshift(points[points.length-1]),points.push(points[1]));this.closed=path},fit:function(error){var points=this.points,length=points.length,segments=null;0<length&&(segments=[new Segment(points[0])],1<length&&(this.fitCubic(segments,error,0,length-1,points[1].subtract(points[0]),points[length-2].subtract(points[length-1])),this.closed&&(segments.shift(),segments.pop())));
return segments},fitCubic:function(segments,error,first,last,tan1,tan2){var points=this.points;if(1===last-first)error=points[first],last=points[last],first=error.getDistance(last)/3,this.addCurve(segments,[error,error.add(tan1.normalize(first)),last.add(tan2.normalize(first)),last]);else{for(var uPrime=this.chordLengthParameterize(first,last),maxError=Math.max(error,error*error),split,parametersInOrder=!0,i=0;4>=i;i++){var curve=this.generateBezier(first,last,uPrime,tan1,tan2),max=this.findMaxError(first,
last,curve,uPrime);if(max.error<error&&parametersInOrder){this.addCurve(segments,curve);return}split=max.index;if(max.error>=maxError)break;parametersInOrder=this.reparameterize(first,last,uPrime,curve);maxError=max.error}points=points[split-1].subtract(points[split+1]);this.fitCubic(segments,error,first,split,tan1,points);this.fitCubic(segments,error,split,last,points.negate(),tan2)}},addCurve:function(segments,curve){segments[segments.length-1].setHandleOut(curve[1].subtract(curve[0]));segments.push(new Segment(curve[3],
curve[2].subtract(curve[3])))},generateBezier:function(first,last,uPrime,tan1,tan2){var abs=Math.abs,points=this.points,pt1=points[first],pt2=points[last],C=[[0,0],[0,0]],X=[0,0],i=0;for(last=last-first+1;i<last;i++){var u=uPrime[i],t=1-u,b=3*u*t,b0=t*t*t;t*=b;b*=u;var b3=u*u*u;u=tan1.normalize(t);var a2=tan2.normalize(b);b0=points[first+i].subtract(pt1.multiply(b0+t)).subtract(pt2.multiply(b+b3));C[0][0]+=u.dot(u);C[0][1]+=u.dot(a2);C[1][0]=C[0][1];C[1][1]+=a2.dot(a2);X[0]+=u.dot(b0);X[1]+=a2.dot(b0)}first=
C[0][0]*C[1][1]-C[1][0]*C[0][1];1E-12<abs(first)?(abs=C[0][0]*X[1]-C[1][0]*X[0],X=(X[0]*C[1][1]-X[1]*C[0][1])/first,abs/=first):(first=C[0][0]+C[0][1],C=C[1][0]+C[1][1],X=abs=1E-12<abs(first)?X[0]/first:1E-12<abs(C)?X[1]/C:0);C=pt2.getDistance(pt1);first=1E-12*C;if(X<first||abs<first)X=abs=C/3;else{first=pt2.subtract(pt1);var handle1=tan1.normalize(X);var handle2=tan2.normalize(abs);handle1.dot(first)-handle2.dot(first)>C*C&&(X=abs=C/3,handle1=handle2=null)}return[pt1,pt1.add(handle1||tan1.normalize(X)),
pt2.add(handle2||tan2.normalize(abs)),pt2]},reparameterize:function(first,last,u,curve){for(var i=first;i<=last;i++)u[i-first]=this.findRoot(curve,this.points[i],u[i-first]);i=1;for(first=u.length;i<first;i++)if(u[i]<=u[i-1])return!1;return!0},findRoot:function(curve,point,u){for(var curve1=[],curve2=[],i=0;2>=i;i++)curve1[i]=curve[i+1].subtract(curve[i]).multiply(3);for(i=0;1>=i;i++)curve2[i]=curve1[i+1].subtract(curve1[i]).multiply(2);curve=this.evaluate(3,curve,u);curve1=this.evaluate(2,curve1,
u);curve2=this.evaluate(1,curve2,u);point=curve.subtract(point);curve2=curve1.dot(curve1)+point.dot(curve2);return Numerical.isMachineZero(curve2)?u:u-point.dot(curve1)/curve2},evaluate:function(degree,curve,t){curve=curve.slice();for(var i=1;i<=degree;i++)for(var j=0;j<=degree-i;j++)curve[j]=curve[j].multiply(1-t).add(curve[j+1].multiply(t));return curve[0]},chordLengthParameterize:function(first,last){for(var u=[0],i=first+1;i<=last;i++)u[i-first]=u[i-first-1]+this.points[i].getDistance(this.points[i-
1]);i=1;for(first=last-first;i<=first;i++)u[i]/=u[first];return u},findMaxError:function(first,last,curve,u){for(var index=Math.floor((last-first+1)/2),maxDist=0,i=first+1;i<last;i++){var v=this.evaluate(3,curve,u[i-first]).subtract(this.points[i]);v=v.x*v.x+v.y*v.y;v>=maxDist&&(maxDist=v,index=i)}return{error:maxDist,index:index}}}),TextItem=Item.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(arg){this._content=
"";this._lines=[];var hasProps=arg&&Base.isPlainObject(arg)&&undefined===arg.x&&undefined===arg.y;this._initialize(hasProps&&arg,!hasProps&&Point.read(arguments))},_equals:function(item){return this._content===item._content},copyContent:function(source){this.setContent(source._content)},getContent:function(){return this._content},setContent:function(content){this._content=""+content;this._lines=this._content.split(/\r\n|\n|\r/mg);this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",
setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),PointText=TextItem.extend({_class:"PointText",initialize:function(){TextItem.apply(this,arguments)},getPoint:function(){var point=this._matrix.getTranslation();return new LinkedPoint(point.x,point.y,this,"setPoint")},setPoint:function(){var point=Point.read(arguments);this.translate(point.subtract(this._matrix.getTranslation()))},_draw:function(ctx,param,viewMatrix){if(this._content){this._setStyles(ctx,param,
viewMatrix);param=this._lines;var style=this._style;viewMatrix=style.hasFill();var hasStroke=style.hasStroke(),leading=style.getLeading(),shadowColor=ctx.shadowColor;ctx.font=style.getFontStyle();ctx.textAlign=style.getJustification();style=0;for(var l=param.length;style<l;style++){ctx.shadowColor=shadowColor;var line=param[style];viewMatrix&&(ctx.fillText(line,0,0),ctx.shadowColor="rgba(0,0,0,0)");hasStroke&&ctx.strokeText(line,0,0);ctx.translate(0,leading)}}},_getBounds:function(matrix,options){var style=
this._style,lines=this._lines;options=lines.length;var justification=style.getJustification(),leading=style.getLeading();style=this.getView().getTextWidth(style.getFontStyle(),lines);lines=0;"left"!==justification&&(lines-=style/("center"===justification?2:1));options=new Rectangle(lines,options?-.75*leading:0,style,options*leading);return matrix?matrix._transformBounds(options,options):options}}),Color=Base.extend(new function(){var types={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation",
"brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},componentParsers={},namedColors={transparent:[0,0,0,0]},colorCtx,hsbIndices=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],converters={"rgb-hsb":function(r,g,b){var max=Math.max(r,g,b),delta=max-Math.min(r,g,b);return[0===delta?0:60*(max==r?(g-b)/delta+(g<b?6:0):max==g?(b-r)/delta+2:(r-g)/delta+4),0===max?0:delta/max,max]},"hsb-rgb":function(h,s,b){h=(h/60%6+6)%6;var i=Math.floor(h);h-=
i;i=hsbIndices[i];s=[b,b*(1-s),b*(1-s*h),b*(1-s*(1-h))];return[s[i[0]],s[i[1]],s[i[2]]]},"rgb-hsl":function(r,g,b){var max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,achromatic=0===delta,l=(max+min)/2;return[achromatic?0:60*(max==r?(g-b)/delta+(g<b?6:0):max==g?(b-r)/delta+2:(r-g)/delta+4),achromatic?0:.5>l?delta/(max+min):delta/(2-max-min),l]},"hsl-rgb":function(h,s,l){h=(h/360%1+1)%1;if(0===s)return[l,l,l];h=[h+1/3,h,h-1/3];s=.5>l?l*(1+s):l+s-l*s;l=2*l-s;for(var c=[],i=0;3>i;i++){var t3=h[i];
0>t3&&(t3+=1);1<t3&&--t3;c[i]=1>6*t3?l+6*(s-l)*t3:1>2*t3?s:2>3*t3?l+(s-l)*(2/3-t3)*6:l}return c},"rgb-gray":function(r,g,b){return[.2989*r+.587*g+.114*b]},"gray-rgb":function(g){return[g,g,g]},"gray-hsb":function(g){return[0,0,g]},"gray-hsl":function(g){return[0,0,g]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return Base.each(types,function(properties,type){componentParsers[type]=[];Base.each(properties,function(name,index){var part=Base.capitalize(name),hasOverlap=
/^(hue|saturation)$/.test(name),parser=componentParsers[type][index]="gradient"===type?"gradient"===name?function(value){var current=this._components[0];value=Gradient.read(Array.isArray(value)?value:arguments,0,{readNull:!0});current!==value&&(current&&current._removeOwner(this),value&&value._addOwner(this));return value}:function(){return Point.read(arguments,0,{readNull:"highlight"===name,clone:!0})}:function(value){return null==value||isNaN(value)?0:+value};this["get"+part]=function(){return this._type===
type||hasOverlap&&/^hs[bl]$/.test(this._type)?this._components[index]:this._convert(type)[index]};this["set"+part]=function(value){this._type===type||hasOverlap&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(type),this._properties=types[type],this._type=type);this._components[index]=parser.call(this,value);this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Color(arg){var args=arguments,reading=this.__read,read=0,values;Array.isArray(arg)&&(args=arg,arg=args[0]);
var argType=null!=arg&&typeof arg;if("string"===argType&&arg in types){var type=arg;arg=args[1];if(Array.isArray(arg)){var components=arg;var alpha=args[2]}else reading&&(read=1),args=Base.slice(args,1),argType=typeof arg}if(!components){if(values="number"===argType?args:"object"===argType&&null!=arg.length?arg:null)type||(type=3<=values.length?"rgb":"gray"),args=types[type].length,alpha=values[args],reading&&(read+=values===arguments?args+(null!=alpha?1:0):1),values.length>args&&(values=Base.slice(values,
0,args));else if("string"===argType){components=arg;var match=components.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||components.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i);type="rgb";if(match){var amount=match[4]?4:3;components=Array(amount);for(args=0;args<amount;args++)argType=match[args+1],components[args]=parseInt(1==argType.length?argType+argType:argType,16)/255}else if(match=components.match(/^(rgb|hsl)a?\((.*)\)$/))for(type=match[1],components=match[2].trim().split(/[,\s]+/g),
match="hsl"===type,args=0,amount=Math.min(components.length,4);args<amount;args++){var component=components[args];argType=parseFloat(component);match?0===args?(component=component.match(/([a-z]*)$/)[1],argType*={turn:360,rad:180/Math.PI,grad:.9}[component]||1):3>args&&(argType/=100):3>args&&(argType/=/%$/.test(component)?100:255);components[args]=argType}else args=namedColors[components],args||(window?(colorCtx||(colorCtx=CanvasProvider.getContext(1,1),colorCtx.globalCompositeOperation="copy"),colorCtx.fillStyle=
"rgba(0,0,0,0)",colorCtx.fillStyle=components,colorCtx.fillRect(0,0,1,1),args=colorCtx.getImageData(0,0,1,1).data,args=namedColors[components]=[args[0]/255,args[1]/255,args[2]/255]):args=[0,0,0]),components=args.slice();components=[type,components];type=components[0];components=components[1];4===components.length&&(alpha=components[3],components.length--)}else if("object"===argType)if(arg.constructor===Color){if(type=arg._type,components=arg._components.slice(),alpha=arg._alpha,"gradient"===type)for(args=
1,argType=components.length;args<argType;args++)(match=components[args])&&(components[args]=match.clone())}else if(arg.constructor===Gradient)type="gradient",values=args;else{type="hue"in arg?"lightness"in arg?"hsl":"hsb":"gradient"in arg||"stops"in arg||"radial"in arg?"gradient":"gray"in arg?"gray":"rgb";alpha=types[type];match=componentParsers[type];this._components=components=[];args=0;for(argType=alpha.length;args<argType;args++)amount=arg[alpha[args]],null==amount&&!args&&"gradient"===type&&
"stops"in arg&&(amount={stops:arg.stops,radial:arg.radial}),amount=match[args].call(this,amount),null!=amount&&(components[args]=amount);alpha=arg.alpha}reading&&type&&(read=1)}this._type=type||"rgb";if(!components)for(this._components=components=[],match=componentParsers[this._type],args=0,argType=match.length;args<argType;args++)amount=match[args].call(this,values&&values[args]),null!=amount&&(components[args]=amount);this._components=components;this._properties=types[this._type];this._alpha=alpha;
reading&&(this.__read=read);return this},set:"#initialize",_serialize:function(options,dictionary){var components=this.getComponents();return Base.serialize(/^(gray|rgb)$/.test(this._type)?components:[this._type].concat(components),options,!0,dictionary)},_changed:function(){this._canvasStyle=null;if(this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(type){var converter;return this._type===type?this._components.slice():(converter=converters[this._type+
"-"+type])?converter.apply(this,this._components):converters["rgb-"+type].apply(this,converters[this._type+"-rgb"].apply(this,this._components))},convert:function(type){return new Color(type,this._convert(type),this._alpha)},getType:function(){return this._type},setType:function(type){this._components=this._convert(type);this._properties=types[type];this._type=type},getComponents:function(){var components=this._components.slice();null!=this._alpha&&components.push(this._alpha);return components},
getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(alpha){this._alpha=null==alpha?null:Math.min(Math.max(alpha,0),1);this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(color){var col=Base.isPlainValue(color,!0)?Color.read(arguments):color;return col===this||col&&this._class===col._class&&this._type===col._type&&this.getAlpha()===col.getAlpha()&&Base.equals(this._components,col._components)||!1},toString:function(){for(var properties=this._properties,
parts=[],isGradient="gradient"===this._type,f=Formatter.instance,i=0,l=properties.length;i<l;i++){var value=this._components[i];null!=value&&parts.push(properties[i]+": "+(isGradient?value:f.number(value)))}null!=this._alpha&&parts.push("alpha: "+f.number(this._alpha));return"{ "+parts.join(", ")+" }"},toCSS:function(hex){function convert(val){return Math.round(255*(0>val?0:1<val?1:val))}var components=this._convert("rgb"),alpha=hex||null==this._alpha?1:this._alpha;components=[convert(components[0]),
convert(components[1]),convert(components[2])];1>alpha&&components.push(0>alpha?0:alpha);return hex?"#"+(16777216+(components[0]<<16)+(components[1]<<8)+components[2]).toString(16).slice(1):(4==components.length?"rgba(":"rgb(")+components.join(",")+")"},toCanvasStyle:function(ctx,matrix){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var components=this._components,gradient=components[0],stops=gradient._stops,origin=components[1],destination=
components[2];components=components[3];if(matrix=matrix&&matrix.inverted())origin=matrix._transformPoint(origin),destination=matrix._transformPoint(destination),components&&(components=matrix._transformPoint(components));gradient._radial?(gradient=destination.getDistance(origin),components&&(destination=components.subtract(origin),destination.getLength()>gradient&&(components=origin.add(destination.normalize(gradient-.1)))),components=components||origin,ctx=ctx.createRadialGradient(components.x,components.y,
0,origin.x,origin.y,gradient)):ctx=ctx.createLinearGradient(origin.x,origin.y,destination.x,destination.y);origin=0;for(components=stops.length;origin<components;origin++)gradient=stops[origin],destination=gradient._offset,ctx.addColorStop(null==destination?origin/(components-1):destination,gradient._color.toCanvasStyle());return this._canvasStyle=ctx},transform:function(matrix){if("gradient"===this._type){for(var components=this._components,i=1,l=components.length;i<l;i++){var point=components[i];
matrix._transformPoint(point,point,!0)}this._changed()}},statics:{_types:types,random:function(){var random=Math.random;return new Color(random(),random(),random())},_setOwner:function(color,owner,setter){color&&(color._owner&&owner&&color._owner!==owner&&(color=color.clone()),!color._owner^!owner&&(color._owner=owner||null,color._setter=setter||null));return color}}})},new function(){return Base.each({add:function(a,b){return a+b},subtract:function(a,b){return a-b},multiply:function(a,b){return a*
b},divide:function(a,b){return a/b}},function(operator,name){this[name]=function(color){color=Color.read(arguments);for(var type=this._type,components1=this._components,components2=color._convert(type),i=0,l=components1.length;i<l;i++)components2[i]=operator(components1[i],components2[i]);return new Color(type,components2,null!=this._alpha?operator(this._alpha,color.getAlpha()):null)}},{})}),Gradient=Base.extend({_class:"Gradient",initialize:function(stops,radial){this._id=UID.get();stops&&Base.isPlainObject(stops)&&
(this.set(stops),stops=radial=null);null==this._stops&&this.setStops(stops||["white","black"]);null==this._radial&&this.setRadial("string"===typeof radial&&"radial"===radial||radial||!1)},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._stops,this._radial],options,!0,dictionary)})},_changed:function(){for(var i=0,l=this._owners&&this._owners.length;i<l;i++)this._owners[i]._changed()},_addOwner:function(color){this._owners||(this._owners=[]);
this._owners.push(color)},_removeOwner:function(color){color=this._owners?this._owners.indexOf(color):-1;-1!=color&&(this._owners.splice(color,1),this._owners.length||(this._owners=undefined))},clone:function(){for(var stops=[],i=0,l=this._stops.length;i<l;i++)stops[i]=this._stops[i].clone();return new Gradient(stops,this._radial)},getStops:function(){return this._stops},setStops:function(stops){if(2>stops.length)throw Error("Gradient stop list needs to contain at least two stops.");var _stops=this._stops;
if(_stops)for(var i=0,l=_stops.length;i<l;i++)_stops[i]._owner=undefined;_stops=this._stops=GradientStop.readList(stops,0,{clone:!0});i=0;for(l=_stops.length;i<l;i++)_stops[i]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(radial){this._radial=radial;this._changed()},equals:function(gradient){if(gradient===this)return!0;if(gradient&&this._class===gradient._class){var stops1=this._stops;gradient=gradient._stops;var length=stops1.length;if(length===gradient.length){for(var i=
0;i<length;i++)if(!stops1[i].equals(gradient[i]))return!1;return!0}}return!1}}),GradientStop=Base.extend({_class:"GradientStop",initialize:function(arg0,arg1){var color=arg0,offset=arg1;if("object"===typeof arg0&&undefined===arg1)if(Array.isArray(arg0)&&"number"!==typeof arg0[0])color=arg0[0],offset=arg0[1];else if("color"in arg0||"offset"in arg0||"rampPoint"in arg0)color=arg0.color,offset=arg0.offset||arg0.rampPoint||0;this.setColor(color);this.setOffset(offset)},clone:function(){return new GradientStop(this._color.clone(),
this._offset)},_serialize:function(options,dictionary){var color=this._color,offset=this._offset;return Base.serialize(null==offset?[color]:[color,offset],options,!0,dictionary)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(offset){this._offset=offset;this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Color._setOwner(this._color,null);this._color=
Color._setOwner(Color.read(arguments,0),this,"setColor");this._changed()},equals:function(stop){return stop===this||stop&&this._class===stop._class&&this._color.equals(stop._color)&&this._offset==stop._offset||!1}}),Style=Base.extend(new function(){var itemDefaults={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new Point,selectedColor:null},groupDefaults=
Base.set({},itemDefaults,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),textDefaults=Base.set({},groupDefaults,{fillColor:new Color}),flags={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},item={beans:!0},fields={_class:"Style",beans:!0,initialize:function(style,_owner,_project){this._values={};this._project=(this._owner=_owner)&&_owner._project||_project||
paper.project;this._defaults=!_owner||_owner instanceof Group?groupDefaults:_owner instanceof TextItem?textDefaults:itemDefaults;style&&this.set(style)}};Base.each(groupDefaults,function(value$jscomp$0,key){var isColor=/Color$/.test(key),isPoint="shadowOffset"===key;value$jscomp$0=Base.capitalize(key);var flag=flags[key],set="set"+value$jscomp$0,get="get"+value$jscomp$0;fields[set]=function(value){var owner=this._owner,children=owner&&owner._children,applyToChildren=children&&0<children.length&&!(owner instanceof
CompoundPath);if(applyToChildren)for(var i=0,l=children.length;i<l;i++)children[i]._style[set](value);("selectedColor"===key||!applyToChildren)&&key in this._defaults&&(children=this._values[key],children!==value&&(isColor&&(children&&(Color._setOwner(children,null),children._canvasStyle=null),value&&value.constructor===Color&&(value=Color._setOwner(value,owner,applyToChildren&&set))),this._values[key]=value,owner&&owner._changed(flag||129)))};fields[get]=function(_dontMerge){var owner=this._owner,
children=owner&&owner._children,applyToChildren=children&&0<children.length&&!(owner instanceof CompoundPath);if(applyToChildren&&!_dontMerge){_dontMerge=0;for(var l=children.length;_dontMerge<l;_dontMerge++){var childValue=children[_dontMerge]._style[get]();if(!_dontMerge)var value=childValue;else if(!Base.equals(value,childValue))return}}else key in this._defaults&&(value=this._values[key],undefined===value?(value=this._defaults[key])&&value.clone&&(value=value.clone()):(children=isColor?Color:
isPoint?Point:null,!children||value&&value.constructor===children||(this._values[key]=value=children.read([value],0,{readNull:!0,clone:!0}))));value&&isColor&&(value=Color._setOwner(value,owner,applyToChildren&&set));return value};item[get]=function(_dontMerge){return this._style[get](_dontMerge)};item[set]=function(value){this._style[set](value)}});Base.each({Font:"FontFamily",WindingRule:"FillRule"},function(value,key){var get="get"+key;key="set"+key;fields[get]=item[get]="#get"+value;fields[key]=
item[key]="#set"+value});Item.inject(item);return fields},{set:function(style){var isStyle=style instanceof Style;if(style=isStyle?style._values:style)for(var key in style)if(key in this._defaults){var value=style[key];this[key]=value&&isStyle&&value.clone?value.clone():value}},equals:function(style){function compare(style1,style2,secondary){style1=style1._values;var values2=style2._values;style2=style2._defaults;for(var key in style1){var value1=style1[key],value2=values2[key];if(!(secondary&&key in
values2||Base.equals(value1,undefined===value2?style2[key]:value2)))return!1}return!0}return style===this||style&&this._class===style._class&&compare(this,style)&&compare(style,this,!0)||!1},_dispose:function(){var color;if(color=this.getFillColor())color._canvasStyle=null;if(color=this.getStrokeColor())color._canvasStyle=null;if(color=this.getShadowColor())color._canvasStyle=null},hasFill:function(){var color=this.getFillColor();return!!color&&0<color.alpha},hasStroke:function(){var color=this.getStrokeColor();
return!!color&&0<color.alpha&&0<this.getStrokeWidth()},hasShadow:function(){var color=this.getShadowColor();return!!color&&0<color.alpha&&(0<this.getShadowBlur()||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var fontSize=this.getFontSize();return this.getFontWeight()+" "+fontSize+(/[a-z]/i.test(fontSize+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function getLeading(){var leading=getLeading.base.call(this),
fontSize=this.getFontSize();/pt|em|%|px/.test(fontSize)&&(fontSize=this.getView().getPixelSize(fontSize));return null!=leading?leading:1.2*fontSize}}),DomElement=new function(){function handlePrefix(el,name,set,value){for(var prefixes=" webkit moz Moz ms o".split(" "),suffix=name[0].toUpperCase()+name.substring(1),i=0;6>i;i++){var prefix=prefixes[i];prefix=prefix?prefix+suffix:name;if(prefix in el){if(set)el[prefix]=value;else return el[prefix];break}}}return{getStyles:function(el){var doc=el&&9!==
el.nodeType?el.ownerDocument:el;return(doc=doc&&doc.defaultView)&&doc.getComputedStyle(el,"")},getBounds:function(el,viewport){var doc=el.ownerDocument,body=doc.body,html=doc.documentElement;try{var rect=el.getBoundingClientRect()}catch(e){rect={left:0,top:0,width:0,height:0}}el=rect.left-(html.clientLeft||body.clientLeft||0);var y=rect.top-(html.clientTop||body.clientTop||0);viewport||(viewport=doc.defaultView,el+=viewport.pageXOffset||html.scrollLeft||body.scrollLeft,y+=viewport.pageYOffset||html.scrollTop||
body.scrollTop);return new Rectangle(el,y,rect.width,rect.height)},getViewportBounds:function(el){var doc=el.ownerDocument;el=doc.defaultView;doc=doc.documentElement;return new Rectangle(0,0,el.innerWidth||doc.clientWidth,el.innerHeight||doc.clientHeight)},getOffset:function(el,viewport){return DomElement.getBounds(el,viewport).getPoint()},getSize:function(el){return DomElement.getBounds(el,!0).getSize()},isInvisible:function(el){return DomElement.getSize(el).equals(new Size(0,0))},isInView:function(el){return!DomElement.isInvisible(el)&&
DomElement.getViewportBounds(el).intersects(DomElement.getBounds(el,!0))},isInserted:function(el){return document.body.contains(el)},getPrefixed:function(el,name){return el&&handlePrefix(el,name)},setPrefixed:function(el,name,value){if("object"===typeof name)for(var key in name)handlePrefix(el,key,!0,name[key]);else handlePrefix(el,name,!0,value)}}},DomEvent={add:function(el,events){if(el)for(var type in events)for(var func=events[type],parts=type.split(/[\s,]+/g),i=0,l=parts.length;i<l;i++){var name=
parts[i];el.addEventListener(name,func,el!==document||"touchstart"!==name&&"touchmove"!==name?!1:{passive:!1})}},remove:function(el,events){if(el)for(var type in events)for(var func=events[type],parts=type.split(/[\s,]+/g),i=0,l=parts.length;i<l;i++)el.removeEventListener(parts[i],func,!1)},getPoint:function(event){event=event.targetTouches?event.targetTouches.length?event.targetTouches[0]:event.changedTouches[0]:event;return new Point(event.pageX||event.clientX+document.documentElement.scrollLeft,
event.pageY||event.clientY+document.documentElement.scrollTop)},getTarget:function(event){return event.target||event.srcElement},getRelatedTarget:function(event){return event.relatedTarget||event.toElement},getOffset:function(event,target){return DomEvent.getPoint(event).subtract(DomElement.getOffset(target||DomEvent.getTarget(event)))}};DomEvent.requestAnimationFrame=new function(){function handleCallbacks(){var functions=callbacks;callbacks=[];for(var i=0,l=functions.length;i<l;i++)functions[i]();
(requested=nativeRequest&&callbacks.length)&&nativeRequest(handleCallbacks)}var nativeRequest=DomElement.getPrefixed(window,"requestAnimationFrame"),requested=!1,callbacks=[],timer;return function(callback){callbacks.push(callback);nativeRequest?requested||(nativeRequest(handleCallbacks),requested=!0):timer||(timer=setInterval(handleCallbacks,1E3/60))}};var View=Base.extend(Emitter,{_class:"View",initialize:function View(project,element){function getSize(name){return element[name]||parseInt(element.getAttribute(name),
10)}function getCanvasSize(){var size=DomElement.getSize(element);return size.isNaN()||size.isZero()?new Size(getSize("width"),getSize("height")):size}if(window&&element){this._id=element.getAttribute("id");null==this._id&&element.setAttribute("id",this._id="view-"+View._id++);DomEvent.add(element,this._viewEvents);DomElement.setPrefixed(element.style,{userDrag:"none",userSelect:"none",touchCallout:"none",contentZooming:"none",tapHighlightColor:"rgba(0,0,0,0)"});if(PaperScope.hasAttribute(element,
"resize")){var that=this;DomEvent.add(window,this._windowEvents={resize:function(){that.setViewSize(getCanvasSize())}})}var size$jscomp$0=getCanvasSize();if(PaperScope.hasAttribute(element,"stats")&&"undefined"!==typeof Stats){this._stats=new Stats;var stats=this._stats.domElement,style=stats.style,offset=DomElement.getOffset(element);style.position="absolute";style.left=offset.x+"px";style.top=offset.y+"px";document.body.appendChild(stats)}}else size$jscomp$0=new Size(element),element=null;this._project=
project;this._scope=project._scope;this._element=element;this._pixelRatio||(this._pixelRatio=window&&window.devicePixelRatio||1);this._setElementSize(size$jscomp$0.width,size$jscomp$0.height);this._viewSize=size$jscomp$0;View._views.push(this);View._viewsById[this._id]=this;(this._matrix=new Matrix)._owner=this;View._focused||(View._focused=this);this._frameItems={};this._frameItemCount=0;this._itemEvents={native:{},virtual:{}};this._autoUpdate=!paper.agent.node;this._needsUpdate=!1},remove:function(){if(!this._project)return!1;
View._focused===this&&(View._focused=null);View._views.splice(View._views.indexOf(this),1);delete View._viewsById[this._id];var project=this._project;project._view===this&&(project._view=null);DomEvent.remove(this._element,this._viewEvents);DomEvent.remove(window,this._windowEvents);this._element=this._project=null;this.off("frame");this._animate=!1;this._frameItems={};return!0},_events:Base.each(Item._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(name){this[name]={}},{onFrame:{install:function(){this.play()},
uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(autoUpdate){(this._autoUpdate=autoUpdate)&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var that=this;DomEvent.requestAnimationFrame(function(){that._requested=!1;if(that._animate){that.requestUpdate();var element=that._element;DomElement.getPrefixed(document,"hidden")&&"true"!==PaperScope.getAttribute(element,
"keepalive")||!DomElement.isInView(element)||that._handleFrame()}that._autoUpdate&&that.update()});this._requested=!0}},play:function(){this._animate=!0;this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){paper=this._scope;var now=Date.now()/1E3,delta=this._last?now-this._last:0;this._last=now;this.emit("frame",new Base({delta:delta,time:this._time+=delta,count:this._count++}));this._stats&&this._stats.update()},_animateItem:function(item,animate){var items=this._frameItems;
if(animate){if(items[item._id]={item:item,time:0,count:0},1===++this._frameItemCount)this.on("frame",this._handleFrameItems)}else delete items[item._id],0===--this._frameItemCount&&this.off("frame",this._handleFrameItems)},_handleFrameItems:function(event){for(var i in this._frameItems){var entry=this._frameItems[i];entry.item.emit("frame",new Base(event,{time:entry.time+=event.delta,count:entry.count++}))}},_changed:function(){this._project._changed(4097);this._bounds=this._decomposed=undefined},
getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var size=this._viewSize;return new LinkedSize(size.width,size.height,this,"setViewSize")},setViewSize:function(){var size=Size.read(arguments),delta=size.subtract(this._viewSize);delta.isZero()||(this._setElementSize(size.width,size.height),this._viewSize.set(size),this._changed(),this.emit("resize",{size:size,delta:delta}),this._autoUpdate&&
this.update())},_setElementSize:function(width,height){var element=this._element;element&&(element.width!==width&&(element.width=width),element.height!==height&&(element.height=height))},getBounds:function(){this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new Rectangle(new Point,this._viewSize)));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return DomElement.isInView(this._element)},isInserted:function(){return DomElement.isInserted(this._element)},
getPixelSize:function(size){var element=this._element;if(element){element=element.parentNode;var temp=document.createElement("div");temp.style.fontSize=size;element.appendChild(temp);var pixels=parseFloat(DomElement.getStyles(temp).fontSize);element.removeChild(temp)}else pixels=parseFloat(pixels);return pixels},getTextWidth:function(font,lines){return 0}},Base.each(["rotate","scale","shear","skew"],function(key){var rotate="rotate"===key;this[key]=function(){var args=arguments,value=(rotate?Base:
Point).read(args);args=Point.read(args,0,{readNull:!0});return this.transform((new Matrix)[key](value,args||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var mx=new Matrix;return this.transform(mx.translate.apply(mx,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var center=Point.read(arguments);this.translate(this.getCenter().subtract(center))},getZoom:function(){var scaling=
this._decompose().scaling;return(scaling.x+scaling.y)/2},setZoom:function(zoom){this.transform((new Matrix).scale(zoom/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(rotation){var current=this.getRotation();null!=current&&null!=rotation&&this.rotate(rotation-current)},getScaling:function(){var scaling=this._decompose().scaling;return new LinkedPoint(scaling.x,scaling.y,this,"setScaling")},setScaling:function(){var current=this.getScaling(),
scaling=Point.read(arguments,0,{clone:!0,readNull:!0});current&&scaling&&this.scale(scaling.x/current.x,scaling.y/current.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var matrix=this._matrix;matrix.initialize.apply(matrix,arguments)},transform:function(matrix){this._matrix.append(matrix)},scrollBy:function(){this.translate(Point.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(Point.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(Point.read(arguments))},
getEventPoint:function(event){return this.viewToProject(DomEvent.getOffset(event,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(project,element){document&&"string"===typeof element&&(element=document.getElementById(element));return new (window?CanvasView:View)(project,element)}}},new function(){function getView(event){event=DomEvent.getTarget(event);return event.getAttribute&&View._viewsById[event.getAttribute("id")]}function updateFocus(){var view=View._focused;if(!view||
!view.isVisible())for(var i=0,l=View._views.length;i<l;i++)if((view=View._views[i]).isVisible()){View._focused=tempFocus=view;break}}function emitMouseEvent(obj$jscomp$0,target,type$jscomp$0,event,point,prevPoint,stopItem){function emit(obj,type){if(obj.responds(type)){if(mouseEvent||(mouseEvent=new MouseEvent(type,event,point,target||obj,prevPoint?point.subtract(prevPoint):null)),obj.emit(type,mouseEvent)&&(called=!0,mouseEvent.prevented&&(prevented=!0),mouseEvent.stopped))return stopped=!0}else if(type=
fallbacks[type])return emit(obj,type)}for(var stopped=!1,mouseEvent;obj$jscomp$0&&obj$jscomp$0!==stopItem&&!emit(obj$jscomp$0,type$jscomp$0);)obj$jscomp$0=obj$jscomp$0._parent;return stopped}function emitMouseEvents(view,hitItem,type,event,point,prevPoint){view._project.removeOn(type);prevented=called=!1;return dragItem&&emitMouseEvent(dragItem,null,type,event,point,prevPoint)||hitItem&&hitItem!==dragItem&&!hitItem.isDescendant(dragItem)&&emitMouseEvent(hitItem,null,"mousedrag"===type?"mousemove":
type,event,point,prevPoint,dragItem)||emitMouseEvent(view,dragItem||hitItem||view,type,event,point,prevPoint)}if(window){var prevFocus,tempFocus,dragging=!1,mouseDown=!1,navigator=window.navigator;if(navigator.pointerEnabled||navigator.msPointerEnabled){var mousedown="pointerdown MSPointerDown";var mousemove="pointermove MSPointerMove";var mouseup="pointerup pointercancel MSPointerUp MSPointerCancel"}else mousedown="touchstart",mousemove="touchmove",mouseup="touchend touchcancel","ontouchstart"in
window&&navigator.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(mousedown+=" mousedown",mousemove+=" mousemove",mouseup+=" mouseup");navigator={};var docEvents={mouseout:function(event){var view=View._focused,target=DomEvent.getRelatedTarget(event);if(view&&(!target||"HTML"===target.nodeName)){target=DomEvent.getOffset(event,view._element);var x=target.x,abs=Math.abs,ax=abs(x),diff=ax-33554432;target.x=abs(diff)<ax?diff*(0>x?-1:1):x;target=view.viewToProject(target);view._handleMouseEvent("mousemove",
event,target)}},scroll:updateFocus};navigator[mousedown]=function(event){var view=View._focused=getView(event);dragging||(dragging=!0,view._handleMouseEvent("mousedown",event))};docEvents[mousemove]=function(event){var view=View._focused;if(!mouseDown){var target=getView(event);target?view!==target&&(view&&view._handleMouseEvent("mousemove",event,void 0),prevFocus||(prevFocus=view),view=View._focused=tempFocus=target):tempFocus&&tempFocus===view&&(prevFocus&&!prevFocus.isInserted()&&(prevFocus=null),
view=View._focused=prevFocus,prevFocus=null,updateFocus())}view&&view._handleMouseEvent("mousemove",event,void 0)};docEvents[mousedown]=function(){mouseDown=!0};docEvents[mouseup]=function(event){var view=View._focused;view&&dragging&&view._handleMouseEvent("mouseup",event);mouseDown=dragging=!1};DomEvent.add(document,docEvents);DomEvent.add(window,{load:updateFocus});var called=!1,prevented=!1,fallbacks={doubleclick:"click",mousedrag:"mousemove"},wasInView=!1,downPoint,lastPoint,downItem,overItem,
dragItem,clickItem,clickTime,dblClick,itemEventsMap={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:navigator,_handleMouseEvent:function(type$jscomp$0,event,point){function responds(type){return itemEvents.virtual[type]||view.responds(type)||tool&&tool.responds(type)}var itemEvents=this._itemEvents,hitItems=itemEvents.native[type$jscomp$0],nativeMove="mousemove"===
type$jscomp$0,tool=this._scope.tool,view=this;nativeMove&&dragging&&responds("mousedrag")&&(type$jscomp$0="mousedrag");point||(point=this.getEventPoint(event));var inView=this.getBounds().contains(point),hit=hitItems&&inView&&view._project.hitTest(point,{tolerance:0,fill:!0,stroke:!0});hit=hit&&hit.item||null;var handle=!1,mouse={};mouse[type$jscomp$0.substr(5)]=!0;hitItems&&hit!==overItem&&(overItem&&emitMouseEvent(overItem,null,"mouseleave",event,point),hit&&emitMouseEvent(hit,null,"mouseenter",
event,point),overItem=hit);wasInView^inView&&(emitMouseEvent(this,null,inView?"mouseenter":"mouseleave",event,point),handle=!0);!inView&&!mouse.drag||point.equals(lastPoint)||(emitMouseEvents(this,hit,nativeMove?type$jscomp$0:"mousemove",event,point,lastPoint),handle=!0);wasInView=inView;if(mouse.down&&inView||mouse.up&&downPoint){emitMouseEvents(this,hit,type$jscomp$0,event,point,downPoint);if(mouse.down){dblClick=hit===clickItem&&300>Date.now()-clickTime;downItem=clickItem=hit;if(!prevented&&hit){for(hitItems=
hit;hitItems&&!hitItems.responds("mousedrag");)hitItems=hitItems._parent;hitItems&&(dragItem=hit)}downPoint=point}else mouse.up&&(prevented||hit!==downItem||(clickTime=Date.now(),emitMouseEvents(this,hit,dblClick?"doubleclick":"click",event,point,downPoint),dblClick=!1),downItem=dragItem=null);wasInView=!1;handle=!0}lastPoint=point;handle&&tool&&(called=tool._handleMouseEvent(type$jscomp$0,event,point,mouse)||called);!1!==event.cancelable&&(called&&!mouse.move||mouse.down&&responds("mouseup"))&&event.preventDefault()},
_handleKeyEvent:function(type,event,key,character){function emit(obj){obj.responds(type)&&(paper=scope,obj.emit(type,keyEvent=keyEvent||new KeyEvent(type,event,key,character)))}var scope=this._scope,tool=scope.tool,keyEvent;this.isVisible()&&(emit(this),tool&&tool.responds(type)&&emit(tool))},_countItemEvent:function(type,sign){var itemEvents=this._itemEvents,native=itemEvents.native;itemEvents=itemEvents.virtual;for(var key in itemEventsMap)native[key]=(native[key]||0)+(itemEventsMap[key][type]||
0)*sign;itemEvents[type]=(itemEvents[type]||0)+sign},statics:{updateFocus:updateFocus,_resetState:function(){dragging=mouseDown=called=wasInView=!1;prevFocus=tempFocus=downPoint=lastPoint=downItem=overItem=dragItem=clickItem=clickTime=dblClick=null}}}}}),CanvasView=View.extend({_class:"CanvasView",initialize:function(project,canvas){if(!(canvas instanceof window.HTMLCanvasElement)){var size=Size.read(arguments,1);if(size.isZero())throw Error("Cannot create CanvasView with the provided argument: "+
Base.slice(arguments,1));canvas=CanvasProvider.getCanvas(size)}var ctx=this._context=canvas.getContext("2d");ctx.save();this._pixelRatio=1;/^off|false$/.test(PaperScope.getAttribute(canvas,"hidpi"))||(size=window.devicePixelRatio||1,ctx=DomElement.getPrefixed(ctx,"backingStorePixelRatio")||1,this._pixelRatio=size/ctx);View.call(this,project,canvas);this._needsUpdate=!0},remove:function remove(){this._context.restore();return remove.base.call(this)},_setElementSize:function _setElementSize(width,height){var pixelRatio=
this._pixelRatio;_setElementSize.base.call(this,width*pixelRatio,height*pixelRatio);if(1!==pixelRatio){var element=this._element,ctx=this._context;PaperScope.hasAttribute(element,"resize")||(element=element.style,element.width=width+"px",element.height=height+"px");ctx.restore();ctx.save();ctx.scale(pixelRatio,pixelRatio)}},getContext:function(){return this._context},getPixelSize:function getPixelSize(size){var agent=paper.agent;if(agent&&agent.firefox)size=getPixelSize.base.call(this,size);else{agent=
this._context;var prevFont=agent.font;agent.font=size+" serif";size=parseFloat(agent.font);agent.font=prevFont}return size},getTextWidth:function(font,lines){var ctx=this._context,prevFont=ctx.font,width=0;ctx.font=font;font=0;for(var l=lines.length;font<l;font++)width=Math.max(width,ctx.measureText(lines[font]).width);ctx.font=prevFont;return width},update:function(){if(!this._needsUpdate)return!1;var project=this._project,ctx=this._context,size=this._viewSize;ctx.clearRect(0,0,size.width+1,size.height+
1);project&&project.draw(ctx,this._matrix,this._pixelRatio);this._needsUpdate=!1;return!0}}),Event=Base.extend({_class:"Event",initialize:function(event){this.type=(this.event=event)&&event.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0;this.event.preventDefault()},stopPropagation:function(){this.stopped=!0;this.event.stopPropagation()},stop:function(){this.stopPropagation();this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Key.modifiers}}),
KeyEvent=Event.extend({_class:"KeyEvent",initialize:function(type,event,key,character){this.type=type;this.event=event;this.key=key;this.character=character},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Key=new function(){function getKey(event){var key=event.key||event.keyIdentifier;key=/^U\+/.test(key)?String.fromCharCode(parseInt(key.substr(2),16)):/^Arrow[A-Z]/.test(key)?key.substr(5):"Unidentified"===
key||undefined===key?String.fromCharCode(event.keyCode):key;return keyLookup[key]||(1<key.length?Base.hyphenate(key):key.toLowerCase())}function handleKey(down,key,character,event){var view=View._focused,name;(keyMap[key]=down)?charMap[key]=character:delete charMap[key];if(1<key.length&&(name=Base.camelize(key))in modifiers){modifiers[name]=down;var agent=paper&&paper.agent;if("meta"===name&&agent&&agent.mac)if(down)metaFixMap={};else{for(var k in metaFixMap)k in charMap&&handleKey(!1,k,metaFixMap[k],
event);metaFixMap=null}}else down&&metaFixMap&&(metaFixMap[key]=character);view&&view._handleKeyEvent(down?"keydown":"keyup",event,key,character)}var keyLookup={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},charLookup={tab:"\t",space:" ",enter:"\r"},keyMap={},charMap={},metaFixMap,downKey,modifiers=(new Base({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1})).inject({option:{get:function(){return this.alt}},command:{get:function(){var agent=
paper&&paper.agent;return agent&&agent.mac?this.meta:this.control}}});DomEvent.add(document,{keydown:function(event){var key=getKey(event),agent=paper&&paper.agent;1<key.length||agent&&agent.chrome&&(event.altKey||agent.mac&&event.metaKey||!agent.mac&&event.ctrlKey)?handleKey(!0,key,charLookup[key]||(1<key.length?"":key),event):downKey=key},keypress:function(event){if(downKey){var key=getKey(event),code=event.charCode;code=32<=code?String.fromCharCode(code):1<key.length?"":key;key!==downKey&&(key=
code.toLowerCase());handleKey(!0,key,code,event);downKey=null}},keyup:function(event){var key=getKey(event);key in charMap&&handleKey(!1,key,charMap[key],event)}});DomEvent.add(window,{blur:function(event){for(var key in charMap)handleKey(!1,key,charMap[key],event)}});return{modifiers:modifiers,isDown:function(key){return!!keyMap[key]}}},MouseEvent=Event.extend({_class:"MouseEvent",initialize:function(type,event,point,target,delta){this.type=type;this.event=event;this.point=point;this.target=target;
this.delta=delta},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),ToolEvent=Event.extend({_class:"ToolEvent",_item:null,initialize:function(tool,type,event){this.tool=tool;this.type=type;this.event=event},_choosePoint:function(point,toolPoint){return point?point:toolPoint?toolPoint.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},
setPoint:function(point){this._point=point},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(lastPoint){this._lastPoint=lastPoint},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(downPoint){this._downPoint=downPoint},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(middlePoint){this._middlePoint=
middlePoint},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(delta){this._delta=delta},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(count){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=count},getItem:function(){if(!this._item){var result=this.tool._scope.project.hitTest(this.getPoint());if(result){result=result.item;
for(var parent=result._parent;/^(Group|CompoundPath)$/.test(parent._class);)result=parent,parent=parent._parent;this._item=result}}return this._item},setItem:function(item){this._item=item},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Tool=PaperScopeItem.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:"onMouseDown onMouseUp onMouseDrag onMouseMove onActivate onDeactivate onEditOptions onKeyDown onKeyUp".split(" "),
initialize:function(props){PaperScopeItem.call(this);this._downCount=this._moveCount=-1;this.set(props)},getMinDistance:function(){return this._minDistance},setMinDistance:function(minDistance){this._minDistance=minDistance;null!=minDistance&&null!=this._maxDistance&&minDistance>this._maxDistance&&(this._maxDistance=minDistance)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(maxDistance){this._maxDistance=maxDistance;null!=this._minDistance&&null!=maxDistance&&maxDistance<
this._minDistance&&(this._minDistance=maxDistance)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(distance){this._minDistance=this._maxDistance=distance},_handleMouseEvent:function(type,event,point,mouse){function update(minDistance,maxDistance){var pt=point,toolPoint=move?tool._point:tool._downPoint||pt;if(move){if(0<=tool._moveCount&&pt.equals(toolPoint))return!1;if(toolPoint&&(null!=minDistance||null!=maxDistance)){var vector=
pt.subtract(toolPoint),distance=vector.getLength();if(distance<(minDistance||0))return!1;maxDistance&&(pt=toolPoint.add(vector.normalize(Math.min(distance,maxDistance))))}tool._moveCount++}tool._point=pt;tool._lastPoint=toolPoint||pt;mouse.down&&(tool._moveCount=-1,tool._downPoint=pt,tool._downCount++);return!0}function emit(){responds&&(called=tool.emit(type,new ToolEvent(tool,type,event))||called)}paper=this._scope;mouse.drag&&!this.responds(type)&&(type="mousemove");var move=mouse.move||mouse.drag,
responds=this.responds(type),minDistance$jscomp$0=this.minDistance,maxDistance$jscomp$0=this.maxDistance,called=!1,tool=this;if(mouse.down)update(),emit();else if(mouse.up)update(null,maxDistance$jscomp$0),emit();else if(responds)for(;update(minDistance$jscomp$0,maxDistance$jscomp$0);)emit();return called}}),Tween=Base.extend(Emitter,{_class:"Tween",statics:{easings:{linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return.5>
t?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t}}},initialize:function Tween(object,
from,to,duration,easing,start){this.object=object;object=typeof easing;var isFunction="function"===object;this.type=isFunction?object:"string"===object?easing:"linear";this.easing=isFunction?easing:Tween.easings[this.type];this.duration=duration;this.running=!1;this._startTime=this._then=null;this._keys=(duration=from||to)?Object.keys(duration):[];this._parsedKeys=this._parseKeys(this._keys);this._from=duration&&this._getState(from);this._to=duration&&this._getState(to);!1!==start&&this.start()},
then:function(then){this._then=then;return this},start:function(){this._startTime=null;this.running=!0;return this},stop:function(){this.running=!1;return this},update:function(progress){if(this.running){1<progress&&(progress=1,this.running=!1);for(var factor=this.easing(progress),keys=this._keys,getValue=function(value){return"function"===typeof value?value(factor,progress):value},i=0,l=keys&&keys.length;i<l;i++){var key=keys[i],from=getValue(this._from[key]),to=getValue(this._to[key]);from=from&&
to&&from.__add&&to.__add?to.__subtract(from).__multiply(factor).__add(from):(to-from)*factor+from;this._setProperty(this._parsedKeys[key],from)}!this.running&&this._then&&this._then(this.object);this.responds("update")&&this.emit("update",new Base({progress:progress,factor:factor}))}return this},_events:{onUpdate:{}},_handleFrame:function(time){var startTime=this._startTime,progress=startTime?(time-startTime)/this.duration:0;startTime||(this._startTime=time);this.update(progress)},_getState:function(state){for(var keys=
this._keys,result={},i=0,l=keys.length;i<l;i++){var key=keys[i],path=this._parsedKeys[key],current=this._getProperty(path);if(state){var value=this._resolveValue(current,state[key]);this._setProperty(path,value);value=(value=this._getProperty(path))&&value.clone?value.clone():value;this._setProperty(path,current)}else value=current&&current.clone?current.clone():current;result[key]=value}return result},_resolveValue:function(current,value){if(value){if(Array.isArray(value)&&2===value.length){var operator=
value[0];return operator&&operator.match&&operator.match(/^[+\-\*\/]=/)?this._calculate(current,operator[0],value[1]):value}if("string"===typeof value&&(operator=value.match(/^[+\-*/]=(.*)/)))return operator=JSON.parse(operator[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": ')),this._calculate(current,value[0],operator)}return value},_calculate:function(left,operator,right){return paper.PaperScript.calculateBinary(left,operator,right)},_parseKeys:function(keys){for(var parsed={},i=0,l=keys.length;i<
l;i++){var key=keys[i],path=key.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");parsed[key]=path.split("/")}return parsed},_getProperty:function(path,offset){var obj=this.object,i=0;for(offset=path.length-(offset||0);i<offset&&obj;i++)obj=obj[path[i]];return obj},_setProperty:function(path,value){var dest=this._getProperty(path,1);dest&&(dest[path[path.length-1]]=value)}}),Http={request:function(options){var xhr=new self$jscomp$0.XMLHttpRequest;xhr.open((options.method||"get").toUpperCase(),
options.url,Base.pick(options.async,!0));options.mimeType&&xhr.overrideMimeType(options.mimeType);xhr.onload=function(){var status=xhr.status;if(0===status||200===status)options.onLoad&&options.onLoad.call(xhr,xhr.responseText);else xhr.onerror()};xhr.onerror=function(){var status=xhr.status,message='Could not load "'+options.url+'" (Status: '+status+")";if(options.onError)options.onError(message,status);else throw Error(message);};return xhr.send(null)}},CanvasProvider={canvases:[],getCanvas:function(width,
height){if(!window)return null;var clear=!0;"object"===typeof width&&(height=width.height,width=width.width);if(this.canvases.length)var canvas=this.canvases.pop();else canvas=document.createElement("canvas"),clear=!1;var ctx=canvas.getContext("2d");if(!ctx)throw Error("Canvas "+canvas+" is unable to provide a 2D context.");canvas.width===width&&canvas.height===height?clear&&ctx.clearRect(0,0,width+1,height+1):(canvas.width=width,canvas.height=height);ctx.save();return canvas},getContext:function(width,
height){return(width=this.getCanvas(width,height))?width.getContext("2d"):null},release:function(obj){(obj=obj&&obj.canvas?obj.canvas:obj)&&obj.getContext&&(obj.getContext("2d").restore(),this.canvases.push(obj))}},BlendMode=new function(){function setLum(r,g,b,l){l-=.2989*r+.587*g+.114*b;dr=r+l;dg=g+l;db=b+l;l=.2989*dr+.587*dg+.114*db;g=min(dr,dg,db);r=max(dr,dg,db);0>g&&(g=l-g,dr=l+(dr-l)*l/g,dg=l+(dg-l)*l/g,db=l+(db-l)*l/g);255<r&&(g=255-l,r-=l,dr=l+(dr-l)*g/r,dg=l+(dg-l)*g/r,db=l+(db-l)*g/r)}
function setSat(r,g,b,s){var col=[r,g,b],mx=max(r,g,b);b=min(r,g,b);b=b===r?0:b===g?1:2;mx=mx===r?0:mx===g?1:2;r=0===min(b,mx)?1===max(b,mx)?2:1:0;col[mx]>col[b]?(col[r]=(col[r]-col[b])*s/(col[mx]-col[b]),col[mx]=s):col[r]=col[mx]=0;col[b]=0;dr=col[0];dg=col[1];db=col[2]}var min=Math.min,max=Math.max,abs=Math.abs,sr,sg,sb,sa,br,bg,bb,ba,dr,dg,db,modes={multiply:function(){dr=br*sr/255;dg=bg*sg/255;db=bb*sb/255},screen:function(){dr=br+sr-br*sr/255;dg=bg+sg-bg*sg/255;db=bb+sb-bb*sb/255},overlay:function(){dr=
128>br?2*br*sr/255:255-2*(255-br)*(255-sr)/255;dg=128>bg?2*bg*sg/255:255-2*(255-bg)*(255-sg)/255;db=128>bb?2*bb*sb/255:255-2*(255-bb)*(255-sb)/255},"soft-light":function(){var t=sr*br/255;dr=t+br*(255-(255-br)*(255-sr)/255-t)/255;t=sg*bg/255;dg=t+bg*(255-(255-bg)*(255-sg)/255-t)/255;t=sb*bb/255;db=t+bb*(255-(255-bb)*(255-sb)/255-t)/255},"hard-light":function(){dr=128>sr?2*sr*br/255:255-2*(255-sr)*(255-br)/255;dg=128>sg?2*sg*bg/255:255-2*(255-sg)*(255-bg)/255;db=128>sb?2*sb*bb/255:255-2*(255-sb)*(255-
bb)/255},"color-dodge":function(){dr=0===br?0:255===sr?255:min(255,255*br/(255-sr));dg=0===bg?0:255===sg?255:min(255,255*bg/(255-sg));db=0===bb?0:255===sb?255:min(255,255*bb/(255-sb))},"color-burn":function(){dr=255===br?255:0===sr?0:max(0,255-255*(255-br)/sr);dg=255===bg?255:0===sg?0:max(0,255-255*(255-bg)/sg);db=255===bb?255:0===sb?0:max(0,255-255*(255-bb)/sb)},darken:function(){dr=br<sr?br:sr;dg=bg<sg?bg:sg;db=bb<sb?bb:sb},lighten:function(){dr=br>sr?br:sr;dg=bg>sg?bg:sg;db=bb>sb?bb:sb},difference:function(){dr=
br-sr;0>dr&&(dr=-dr);dg=bg-sg;0>dg&&(dg=-dg);db=bb-sb;0>db&&(db=-db)},exclusion:function(){dr=br+sr*(255-br-br)/255;dg=bg+sg*(255-bg-bg)/255;db=bb+sb*(255-bb-bb)/255},hue:function(){var JSCompiler_temp_const=sr,JSCompiler_temp_const$jscomp$0=sg,JSCompiler_temp_const$jscomp$1=sb;var JSCompiler_inline_result=br;var g=bg,b=bb;JSCompiler_inline_result=max(JSCompiler_inline_result,g,b)-min(JSCompiler_inline_result,g,b);setSat(JSCompiler_temp_const,JSCompiler_temp_const$jscomp$0,JSCompiler_temp_const$jscomp$1,
JSCompiler_inline_result);setLum(dr,dg,db,.2989*br+.587*bg+.114*bb)},saturation:function(){var JSCompiler_temp_const=br,JSCompiler_temp_const$jscomp$0=bg,JSCompiler_temp_const$jscomp$1=bb;var JSCompiler_inline_result=sr;var g=sg,b=sb;JSCompiler_inline_result=max(JSCompiler_inline_result,g,b)-min(JSCompiler_inline_result,g,b);setSat(JSCompiler_temp_const,JSCompiler_temp_const$jscomp$0,JSCompiler_temp_const$jscomp$1,JSCompiler_inline_result);setLum(dr,dg,db,.2989*br+.587*bg+.114*bb)},luminosity:function(){setLum(br,
bg,bb,.2989*sr+.587*sg+.114*sb)},color:function(){setLum(sr,sg,sb,.2989*br+.587*bg+.114*bb)},add:function(){dr=min(br+sr,255);dg=min(bg+sg,255);db=min(bb+sb,255)},subtract:function(){dr=max(br-sr,0);dg=max(bg-sg,0);db=max(bb-sb,0)},average:function(){dr=(br+sr)/2;dg=(bg+sg)/2;db=(bb+sb)/2},negation:function(){dr=255-abs(255-sr-br);dg=255-abs(255-sg-bg);db=255-abs(255-sb-bb)}},nativeModes=this.nativeModes=Base.each("source-over source-in source-out source-atop destination-over destination-in destination-out destination-atop lighter darker copy xor".split(" "),
function(mode){this[mode]=!0},{}),ctx=CanvasProvider.getContext(1,1);ctx&&(Base.each(modes,function(func,mode){func="darken"===mode;var ok=!1;ctx.save();try{ctx.fillStyle=func?"#300":"#a00",ctx.fillRect(0,0,1,1),ctx.globalCompositeOperation=mode,ctx.globalCompositeOperation===mode&&(ctx.fillStyle=func?"#a00":"#300",ctx.fillRect(0,0,1,1),ok=ctx.getImageData(0,0,1,1).data[0]!==func?170:51)}catch(e){}ctx.restore();nativeModes[mode]=ok}),CanvasProvider.release(ctx));this.process=function(mode,srcContext,
dstContext,alpha,offset){var srcCanvas=srcContext.canvas,normal="normal"===mode;if(normal||nativeModes[mode])dstContext.save(),dstContext.setTransform(1,0,0,1,0,0),dstContext.globalAlpha=alpha,normal||(dstContext.globalCompositeOperation=mode),dstContext.drawImage(srcCanvas,offset.x,offset.y),dstContext.restore();else if(mode=modes[mode]){normal=dstContext.getImageData(offset.x,offset.y,srcCanvas.width,srcCanvas.height);var dst=normal.data;srcContext=srcContext.getImageData(0,0,srcCanvas.width,srcCanvas.height).data;
srcCanvas=0;for(var l=dst.length;srcCanvas<l;srcCanvas+=4){sr=srcContext[srcCanvas];br=dst[srcCanvas];sg=srcContext[srcCanvas+1];bg=dst[srcCanvas+1];sb=srcContext[srcCanvas+2];bb=dst[srcCanvas+2];sa=srcContext[srcCanvas+3];ba=dst[srcCanvas+3];mode();var a1=sa*alpha/255,a2=1-a1;dst[srcCanvas]=a1*dr+a2*br;dst[srcCanvas+1]=a1*dg+a2*bg;dst[srcCanvas+2]=a1*db+a2*bb;dst[srcCanvas+3]=sa*alpha+a2*ba}dstContext.putImageData(normal,offset.x,offset.y)}}},SvgElement=new function(){function set(node,attributes,
formatter){for(var name in attributes){var value=attributes[name],namespace=attributeNamespace[name];"number"===typeof value&&formatter&&(value=formatter.number(value));namespace?node.setAttributeNS(namespace,name,value):node.setAttribute(name,value)}return node}var attributeNamespace={href:"http://www.w3.org/1999/xlink",xlink:"http://www.w3.org/2000/xmlns",xmlns:"http://www.w3.org/2000/xmlns/","xmlns:xlink":"http://www.w3.org/2000/xmlns/"};return{svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",
xlink:"http://www.w3.org/1999/xlink",create:function(tag,attributes,formatter){return set(document.createElementNS("http://www.w3.org/2000/svg",tag),attributes,formatter)},get:function(node,name){var namespace=attributeNamespace[name];node=namespace?node.getAttributeNS(namespace,name):node.getAttribute(name);return"null"===node?null:node},set:set}},SvgStyles=Base.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap",
"string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(item,value){return!value&&(item instanceof PathItem||item instanceof Shape||item instanceof TextItem)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",
{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(entry,key){var part=Base.capitalize(key),lookup=entry[2];this[key]={type:entry[1],property:key,attribute:entry[0],toSVG:lookup,fromSVG:lookup&&Base.each(lookup,function(value,name){this[value]=name},{}),exportFilter:entry[3],get:"get"+part,set:"set"+part}},{});new function(){function getTransform(matrix,coordinates,center){var attrs=new Base,trans=matrix.getTranslation();coordinates&&
(matrix.isInvertible()?(matrix=matrix._shiftless(),coordinates=matrix._inverseTransform(trans),trans=null):coordinates=new Point,attrs[center?"cx":"x"]=coordinates.x,attrs[center?"cy":"y"]=coordinates.y);if(!matrix.isIdentity())if(center=matrix.decompose()){matrix=[];coordinates=center.rotation;var scale=center.scaling;center=center.skewing;trans&&!trans.isZero()&&matrix.push("translate("+formatter.point(trans)+")");coordinates&&matrix.push("rotate("+formatter.number(coordinates)+")");Numerical.isZero(scale.x-
1)&&Numerical.isZero(scale.y-1)||matrix.push("scale("+formatter.point(scale)+")");center.x&&matrix.push("skewX("+formatter.number(center.x)+")");center.y&&matrix.push("skewY("+formatter.number(center.y)+")");attrs.transform=matrix.join(" ")}else attrs.transform="matrix("+matrix.getValues().join(",")+")";return attrs}function exportGroup(item,options){var attrs=getTransform(item._matrix);item=item._children;attrs=SvgElement.create("g",attrs,formatter);for(var i=0,l=item.length;i<l;i++){var child=item[i],
childNode=exportSVG(child,options);if(childNode)if(child.isClipMask()){var clip=SvgElement.create("clipPath");clip.appendChild(childNode);setDefinition(child,clip,"clip");SvgElement.set(attrs,{"clip-path":"url(#"+clip.id+")"})}else attrs.appendChild(childNode)}return attrs}function exportShape(item){var type=item._type,radius=item._radius,attrs=getTransform(item._matrix,!0,"rectangle"!==type);if("rectangle"===type){type="rect";var size=item._size;item=size.width;size=size.height;attrs.x-=item/2;attrs.y-=
size/2;attrs.width=item;attrs.height=size;radius.isZero()&&(radius=null)}radius&&("circle"===type?attrs.r=radius:(attrs.rx=radius.width,attrs.ry=radius.height));return SvgElement.create(type,attrs,formatter)}function applyStyle(item,node,isRoot){var attrs={},parent=!isRoot&&item.getParent(),style=[];null!=item._name&&(attrs.id=item._name);Base.each(SvgStyles,function(entry){var get=entry.get,type=entry.type,value=item[get]();if(entry.exportFilter?entry.exportFilter(item,value):!parent||!Base.equals(parent[get](),
value))if("color"===type&&null!=value&&(get=value.getAlpha(),1>get&&(attrs[entry.attribute+"-opacity"]=get)),"style"===type)style.push(entry.attribute+": "+value);else{get=entry.attribute;if(null==value)value="none";else if("color"===type)if(value.gradient){entry=getDefinition(value,"color");if(!entry){var gradient=value.getGradient();entry=gradient._radial;type=value.getOrigin();var destination=value.getDestination();if(entry){if(type={cx:type.x,cy:type.y,r:type.getDistance(destination)},destination=
value.getHighlight())type.fx=destination.x,type.fy=destination.y}else type={x1:type.x,y1:type.y,x2:destination.x,y2:destination.y};type.gradientUnits="userSpaceOnUse";entry=SvgElement.create((entry?"radial":"linear")+"Gradient",type,formatter);gradient=gradient._stops;destination=0;for(var l=gradient.length;destination<l;destination++){type=gradient[destination];var stopColor=type._color,alpha=stopColor.getAlpha();type=type._offset;type={offset:null==type?destination/(l-1):type};stopColor&&(type["stop-color"]=
stopColor.toCSS(!0));1>alpha&&(type["stop-opacity"]=alpha);entry.appendChild(SvgElement.create("stop",type,formatter))}setDefinition(value,entry,"color")}value="url(#"+entry.id+")"}else value=value.toCSS(!0);else value="array"===type?value.join(","):"lookup"===type?entry.toSVG[value]:value;attrs[get]=value}});style.length&&(attrs.style=style.join(";"));1===attrs.opacity&&delete attrs.opacity;item._visible||(attrs.visibility="hidden");return SvgElement.set(node,attrs,formatter)}function getDefinition(item,
type){definitions||(definitions={ids:{},svgs:{}});return item&&definitions.svgs[type+"-"+(item._id||item.__id||(item.__id=UID.get("svg")))]}function setDefinition(item,node,type){definitions||getDefinition();var typeId=definitions.ids[type]=(definitions.ids[type]||0)+1;node.id=type+"-"+typeId;definitions.svgs[type+"-"+(item._id||item.__id)]=node}function exportDefinitions(node,options){var svg=node,defs=null;if(definitions){svg="svg"===node.nodeName.toLowerCase()&&node;for(var i in definitions.svgs)defs||
(svg||(svg=SvgElement.create("svg"),svg.appendChild(node)),defs=svg.insertBefore(SvgElement.create("defs"),svg.firstChild)),defs.appendChild(definitions.svgs[i]);definitions=null}return options.asString?(new self$jscomp$0.XMLSerializer).serializeToString(svg):svg}function exportSVG(item,options,isRoot){var exporter=exporters[item._class];if(exporter=exporter&&exporter(item,options)){var onExport=options.onExport;onExport&&(exporter=onExport(item,exporter,options)||exporter);(options=JSON.stringify(item._data))&&
"{}"!==options&&"null"!==options&&exporter.setAttribute("data-paper-data",options)}return exporter&&applyStyle(item,exporter,isRoot)}function setOptions(options){options||(options={});formatter=new Formatter(options.precision);return options}var formatter,exporters={Group:exportGroup,Layer:exportGroup,Raster:function(item,options){var attrs=getTransform(item._matrix,!0),size=item.getSize(),image=item.getImage();attrs.x-=size.width/2;attrs.y-=size.height/2;attrs.width=size.width;attrs.height=size.height;
attrs.href=0==options.embedImages&&image&&image.src||item.toDataURL();return SvgElement.create("image",attrs,formatter)},Path:function(item,options){var matchShapes=options.matchShapes;if(matchShapes){var shape=item.toShape(!1);if(shape)return exportShape(shape,options)}var segments=item._segments,length=segments.length;shape=getTransform(item._matrix);if(matchShapes&&2<=length&&!item.hasHandles())if(2<length){matchShapes=item._closed?"polygon":"polyline";item=[];for(options=0;options<length;options++)item.push(formatter.point(segments[options]._point));
shape.points=item.join(" ")}else matchShapes="line",length=segments[0]._point,segments=segments[1]._point,shape.set({x1:length.x,y1:length.y,x2:segments.x,y2:segments.y});else matchShapes="path",shape.d=item.getPathData(null,options.precision);return SvgElement.create(matchShapes,shape,formatter)},Shape:exportShape,CompoundPath:function(item,options){var attrs=getTransform(item._matrix);if(item=item.getPathData(null,options.precision))attrs.d=item;return SvgElement.create("path",attrs,formatter)},
SymbolItem:function(item,options){var attrs=getTransform(item._matrix,!0);item=item._definition;var node=getDefinition(item,"symbol"),definitionItem=item._item,bounds=definitionItem.getStrokeBounds();node||(node=SvgElement.create("symbol",{viewBox:formatter.rectangle(bounds)}),node.appendChild(exportSVG(definitionItem,options)),setDefinition(item,node,"symbol"));attrs.href="#"+node.id;attrs.x+=bounds.x;attrs.y+=bounds.y;attrs.width=bounds.width;attrs.height=bounds.height;attrs.overflow="visible";
return SvgElement.create("use",attrs,formatter)},PointText:function(item){var node=SvgElement.create("text",getTransform(item._matrix,!0),formatter);node.textContent=item._content;return node}},definitions;Item.inject({exportSVG:function(options){options=setOptions(options);return exportDefinitions(exportSVG(this,options,!0),options)}});Project.inject({exportSVG:function(options){options=setOptions(options);var children=this._children,view=this.getView(),bounds=Base.pick(options.bounds,"view"),mx=
options.matrix||"view"===bounds&&view._matrix;mx=mx&&Matrix.read([mx]);view="view"===bounds?new Rectangle([0,0],view.getViewSize()):"content"===bounds?Item._getBounds(children,mx,{stroke:!0}).rect:Rectangle.read([bounds],0,{readNull:!0});bounds={version:"1.1",xmlns:SvgElement.svg,"xmlns:xlink":SvgElement.xlink};view&&(bounds.width=view.width,bounds.height=view.height,view.x||0===view.x||view.y||0===view.y)&&(bounds.viewBox=formatter.rectangle(view));bounds=view=SvgElement.create("svg",bounds,formatter);
mx&&!mx.isIdentity()&&(bounds=view.appendChild(SvgElement.create("g",getTransform(mx),formatter)));mx=0;for(var l=children.length;mx<l;mx++)bounds.appendChild(exportSVG(children[mx],options,!0));return exportDefinitions(view,options)}})};new function(){function getValue(node,name,isString,allowNull,allowPercent,defaultValue){node=SvgElement.get(node,name)||defaultValue;isString=null==node?allowNull?null:isString?"":0:isString?node:parseFloat(node);return/%\s*$/.test(node)?isString/100*(allowPercent?
1:rootSize[/x|^width/.test(name)?"width":"height"]):isString}function getPoint(node,x,y,allowNull,allowPercent,defaultX,defaultY){x=getValue(node,x||"x",!1,allowNull,allowPercent,defaultX);y=getValue(node,y||"y",!1,allowNull,allowPercent,defaultY);return!allowNull||null!=x&&null!=y?new Point(x,y):null}function getSize(node,w,h,allowNull,allowPercent){w=getValue(node,w||"width",!1,allowNull,allowPercent);h=getValue(node,h||"height",!1,allowNull,allowPercent);return!allowNull||null!=w&&null!=h?new Size(w,
h):null}function convertValue(value,type,lookup){return"none"===value?null:"number"===type?parseFloat(value):"array"===type?value?value.split(/[\s,]+/g).map(parseFloat):[]:"color"===type?getDefinition(value)||value:"lookup"===type?lookup[value]:value}function importGroup(node,type,options,isRoot){var nodes=node.childNodes,isClip="clippath"===type;type="defs"===type;var item=new Group,project=item._project,currentStyle=project._currentStyle,children=[];isClip||type||(item=applyAttributes(item,node,
isRoot),project._currentStyle=item._style.clone());if(isRoot)for(var defs=node.querySelectorAll("defs"),i=0,l=defs.length;i<l;i++)importNode(defs[i],options,!1);i=0;for(l=nodes.length;i<l;i++){defs=nodes[i];var child;1!==defs.nodeType||/^defs$/i.test(defs.nodeName)||!(child=importNode(defs,options,!1))||child instanceof SymbolDefinition||children.push(child)}item.addChildren(children);isClip&&(item=applyAttributes(item.reduce(),node,isRoot));project._currentStyle=currentStyle;if(isClip||type)item.remove(),
item=null;return item}function importPoly(node,type){node=node.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);for(var points=[],i=0,l=node.length;i<l;i+=2)points.push(new Point(parseFloat(node[i]),parseFloat(node[i+1])));node=new Path(points);"polygon"===type&&node.closePath();return node}function importGradient(node,type){var id=(getValue(node,"href",!0)||"").substring(1);type="radialgradient"===type;if(id)id=definitions[id].getGradient(),id._radial^type&&(id=id.clone(),
id._radial=type);else{id=node.childNodes;for(var stops=[],i=0,l=id.length;i<l;i++){var child=id[i];1===child.nodeType&&stops.push(applyAttributes(new GradientStop,child))}id=new Gradient(stops,type)}stops="userSpaceOnUse"!==getValue(node,"gradientUnits",!0);if(type){type=getPoint(node,"cx","cy",!1,stops,"50%","50%");i=type.add(getValue(node,"r",!1,!1,stops,"50%"),0);var highlight=getPoint(node,"fx","fy",!0,stops)}else type=getPoint(node,"x1","y1",!1,stops,"0%","0%"),i=getPoint(node,"x2","y2",!1,stops,
"100%","0%");applyAttributes(new Color(id,type,i,highlight),node)._scaleToBounds=stops;return null}function applyTransform(item,value,name,node){if(item.transform){value=(node.getAttribute(name)||"").split(/\)\s*/g);name=new Matrix;node=0;for(var l=value.length;node<l;node++){var transform=value[node];if(!transform)break;var parts=transform.split(/\(\s*/);transform=parts[0];parts=parts[1].split(/[\s,]+/g);for(var j=0,m=parts.length;j<m;j++)parts[j]=parseFloat(parts[j]);switch(transform){case "matrix":name.append(new Matrix(parts[0],
parts[1],parts[2],parts[3],parts[4],parts[5]));break;case "rotate":name.rotate(parts[0],parts[1]||0,parts[2]||0);break;case "translate":name.translate(parts[0],parts[1]||0);break;case "scale":name.scale(parts);break;case "skewX":name.skew(parts[0],0);break;case "skewY":name.skew(0,parts[0])}}item.transform(name)}}function applyOpacity(item,value,name){name="fill-opacity"===name?"getFillColor":"getStrokeColor";(item=item[name]&&item[name]())&&item.setAlpha(parseFloat(value))}function getAttribute(node,
name,styles){var attr=node.attributes[name];attr=attr&&attr.value;!attr&&node.style&&(name=Base.camelize(name),(attr=node.style[name])||styles.node[name]===styles.parent[name]||(attr=styles.node[name]));return attr?"none"===attr?null:attr:undefined}function applyAttributes(item,node,isRoot){var parent=node.parentNode,styles={node:DomElement.getStyles(node)||{},parent:!isRoot&&!/^defs$/i.test(parent.tagName)&&DomElement.getStyles(parent)||{}};Base.each(attributes,function(apply,name){var value=getAttribute(node,
name,styles);item=undefined!==value&&apply(item,value,name,node,styles)||item});return item}function getDefinition(value){(value=(value=(value=value&&value.match(/\((?:["'#]*)([^"')]+)/))&&value[1])&&definitions[window?value.replace(window.location.href.split("#")[0]+"#",""):value])&&value._scaleToBounds&&(value=value.clone(),value._scaleToBounds=!0);return value}function importNode(node,options,isRoot){var type=node.nodeName.toLowerCase(),isElement="#document"!==type,body=document.body;if(isRoot&&
isElement){rootSize=paper.getView().getSize();rootSize=getSize(node,null,null,!0)||rootSize;var container=SvgElement.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"});var parent=node.parentNode;var next=node.nextSibling;container.appendChild(node);body.appendChild(container)}var settings=paper.settings,applyMatrix=settings.applyMatrix,insertItems=settings.insertItems;settings.applyMatrix=!1;settings.insertItems=!1;var importer=importers[type];type=importer&&importer(node,type,options,
isRoot)||null;settings.insertItems=insertItems;settings.applyMatrix=applyMatrix;type&&(!isElement||type instanceof Group||(type=applyAttributes(type,node,isRoot)),settings=options.onImport,isElement=isElement&&node.getAttribute("data-paper-data"),settings&&(type=settings(node,type,options)||type),options.expandShapes&&type instanceof Shape&&(type.remove(),type=type.toPath()),isElement&&(type._data=JSON.parse(isElement)));container&&(body.removeChild(container),parent&&(next?parent.insertBefore(node,
next):parent.appendChild(node)));isRoot&&(definitions={},type&&Base.pick(options.applyMatrix,applyMatrix)&&type.matrix.apply(!0,!0));return type}function importSVG(source,options,owner){function onLoad(svg){try{var node="object"===typeof svg?svg:(new self$jscomp$0.DOMParser).parseFromString(svg,"image/svg+xml");if(!node.nodeName)throw Error("Unsupported SVG source: "+source);paper=scope;item=importNode(node,options,!0);options&&!1===options.insert||owner._insertItem(undefined,item);var onLoad=options.onLoad;
onLoad&&onLoad(item,svg)}catch(e){onError(e)}}function onError(message,status){var onError=options.onError;if(onError)onError(message,status);else throw Error(message);}if(!source)return null;options="function"===typeof options?{onLoad:options}:options||{};var scope=paper,item=null;if("string"!==typeof source||/^.*</.test(source)){if("undefined"!==typeof File&&source instanceof File){var reader=new FileReader;reader.onload=function(){onLoad(reader.result)};reader.onerror=function(){onError(reader.error)};
return reader.readAsText(source)}onLoad(source)}else{var node$jscomp$0=document.getElementById(source);node$jscomp$0?onLoad(node$jscomp$0):Http.request({url:source,async:!0,onLoad:onLoad,onError:onError})}return item}var definitions={},rootSize,importers={"#document":function(node,type,options,isRoot){node=node.childNodes;type=0;for(var l=node.length;type<l;type++){var child=node[type];if(1===child.nodeType)return importNode(child,options,isRoot)}},g:importGroup,svg:importGroup,clippath:importGroup,
polygon:importPoly,polyline:importPoly,path:function(node){return PathItem.create(node.getAttribute("d"))},lineargradient:importGradient,radialgradient:importGradient,image:function(node){var raster=new Raster(getValue(node,"href",!0));raster.on("load",function(){var size=getSize(node);this.setSize(size);size=getPoint(node).add(size.divide(2));this._matrix.append((new Matrix).translate(size))});return raster},symbol:function(node,type,options,isRoot){return new SymbolDefinition(importGroup(node,type,
options,isRoot),!0)},defs:importGroup,use:function(node){var id=(getValue(node,"href",!0)||"").substring(1);id=definitions[id];node=getPoint(node);return id?id instanceof SymbolDefinition?id.place(node):id.clone().translate(node):null},circle:function(node){return new Shape.Circle(getPoint(node,"cx","cy"),getValue(node,"r"))},ellipse:function(node){return new Shape.Ellipse({center:getPoint(node,"cx","cy"),radius:getSize(node,"rx","ry")})},rect:function(node){return new Shape.Rectangle(new Rectangle(getPoint(node),
getSize(node)),getSize(node,"rx","ry"))},line:function(node){return new Path.Line(getPoint(node,"x1","y1"),getPoint(node,"x2","y2"))},text:function(node){var text=new PointText(getPoint(node).add(getPoint(node,"dx","dy")));text.setContent(node.textContent.trim()||"");return text},switch:importGroup},attributes=Base.set(Base.each(SvgStyles,function(entry){this[entry.attribute]=function(item,value){item[entry.set]&&(item[entry.set](convertValue(value,entry.type,entry.fromSVG)),"color"===entry.type&&
(value=item[entry.get]())&&value._scaleToBounds&&(item=item.getBounds(),value.transform((new Matrix).translate(item.getPoint()).scale(item.getSize()))))}},{}),{id:function(item,value){definitions[value]=item;item.setName&&item.setName(value)},"clip-path":function(item,value){if(value=getDefinition(value))if(value=value.clone(),value.setClipMask(!0),item instanceof Group)item.insertChild(0,value);else return new Group(value,item)},gradientTransform:applyTransform,transform:applyTransform,"fill-opacity":applyOpacity,
"stroke-opacity":applyOpacity,visibility:function(item,value){item.setVisible&&item.setVisible("visible"===value)},display:function(item,value){item.setVisible&&item.setVisible(null!==value)},"stop-color":function(item,value){item.setColor&&item.setColor(value)},"stop-opacity":function(item,value){item._color&&item._color.setAlpha(parseFloat(value))},offset:function(item,value){if(item.setOffset){var percent=value.match(/(.*)%$/);item.setOffset(percent?percent[1]/100:parseFloat(value))}},viewBox:function(item,
value,name,node,styles){value=new Rectangle(convertValue(value,"array"));name=getSize(node,null,null,!0);if(item instanceof Group){var group=name?name.divide(value.getSize()):1;var matrix=(new Matrix).scale(group).translate(value.getPoint().negate());group=item}else item instanceof SymbolDefinition&&(name&&value.setSize(name),group=item._item);group&&("visible"!==getAttribute(node,"overflow",styles)&&(item=new Shape.Rectangle(value),item.setClipMask(!0),group.addChild(item)),matrix&&group.transform(matrix))}});
Item.inject({importSVG:function(node,options){return importSVG(node,options,this)}});Project.inject({importSVG:function(node,options){this.activate();return importSVG(node,options,this)}})};Base.exports.PaperScript=function(){function parse(code,options){return(global.acorn||acorn).parse(code,options)}function __$__(left,operator,right){var handler=binaryOperators[operator];if(left&&left[handler])return left=left[handler](right),"!\x3d"===operator?!left:left;switch(operator){case "+":return left+
right;case "-":return left-right;case "*":return left*right;case "/":return left/right;case "%":return left%right;case "\x3d\x3d":return left==right;case "!\x3d":return left!=right}}function $__(operator,value){var handler=unaryOperators[operator];if(value&&value[handler])return value[handler]();switch(operator){case "+":return+value;case "-":return-value}}function compile(code,options){function getOffset(offset){for(var i=0,l=insertions.length;i<l;i++){var insertion=insertions[i];if(insertion[0]>=
offset)break;offset+=insertion[1]}return offset}function getCode(node){return code.substring(getOffset(node.range[0]),getOffset(node.range[1]))}function getBetween(left,right){return code.substring(getOffset(left.range[1]),getOffset(right.range[0]))}function replaceCode(node,str){var start=getOffset(node.range[0]);node=getOffset(node.range[1]);for(var insert=0,i=insertions.length-1;0<=i;i--)if(start>insertions[i][0]){insert=i+1;break}insertions.splice(insert,0,[start,str.length-node+start]);code=
code.substring(0,start)+str+code.substring(node)}function walkAST(node,parent){if(node){for(var key in node)if("range"!==key&&"loc"!==key){var value=node[key];if(Array.isArray(value))for(var i=0,l=value.length;i<l;i++)walkAST(value[i],node);else value&&"object"===typeof value&&walkAST(value,node)}switch(node.type){case "UnaryExpression":node.operator in unaryOperators&&"Literal"!==node.argument.type&&(key=getCode(node.argument),replaceCode(node,'$__("'+node.operator+'", '+key+")"));break;case "BinaryExpression":node.operator in
binaryOperators&&"Literal"!==node.left.type&&(parent=getCode(node.left),key=getCode(node.right),value=getBetween(node.left,node.right),i=node.operator,replaceCode(node,"__$__("+parent+","+value.replace(new RegExp("\\"+i),'"'+i+'"')+", "+key+")"));break;case "UpdateExpression":case "AssignmentExpression":value=parent&&parent.type;if(!("ForStatement"===value||"BinaryExpression"===value&&/^[=!<>]/.test(parent.operator)||"MemberExpression"===value&&parent.computed))if("UpdateExpression"===node.type){key=
getCode(node.argument);i="__$__("+key+', "'+node.operator[0]+'", 1)';l=key+" \x3d "+i;if(node.prefix)l="("+l+")";else if("AssignmentExpression"===value||"VariableDeclarator"===value||"BinaryExpression"===value)getCode(parent.left||parent.id)===key&&(l=i),l=key+"; "+l;replaceCode(node,l)}else/^.=$/.test(node.operator)&&"Literal"!==node.left.type&&(parent=getCode(node.left),key=getCode(node.right),i=parent+" \x3d __$__("+parent+', "'+node.operator[0]+'", '+key+")",replaceCode(node,/^\(.*\)$/.test(getCode(node))?
"("+i+")":i));break;case "ExportDefaultDeclaration":replaceCode({range:[node.start,node.declaration.start]},"module.exports \x3d ");break;case "ExportNamedDeclaration":if(parent=node.declaration,key=node.specifiers,parent){if(key=parent.declarations)key.forEach(function(dec){replaceCode(dec,"module.exports."+getCode(dec))}),replaceCode({range:[node.start,parent.start+parent.kind.length]},"")}else key&&(parent=key.map(function(specifier){specifier=getCode(specifier);return"module.exports."+specifier+
" \x3d "+specifier+"; "}).join(""))&&replaceCode(node,parent)}}}function encodeVLQ(value){var res="";for(value=(Math.abs(value)<<1)+(0>value?1:0);value||!res;){var next=value&31;(value>>=5)&&(next|=32);res+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[next]}return res}if(!code)return"";options=options||{};var insertions=[],url=options.url||"",agent=paper.agent,version=agent.versionNumber,offsetCode=!1,sourceMaps=options.sourceMaps,source=options.source||code,lineBreaks=/\r\n|\n|\r/mg;
options=options.offset||0;if(sourceMaps&&(agent.chrome&&30<=version||agent.webkit&&537.76<=version||agent.firefox&&23<=version||agent.node)){agent.node?options-=2:window&&url&&!window.location.href.indexOf(url)&&(offsetCode=document.getElementsByTagName("html")[0].innerHTML,options=offsetCode.substr(0,offsetCode.indexOf(code)+1).match(lineBreaks).length+1);offsetCode=0<options&&!(agent.chrome&&36<=version||agent.safari&&600<=version||agent.firefox&&40<=version||agent.node);agent=["AA"+encodeVLQ(offsetCode?
0:options)+"A"];agent.length=(code.match(lineBreaks)||[]).length+1+(offsetCode?options:0);var map={version:3,file:url,names:[],mappings:agent.join(";AACA"),sourceRoot:"",sources:[url],sourcesContent:[source]}}walkAST(parse(code,{ranges:!0,preserveParens:!0,sourceType:"module"}));map&&(offsetCode&&(code=Array(options+1).join("\n")+code),/^(inline|both)$/.test(sourceMaps)&&(code+="\n//# sourceMappingURL\x3ddata:application/json;base64,"+self$jscomp$0.btoa(unescape(encodeURIComponent(JSON.stringify(map))))),
code+="\n//# sourceURL\x3d"+(url||"paperscript"));return{url:url,source:source,code:code,map:map}}function execute(code,scope$jscomp$0,options){function expose(scope,hidden){for(var key in scope)!hidden&&/^_/.test(key)||!(new RegExp("([\\b\\s\\W]|^)"+key.replace(/\$/g,"\\$")+"\\b")).test(code)||(params.push(key),args.push(scope[key]))}paper=scope$jscomp$0;var view=scope$jscomp$0.getView(),tool=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(code)&&!/\bnew\s+Tool\b/.test(code)?new Tool:
null,toolHandlers=tool?tool._events:[],handlers=["onFrame","onResize"].concat(toolHandlers),params=[],args=[];code=("object"===typeof code?code:compile(code,options)).code;expose({__$__:__$__,$__:$__,paper:scope$jscomp$0,tool:tool},!0);expose(scope$jscomp$0);code="var module \x3d { exports: {} }; "+code;(options=Base.each(handlers,function(key){(new RegExp("\\s+"+key+"\\b")).test(code)&&(params.push(key),this.push("module.exports."+key+" \x3d "+key+";"))},[]).join("\n"))&&(code+="\n"+options);code+=
"\nreturn module.exports;";var func=paper.agent;document&&(func.chrome||func.firefox&&40>func.versionNumber)?(options=document.createElement("script"),handlers=document.head||document.getElementsByTagName("head")[0],func.firefox&&(code="\n"+code),options.appendChild(document.createTextNode("document.__paperscript__ \x3d function("+params+") {"+code+"\n}")),handlers.appendChild(options),func=document.__paperscript__,delete document.__paperscript__,handlers.removeChild(options)):func=Function(params,
code);var obj=(options=func&&func.apply(scope$jscomp$0,args))||{};Base.each(toolHandlers,function(key){var value=obj[key];value&&(tool[key]=value)});view&&(obj.onResize&&view.setOnResize(obj.onResize),view.emit("resize",{size:view.size,delta:new Point}),obj.onFrame&&view.setOnFrame(obj.onFrame),view.requestUpdate());return options}function loadScript(script){if(/^text\/(?:x-|)paperscript$/.test(script.type)&&"true"!==PaperScope.getAttribute(script,"ignore")){var canvasId=PaperScope.getAttribute(script,
"canvas"),canvas=document.getElementById(canvasId),src=script.src||script.getAttribute("data-src"),async=PaperScope.hasAttribute(script,"async");if(!canvas)throw Error('Unable to find canvas with id "'+canvasId+'"');var scope=PaperScope.get(canvas.getAttribute("data-paper-scope"))||(new PaperScope).setup(canvas);canvas.setAttribute("data-paper-scope",scope._id);src?Http.request({url:src,async:async,mimeType:"text/plain",onLoad:function(code){execute(code,scope,src)}}):execute(script.innerHTML,scope,
script.baseURI);script.setAttribute("data-paper-ignore","true");return scope}}function loadAll(){Base.each(document&&document.getElementsByTagName("script"),loadScript)}var global=this,acorn=global.acorn;if(!acorn&&"undefined"!==typeof require)try{acorn=require("module$node_modules$acorn$dist$acorn")}catch(e){}if(!acorn){var exports$jscomp$0,module;acorn=exports$jscomp$0=module={};(function(root,mod){if("object"==typeof exports$jscomp$0&&"object"==typeof module)return mod(exports$jscomp$0);if("function"==
typeof define&&define.amd)return define(["exports"],mod);mod(root.acorn||(root.acorn={}))})(this,function(exports){function setOptions(opts){options=opts||{};for(var opt in defaultOptions)Object.prototype.hasOwnProperty.call(options,opt)||(options[opt]=defaultOptions[opt]);sourceFile=options.sourceFile||null}function raise(pos,message){var loc=getLineInfo(input$jscomp$0,pos);message+=" ("+loc.line+":"+loc.column+")";message=new SyntaxError(message);message.pos=pos;message.loc=loc;message.raisedAt=
tokPos;throw message;}function makePredicate(words){function compareTo(arr){if(1==arr.length)return f+="return str \x3d\x3d\x3d "+JSON.stringify(arr[0])+";";f+="switch(str){";for(var i=0;i<arr.length;++i)f+="case "+JSON.stringify(arr[i])+":";f+="return true}return false;"}words=words.split(" ");var f="",cats=[],i$jscomp$0=0;a:for(;i$jscomp$0<words.length;++i$jscomp$0){for(var j=0;j<cats.length;++j)if(cats[j][0].length==words[i$jscomp$0].length){cats[j].push(words[i$jscomp$0]);continue a}cats.push([words[i$jscomp$0]])}if(3<
cats.length){cats.sort(function(a,b){return b.length-a.length});f+="switch(str.length){";for(i$jscomp$0=0;i$jscomp$0<cats.length;++i$jscomp$0)words=cats[i$jscomp$0],f+="case "+words[0].length+":",compareTo(words);f+="}"}else compareTo(words);return new Function("str",f)}function line_loc_t(){this.line=tokCurLine;this.column=tokPos-tokLineStart}function finishToken(type,val){tokEnd=tokPos;options.locations&&(tokEndLoc=new line_loc_t);tokType=type;skipSpace();tokVal=val;tokRegexpAllowed=type.beforeExpr}
function skipLineComment(){for(var start=tokPos,startLoc=options.onComment&&options.locations&&new line_loc_t,ch=input$jscomp$0.charCodeAt(tokPos+=2);tokPos<inputLen&&10!==ch&&13!==ch&&8232!==ch&&8233!==ch;)++tokPos,ch=input$jscomp$0.charCodeAt(tokPos);if(options.onComment)options.onComment(!1,input$jscomp$0.slice(start+2,tokPos),start,tokPos,startLoc,options.locations&&new line_loc_t)}function skipSpace(){for(;tokPos<inputLen;){var ch=input$jscomp$0.charCodeAt(tokPos);if(32===ch)++tokPos;else if(13===
ch)++tokPos,ch=input$jscomp$0.charCodeAt(tokPos),10===ch&&++tokPos,options.locations&&(++tokCurLine,tokLineStart=tokPos);else if(10===ch||8232===ch||8233===ch)++tokPos,options.locations&&(++tokCurLine,tokLineStart=tokPos);else if(8<ch&&14>ch)++tokPos;else if(47===ch)if(ch=input$jscomp$0.charCodeAt(tokPos+1),42===ch){ch=void 0;var startLoc=options.onComment&&options.locations&&new line_loc_t,start=tokPos,end=input$jscomp$0.indexOf("*/",tokPos+=2);-1===end&&raise(tokPos-2,"Unterminated comment");tokPos=
end+2;if(options.locations)for(lineBreak.lastIndex=start;(ch=lineBreak.exec(input$jscomp$0))&&ch.index<tokPos;)++tokCurLine,tokLineStart=ch.index+ch[0].length;if(options.onComment)options.onComment(!0,input$jscomp$0.slice(start+2,end),start,tokPos,startLoc,options.locations&&new line_loc_t)}else if(47===ch)skipLineComment();else break;else if(160===ch)++tokPos;else if(5760<=ch&&nonASCIIwhitespace.test(String.fromCharCode(ch)))++tokPos;else break}}function getTokenFromCode(code){switch(code){case 46:return code=
input$jscomp$0.charCodeAt(tokPos+1),48<=code&&57>=code?code=readNumber(!0):(++tokPos,code=finishToken(_dot)),code;case 40:return++tokPos,finishToken(_parenL);case 41:return++tokPos,finishToken(_parenR);case 59:return++tokPos,finishToken(_semi);case 44:return++tokPos,finishToken(_comma);case 91:return++tokPos,finishToken(_bracketL);case 93:return++tokPos,finishToken(_bracketR);case 123:return++tokPos,finishToken(_braceL);case 125:return++tokPos,finishToken(_braceR);case 58:return++tokPos,finishToken(_colon);
case 63:return++tokPos,finishToken(_question);case 48:if(code=input$jscomp$0.charCodeAt(tokPos+1),120===code||88===code)return tokPos+=2,code=readInt(16),null==code&&raise(tokStart+2,"Expected hexadecimal number"),isIdentifierStart(input$jscomp$0.charCodeAt(tokPos))&&raise(tokPos,"Identifier directly after number"),finishToken(_num,code);case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return readNumber(!1);case 34:case 39:a:{tokPos++;for(var out="";;){tokPos>=inputLen&&raise(tokStart,
"Unterminated string constant");var ch=input$jscomp$0.charCodeAt(tokPos);if(ch===code){++tokPos;code=finishToken(_string,out);break a}if(92===ch){ch=input$jscomp$0.charCodeAt(++tokPos);var octal=/^[0-7]+/.exec(input$jscomp$0.slice(tokPos,tokPos+3));for(octal&&(octal=octal[0]);octal&&255<parseInt(octal,8);)octal=octal.slice(0,-1);"0"===octal&&(octal=null);++tokPos;if(octal)strict&&raise(tokPos-2,"Octal literal in strict mode"),out+=String.fromCharCode(parseInt(octal,8)),tokPos+=octal.length-1;else switch(ch){case 110:out+=
"\n";break;case 114:out+="\r";break;case 120:out+=String.fromCharCode(readHexChar(2));break;case 117:out+=String.fromCharCode(readHexChar(4));break;case 85:out+=String.fromCharCode(readHexChar(8));break;case 116:out+="\t";break;case 98:out+="\b";break;case 118:out+="\x0B";break;case 102:out+="\f";break;case 48:out+="\x00";break;case 13:10===input$jscomp$0.charCodeAt(tokPos)&&++tokPos;case 10:options.locations&&(tokLineStart=tokPos,++tokCurLine);break;default:out+=String.fromCharCode(ch)}}else 13!==
ch&&10!==ch&&8232!==ch&&8233!==ch||raise(tokStart,"Unterminated string constant"),out+=String.fromCharCode(ch),++tokPos}}return code;case 47:return code=input$jscomp$0.charCodeAt(tokPos+1),tokRegexpAllowed?(++tokPos,code=readRegexp()):code=61===code?finishOp(_assign,2):finishOp(_slash,1),code;case 37:case 42:return code=61===input$jscomp$0.charCodeAt(tokPos+1)?finishOp(_assign,2):finishOp(_multiplyModulo,1),code;case 124:case 38:return out=input$jscomp$0.charCodeAt(tokPos+1),code=out===code?finishOp(124===
code?_logicalOR:_logicalAND,2):61===out?finishOp(_assign,2):finishOp(124===code?_bitwiseOR:_bitwiseAND,1),code;case 94:return code=61===input$jscomp$0.charCodeAt(tokPos+1)?finishOp(_assign,2):finishOp(_bitwiseXOR,1),code;case 43:case 45:return out=input$jscomp$0.charCodeAt(tokPos+1),out===code?45==out&&62==input$jscomp$0.charCodeAt(tokPos+2)&&newline.test(input$jscomp$0.slice(lastEnd,tokPos))?(tokPos+=3,skipLineComment(),skipSpace(),code=readToken()):code=finishOp(_incDec,2):code=61===out?finishOp(_assign,
2):finishOp(_plusMin,1),code;case 60:case 62:return out=input$jscomp$0.charCodeAt(tokPos+1),ch=1,out===code?(ch=62===code&&62===input$jscomp$0.charCodeAt(tokPos+2)?3:2,code=61===input$jscomp$0.charCodeAt(tokPos+ch)?finishOp(_assign,ch+1):finishOp(_bitShift,ch)):33==out&&60==code&&45==input$jscomp$0.charCodeAt(tokPos+2)&&45==input$jscomp$0.charCodeAt(tokPos+3)?(tokPos+=4,skipLineComment(),skipSpace(),code=readToken()):(61===out&&(ch=61===input$jscomp$0.charCodeAt(tokPos+2)?3:2),code=finishOp(_relational,
ch)),code;case 61:case 33:return code=61===input$jscomp$0.charCodeAt(tokPos+1)?finishOp(_equality,61===input$jscomp$0.charCodeAt(tokPos+2)?3:2):finishOp(61===code?_eq:_prefix,1),code;case 126:return finishOp(_prefix,1)}return!1}function readToken(forceRegexp){forceRegexp?tokPos=tokStart+1:tokStart=tokPos;options.locations&&(tokStartLoc=new line_loc_t);if(forceRegexp)return readRegexp();if(tokPos>=inputLen)return finishToken(_eof);var code=input$jscomp$0.charCodeAt(tokPos);if(isIdentifierStart(code)||
92===code)return readWord();forceRegexp=getTokenFromCode(code);if(!1===forceRegexp){code=String.fromCharCode(code);if("\\"===code||nonASCIIidentifierStart.test(code))return readWord();raise(tokPos,"Unexpected character '"+code+"'")}return forceRegexp}function finishOp(type,size){var str=input$jscomp$0.slice(tokPos,tokPos+size);tokPos+=size;finishToken(type,str)}function readRegexp(){for(var content,inClass,start=tokPos;;){tokPos>=inputLen&&raise(start,"Unterminated regular expression");var ch=input$jscomp$0.charAt(tokPos);
newline.test(ch)&&raise(start,"Unterminated regular expression");if(content)content=!1;else{if("["===ch)inClass=!0;else if("]"===ch&&inClass)inClass=!1;else if("/"===ch&&!inClass)break;content="\\"===ch}++tokPos}content=input$jscomp$0.slice(start,tokPos);++tokPos;(inClass=readWord1())&&!/^[gmsiy]*$/.test(inClass)&&raise(start,"Invalid regexp flag");try{var value=new RegExp(content,inClass)}catch(e$0){e$0 instanceof SyntaxError&&raise(start,e$0.message),raise(e$0)}return finishToken(_regexp,value)}
function readInt(radix,len){for(var start=tokPos,total=0,i=0,e=null==len?Infinity:len;i<e;++i){var code=input$jscomp$0.charCodeAt(tokPos);code=97<=code?code-97+10:65<=code?code-65+10:48<=code&&57>=code?code-48:Infinity;if(code>=radix)break;++tokPos;total=total*radix+code}return tokPos===start||null!=len&&tokPos-start!==len?null:total}function readNumber(startsWithDot){var start=tokPos,isFloat=!1,octal=48===input$jscomp$0.charCodeAt(tokPos);startsWithDot||null!==readInt(10)||raise(start,"Invalid number");
46===input$jscomp$0.charCodeAt(tokPos)&&(++tokPos,readInt(10),isFloat=!0);startsWithDot=input$jscomp$0.charCodeAt(tokPos);if(69===startsWithDot||101===startsWithDot)startsWithDot=input$jscomp$0.charCodeAt(++tokPos),43!==startsWithDot&&45!==startsWithDot||++tokPos,null===readInt(10)&&raise(start,"Invalid number"),isFloat=!0;isIdentifierStart(input$jscomp$0.charCodeAt(tokPos))&&raise(tokPos,"Identifier directly after number");startsWithDot=input$jscomp$0.slice(start,tokPos);var val;isFloat?val=parseFloat(startsWithDot):
octal&&1!==startsWithDot.length?/[89]/.test(startsWithDot)||strict?raise(start,"Invalid number"):val=parseInt(startsWithDot,8):val=parseInt(startsWithDot,10);return finishToken(_num,val)}function readHexChar(len){len=readInt(16,len);null===len&&raise(tokStart,"Bad character escape sequence");return len}function readWord1(){containsEsc=!1;for(var word,first=!0,start=tokPos;;){var ch=input$jscomp$0.charCodeAt(tokPos);if(isIdentifierChar(ch))containsEsc&&(word+=input$jscomp$0.charAt(tokPos)),++tokPos;
else if(92===ch){containsEsc||(word=input$jscomp$0.slice(start,tokPos));containsEsc=!0;117!=input$jscomp$0.charCodeAt(++tokPos)&&raise(tokPos,"Expecting Unicode escape sequence \\uXXXX");++tokPos;ch=readHexChar(4);var escStr=String.fromCharCode(ch);escStr||raise(tokPos-1,"Invalid Unicode escape");(first?isIdentifierStart(ch):isIdentifierChar(ch))||raise(tokPos-4,"Invalid Unicode escape");word+=escStr}else break;first=!1}return containsEsc?word:input$jscomp$0.slice(start,tokPos)}function readWord(){var word=
readWord1(),type=_name;!containsEsc&&isKeyword(word)&&(type=keywordTypes[word]);return finishToken(type,word)}function next(){lastStart=tokStart;lastEnd=tokEnd;lastEndLoc=tokEndLoc;readToken()}function setStrict(strct){strict=strct;tokPos=tokStart;if(options.locations)for(;tokPos<tokLineStart;)tokLineStart=input$jscomp$0.lastIndexOf("\n",tokLineStart-2)+1,--tokCurLine;skipSpace();readToken()}function node_t(){this.type=null;this.start=tokStart;this.end=null}function node_loc_t(){this.start=tokStartLoc;
this.end=null;null!==sourceFile&&(this.source=sourceFile)}function startNode(){var node=new node_t;options.locations&&(node.loc=new node_loc_t);options.directSourceFile&&(node.sourceFile=options.directSourceFile);options.ranges&&(node.range=[tokStart,0]);return node}function startNodeFrom(other){var node=new node_t;node.start=other.start;options.locations&&(node.loc=new node_loc_t,node.loc.start=other.loc.start);options.ranges&&(node.range=[other.range[0],0]);return node}function finishNode(node,
type){node.type=type;node.end=lastEnd;options.locations&&(node.loc.end=lastEndLoc);options.ranges&&(node.range[1]=lastEnd);return node}function isUseStrict(stmt){return 5<=options.ecmaVersion&&"ExpressionStatement"===stmt.type&&"Literal"===stmt.expression.type&&"use strict"===stmt.expression.value}function eat(type){if(tokType===type)return next(),!0}function canInsertSemicolon(){return!options.strictSemicolons&&(tokType===_eof||tokType===_braceR||newline.test(input$jscomp$0.slice(lastEnd,tokStart)))}
function semicolon(){eat(_semi)||canInsertSemicolon()||unexpected()}function expect(type){tokType===type?next():unexpected()}function unexpected(){raise(tokStart,"Unexpected token")}function checkLVal(expr){"Identifier"!==expr.type&&"MemberExpression"!==expr.type&&raise(expr.start,"Assigning to rvalue");strict&&"Identifier"===expr.type&&isStrictBadIdWord(expr.name)&&raise(expr.start,"Assigning to "+expr.name+" in strict mode")}function parseStatement(){(tokType===_slash||tokType===_assign&&"/\x3d"==
tokVal)&&readToken(!0);var starttype=tokType,node=startNode();switch(starttype){case _break:case _continue:next();var isBreak=starttype===_break;eat(_semi)||canInsertSemicolon()?node.label=null:tokType!==_name?unexpected():(node.label=parseIdent(),semicolon());for(var i=0;i<labels.length;++i){var lab=labels[i];if(null==node.label||lab.name===node.label.name){if(null!=lab.kind&&(isBreak||"loop"===lab.kind))break;if(node.label&&isBreak)break}}i===labels.length&&raise(node.start,"Unsyntactic "+starttype.keyword);
return finishNode(node,isBreak?"BreakStatement":"ContinueStatement");case _debugger:return next(),semicolon(),finishNode(node,"DebuggerStatement");case _do:return next(),labels.push(loopLabel),node.body=parseStatement(),labels.pop(),expect(_while),node.test=parseParenExpression(),semicolon(),finishNode(node,"DoWhileStatement");case _for:next();labels.push(loopLabel);expect(_parenL);if(tokType===_semi)return parseFor(node,null);if(tokType===_var)return starttype=startNode(),next(),parseVar(starttype,
!0),finishNode(starttype,"VariableDeclaration"),1===starttype.declarations.length&&eat(_in)?parseForIn(node,starttype):parseFor(node,starttype);starttype=parseExpression(!1,!0);return eat(_in)?(checkLVal(starttype),parseForIn(node,starttype)):parseFor(node,starttype);case _function:return next(),parseFunction(node,!0);case _if:return next(),node.test=parseParenExpression(),node.consequent=parseStatement(),node.alternate=eat(_else)?parseStatement():null,finishNode(node,"IfStatement");case _return:return inFunction||
options.allowReturnOutsideFunction||raise(tokStart,"'return' outside of function"),next(),eat(_semi)||canInsertSemicolon()?node.argument=null:(node.argument=parseExpression(),semicolon()),finishNode(node,"ReturnStatement");case _switch:next();node.discriminant=parseParenExpression();node.cases=[];expect(_braceL);for(labels.push(switchLabel);tokType!=_braceR;)tokType===_case||tokType===_default?(starttype=tokType===_case,i&&finishNode(i,"SwitchCase"),node.cases.push(i=startNode()),i.consequent=[],
next(),starttype?i.test=parseExpression():(isBreak&&raise(lastStart,"Multiple default clauses"),isBreak=!0,i.test=null),expect(_colon)):(i||unexpected(),i.consequent.push(parseStatement()));i&&finishNode(i,"SwitchCase");next();labels.pop();return finishNode(node,"SwitchStatement");case _throw:return next(),newline.test(input$jscomp$0.slice(lastEnd,tokStart))&&raise(lastEnd,"Illegal newline after throw"),node.argument=parseExpression(),semicolon(),finishNode(node,"ThrowStatement");case _try:return next(),
node.block=parseBlock(),node.handler=null,tokType===_catch&&(starttype=startNode(),next(),expect(_parenL),starttype.param=parseIdent(),strict&&isStrictBadIdWord(starttype.param.name)&&raise(starttype.param.start,"Binding "+starttype.param.name+" in strict mode"),expect(_parenR),starttype.guard=null,starttype.body=parseBlock(),node.handler=finishNode(starttype,"CatchClause")),node.guardedHandlers=empty,node.finalizer=eat(_finally)?parseBlock():null,node.handler||node.finalizer||raise(node.start,"Missing catch or finally clause"),
finishNode(node,"TryStatement");case _var:return next(),parseVar(node),semicolon(),finishNode(node,"VariableDeclaration");case _while:return next(),node.test=parseParenExpression(),labels.push(loopLabel),node.body=parseStatement(),labels.pop(),finishNode(node,"WhileStatement");case _with:return strict&&raise(tokStart,"'with' in strict mode"),next(),node.object=parseParenExpression(),node.body=parseStatement(),finishNode(node,"WithStatement");case _braceL:return parseBlock();case _semi:return next(),
finishNode(node,"EmptyStatement");default:isBreak=tokVal;lab=parseExpression();if(starttype===_name&&"Identifier"===lab.type&&eat(_colon)){for(i=0;i<labels.length;++i)labels[i].name===isBreak&&raise(lab.start,"Label '"+isBreak+"' is already declared");labels.push({name:isBreak,kind:tokType.isLoop?"loop":tokType===_switch?"switch":null});node.body=parseStatement();labels.pop();node.label=lab;return finishNode(node,"LabeledStatement")}node.expression=lab;semicolon();return finishNode(node,"ExpressionStatement")}}
function parseParenExpression(){expect(_parenL);var val=parseExpression();expect(_parenR);return val}function parseBlock(allowStrict){var node=startNode(),first=!0,strict=!1;node.body=[];for(expect(_braceL);!eat(_braceR);){var stmt=parseStatement();node.body.push(stmt);if(first&&allowStrict&&isUseStrict(stmt)){var oldStrict=strict;setStrict(strict=!0)}first=!1}strict&&!oldStrict&&setStrict(!1);return finishNode(node,"BlockStatement")}function parseFor(node,init){node.init=init;expect(_semi);node.test=
tokType===_semi?null:parseExpression();expect(_semi);node.update=tokType===_parenR?null:parseExpression();expect(_parenR);node.body=parseStatement();labels.pop();return finishNode(node,"ForStatement")}function parseForIn(node,init){node.left=init;node.right=parseExpression();expect(_parenR);node.body=parseStatement();labels.pop();return finishNode(node,"ForInStatement")}function parseVar(node,noIn){node.declarations=[];for(node.kind="var";;){var decl=startNode();decl.id=parseIdent();strict&&isStrictBadIdWord(decl.id.name)&&
raise(decl.id.start,"Binding "+decl.id.name+" in strict mode");decl.init=eat(_eq)?parseExpression(!0,noIn):null;node.declarations.push(finishNode(decl,"VariableDeclarator"));if(!eat(_comma))break}return node}function parseExpression(noComma,noIn){var expr=parseMaybeAssign(noIn);if(!noComma&&tokType===_comma){noComma=startNodeFrom(expr);for(noComma.expressions=[expr];eat(_comma);)noComma.expressions.push(parseMaybeAssign(noIn));return finishNode(noComma,"SequenceExpression")}return expr}function parseMaybeAssign(noIn){var left=
parseExprOp(parseMaybeUnary(),-1,noIn);if(eat(_question)){var node=startNodeFrom(left);node.test=left;node.consequent=parseExpression(!0);expect(_colon);node.alternate=parseExpression(!0,noIn);left=finishNode(node,"ConditionalExpression")}return tokType.isAssign?(node=startNodeFrom(left),node.operator=tokVal,node.left=left,next(),node.right=parseMaybeAssign(noIn),checkLVal(left),finishNode(node,"AssignmentExpression")):left}function parseExprOp(left,minPrec,noIn){var prec=tokType.binop;if(null!=prec&&
(!noIn||tokType!==_in)&&prec>minPrec){var node=startNodeFrom(left);node.left=left;node.operator=tokVal;left=tokType;next();node.right=parseExprOp(parseMaybeUnary(),prec,noIn);prec=finishNode(node,left===_logicalOR||left===_logicalAND?"LogicalExpression":"BinaryExpression");return parseExprOp(prec,minPrec,noIn)}return left}function parseMaybeUnary(){if(tokType.prefix){var node=startNode(),update=tokType.isUpdate;node.operator=tokVal;tokRegexpAllowed=node.prefix=!0;next();node.argument=parseMaybeUnary();
update?checkLVal(node.argument):strict&&"delete"===node.operator&&"Identifier"===node.argument.type&&raise(node.start,"Deleting local variable in strict mode");return finishNode(node,update?"UpdateExpression":"UnaryExpression")}for(update=parseSubscripts(parseExprAtom());tokType.postfix&&!canInsertSemicolon();)node=startNodeFrom(update),node.operator=tokVal,node.prefix=!1,node.argument=update,checkLVal(update),next(),update=finishNode(node,"UpdateExpression");return update}function parseSubscripts(base,
noCalls){if(eat(_dot)){var node=startNodeFrom(base);node.object=base;node.property=parseIdent(!0);node.computed=!1;return parseSubscripts(finishNode(node,"MemberExpression"),noCalls)}return eat(_bracketL)?(node=startNodeFrom(base),node.object=base,node.property=parseExpression(),node.computed=!0,expect(_bracketR),parseSubscripts(finishNode(node,"MemberExpression"),noCalls)):!noCalls&&eat(_parenL)?(node=startNodeFrom(base),node.callee=base,node.arguments=parseExprList(_parenR,!1),parseSubscripts(finishNode(node,
"CallExpression"),noCalls)):base}function parseExprAtom(){switch(tokType){case _this:var node=startNode();next();return finishNode(node,"ThisExpression");case _name:return parseIdent();case _num:case _string:case _regexp:return node=startNode(),node.value=tokVal,node.raw=input$jscomp$0.slice(tokStart,tokEnd),next(),finishNode(node,"Literal");case _null:case _true:case _false:return node=startNode(),node.value=tokType.atomValue,node.raw=tokType.keyword,next(),finishNode(node,"Literal");case _parenL:node=
tokStartLoc;var tokStart1=tokStart;next();var val=parseExpression();val.start=tokStart1;val.end=tokEnd;options.locations&&(val.loc.start=node,val.loc.end=tokEndLoc);options.ranges&&(val.range=[tokStart1,tokEnd]);expect(_parenR);return val;case _bracketL:return node=startNode(),next(),node.elements=parseExprList(_bracketR,!0,!0),finishNode(node,"ArrayExpression");case _braceL:node=startNode();tokStart1=!0;val=!1;node.properties=[];for(next();!eat(_braceR);){if(tokStart1)tokStart1=!1;else if(expect(_comma),
options.allowTrailingCommas&&eat(_braceR))break;var prop={key:tokType===_num||tokType===_string?parseExprAtom():parseIdent(!0)},isGetSet=!1;if(eat(_colon)){prop.value=parseExpression(!0);var kind=prop.kind="init"}else 5<=options.ecmaVersion&&"Identifier"===prop.key.type&&("get"===prop.key.name||"set"===prop.key.name)?(isGetSet=val=!0,kind=prop.kind=prop.key.name,prop.key=tokType===_num||tokType===_string?parseExprAtom():parseIdent(!0),tokType!==_parenL&&unexpected(),prop.value=parseFunction(startNode(),
!1)):unexpected();if("Identifier"===prop.key.type&&(strict||val))for(var i=0;i<node.properties.length;++i){var other=node.properties[i];if(other.key.name===prop.key.name){var conflict=kind==other.kind||isGetSet&&"init"===other.kind||"init"===kind&&("get"===other.kind||"set"===other.kind);conflict&&!strict&&"init"===kind&&"init"===other.kind&&(conflict=!1);conflict&&raise(prop.key.start,"Redefinition of property")}}node.properties.push(prop)}return finishNode(node,"ObjectExpression");case _function:return node=
startNode(),next(),parseFunction(node,!1);case _new:return node=startNode(),next(),node.callee=parseSubscripts(parseExprAtom(),!0),eat(_parenL)?node.arguments=parseExprList(_parenR,!1):node.arguments=empty,finishNode(node,"NewExpression");default:unexpected()}}function parseFunction(node,isStatement){tokType===_name?node.id=parseIdent():isStatement?unexpected():node.id=null;node.params=[];var first=!0;for(expect(_parenL);!eat(_parenR);)first?first=!1:expect(_comma),node.params.push(parseIdent());
first=inFunction;var oldLabels=labels;inFunction=!0;labels=[];node.body=parseBlock(!0);inFunction=first;labels=oldLabels;if(strict||node.body.body.length&&isUseStrict(node.body.body[0]))for(first=node.id?-1:0;first<node.params.length;++first)if(oldLabels=0>first?node.id:node.params[first],(isStrictReservedWord(oldLabels.name)||isStrictBadIdWord(oldLabels.name))&&raise(oldLabels.start,"Defining '"+oldLabels.name+"' in strict mode"),0<=first)for(var j=0;j<first;++j)oldLabels.name===node.params[j].name&&
raise(oldLabels.start,"Argument name clash in strict mode");return finishNode(node,isStatement?"FunctionDeclaration":"FunctionExpression")}function parseExprList(close,allowTrailingComma,allowEmpty){for(var elts=[],first=!0;!eat(close);){if(first)first=!1;else if(expect(_comma),allowTrailingComma&&options.allowTrailingCommas&&eat(close))break;allowEmpty&&tokType===_comma?elts.push(null):elts.push(parseExpression(!0))}return elts}function parseIdent(liberal){var node=startNode();liberal&&"everywhere"==
options.forbidReserved&&(liberal=!1);tokType===_name?(!liberal&&(options.forbidReserved&&(3===options.ecmaVersion?isReservedWord3:isReservedWord5)(tokVal)||strict&&isStrictReservedWord(tokVal))&&-1==input$jscomp$0.slice(tokStart,tokEnd).indexOf("\\")&&raise(tokStart,"The keyword '"+tokVal+"' is reserved"),node.name=tokVal):liberal&&tokType.keyword?node.name=tokType.keyword:unexpected();tokRegexpAllowed=!1;next();return finishNode(node,"Identifier")}exports.version="0.5.0";var options,input$jscomp$0,
inputLen,sourceFile;exports.parse=function(inpt,opts){input$jscomp$0=String(inpt);inputLen=input$jscomp$0.length;setOptions(opts);tokCurLine=1;tokPos=tokLineStart=0;tokRegexpAllowed=!0;skipSpace();var program=options.program;lastStart=lastEnd=tokPos;options.locations&&(lastEndLoc=new line_loc_t);inFunction=strict=null;labels=[];readToken();inpt=program||startNode();opts=!0;program||(inpt.body=[]);for(;tokType!==_eof;)program=parseStatement(),inpt.body.push(program),opts&&isUseStrict(program)&&setStrict(!0),
opts=!1;return finishNode(inpt,"Program")};var defaultOptions=exports.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null},getLineInfo=exports.getLineInfo=function(input,offset){for(var line=1,cur=0;;){lineBreak.lastIndex=cur;var match=lineBreak.exec(input);if(match&&match.index<offset)++line,cur=match.index+match[0].length;else break}return{line:line,
column:offset-cur}};exports.tokenize=function(inpt,opts){function getToken(forceRegexp){lastEnd=tokEnd;readToken(forceRegexp);t.start=tokStart;t.end=tokEnd;t.startLoc=tokStartLoc;t.endLoc=tokEndLoc;t.type=tokType;t.value=tokVal;return t}input$jscomp$0=String(inpt);inputLen=input$jscomp$0.length;setOptions(opts);tokCurLine=1;tokPos=tokLineStart=0;tokRegexpAllowed=!0;skipSpace();var t={};getToken.jumpTo=function(pos,reAllowed){tokPos=pos;if(options.locations){tokCurLine=1;tokLineStart=lineBreak.lastIndex=
0;for(var match;(match=lineBreak.exec(input$jscomp$0))&&match.index<pos;)++tokCurLine,tokLineStart=match.index+match[0].length}tokRegexpAllowed=reAllowed;skipSpace()};return getToken};var tokPos,tokStart,tokEnd,tokStartLoc,tokEndLoc,tokType,tokVal,tokRegexpAllowed,tokCurLine,tokLineStart,lastStart,lastEnd,lastEndLoc,inFunction,labels,strict,empty=[],_num={type:"num"},_regexp={type:"regexp"},_string={type:"string"},_name={type:"name"},_eof={type:"eof"},_break={keyword:"break"},_case={keyword:"case",
beforeExpr:!0},_catch={keyword:"catch"},_continue={keyword:"continue"},_debugger={keyword:"debugger"},_default={keyword:"default"},_do={keyword:"do",isLoop:!0},_else={keyword:"else",beforeExpr:!0},_finally={keyword:"finally"},_for={keyword:"for",isLoop:!0},_function={keyword:"function"},_if={keyword:"if"},_return={keyword:"return",beforeExpr:!0},_switch={keyword:"switch"},_throw={keyword:"throw",beforeExpr:!0},_try={keyword:"try"},_var={keyword:"var"},_while={keyword:"while",isLoop:!0},_with={keyword:"with"},
_new={keyword:"new",beforeExpr:!0},_this={keyword:"this"},_null={keyword:"null",atomValue:null},_true={keyword:"true",atomValue:!0},_false={keyword:"false",atomValue:!1},_in={keyword:"in",binop:7,beforeExpr:!0},keywordTypes={"break":_break,"case":_case,"catch":_catch,"continue":_continue,"debugger":_debugger,"default":_default,"do":_do,"else":_else,"finally":_finally,"for":_for,"function":_function,"if":_if,"return":_return,"switch":_switch,"throw":_throw,"try":_try,"var":_var,"while":_while,"with":_with,
"null":_null,"true":_true,"false":_false,"new":_new,"in":_in,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":_this,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},_bracketL={type:"[",beforeExpr:!0},_bracketR={type:"]"},_braceL={type:"{",beforeExpr:!0},_braceR={type:"}"},_parenL={type:"(",beforeExpr:!0},_parenR={type:")"},_comma={type:",",beforeExpr:!0},_semi={type:";",beforeExpr:!0},
_colon={type:":",beforeExpr:!0},_dot={type:"."},_question={type:"?",beforeExpr:!0},_slash={binop:10,beforeExpr:!0},_eq={isAssign:!0,beforeExpr:!0},_assign={isAssign:!0,beforeExpr:!0},_incDec={postfix:!0,prefix:!0,isUpdate:!0},_prefix={prefix:!0,beforeExpr:!0},_logicalOR={binop:1,beforeExpr:!0},_logicalAND={binop:2,beforeExpr:!0},_bitwiseOR={binop:3,beforeExpr:!0},_bitwiseXOR={binop:4,beforeExpr:!0},_bitwiseAND={binop:5,beforeExpr:!0},_equality={binop:6,beforeExpr:!0},_relational={binop:7,beforeExpr:!0},
_bitShift={binop:8,beforeExpr:!0},_plusMin={binop:9,prefix:!0,beforeExpr:!0},_multiplyModulo={binop:10,beforeExpr:!0};exports.tokTypes={bracketL:_bracketL,bracketR:_bracketR,braceL:_braceL,braceR:_braceR,parenL:_parenL,parenR:_parenR,comma:_comma,semi:_semi,colon:_colon,dot:_dot,question:_question,slash:_slash,eq:_eq,name:_name,eof:_eof,num:_num,regexp:_regexp,string:_string};for(var kw in keywordTypes)exports.tokTypes["_"+kw]=keywordTypes[kw];var isReservedWord3=makePredicate("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),
isReservedWord5=makePredicate("class enum extends super const export import"),isStrictReservedWord=makePredicate("implements interface let package private protected public static yield"),isStrictBadIdWord=makePredicate("eval arguments"),isKeyword=makePredicate("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),nonASCIIwhitespace=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,
nonASCIIidentifierStart=/[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,
nonASCIIidentifier=/[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,
newline=/[\n\r\u2028\u2029]/,lineBreak=/\r\n|[\n\r\u2028\u2029]/g,isIdentifierStart=exports.isIdentifierStart=function(code){return 65>code?36===code:91>code?!0:97>code?95===code:123>code?!0:170<=code&&nonASCIIidentifierStart.test(String.fromCharCode(code))},isIdentifierChar=exports.isIdentifierChar=function(code){return 48>code?36===code:58>code?!0:65>code?!1:91>code?!0:97>code?95===code:123>code?!0:170<=code&&nonASCIIidentifier.test(String.fromCharCode(code))},containsEsc,loopLabel={kind:"loop"},
switchLabel={kind:"switch"}});acorn.version||(acorn=null)}var binaryOperators={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","\x3d\x3d":"__equals","!\x3d":"__equals"},unaryOperators={"-":"__negate","+":"__self"},fields=Base.each("add subtract multiply divide modulo equals negate".split(" "),function(name){this["__"+name]="#"+name},{__self:function(){return this}});Point.inject(fields);Size.inject(fields);Color.inject(fields);window&&("complete"===document.readyState?
setTimeout(loadAll):DomEvent.add(window,{load:loadAll}));return{compile:compile,execute:execute,load:function(script){return script?loadScript(script):loadAll()},parse:parse,calculateBinary:__$__,calculateUnary:$__}}.call(this);var paper=new (PaperScope.inject(Base.exports,{Base:Base,Numerical:Numerical,Key:Key,DomEvent:DomEvent,DomElement:DomElement,document:document,window:window,Symbol:SymbolDefinition,PlacedSymbol:SymbolItem}));paper.agent.node&&require("shadow$empty")(paper);"function"===typeof define&&
define.amd?define("paper",paper):"object"===typeof module$jscomp$0&&module$jscomp$0&&(module$jscomp$0.exports=paper);return paper}).call(this,"object"===typeof self?self:null)}
//# sourceMappingURL=module$node_modules$paper$dist$paper_full.js.map
