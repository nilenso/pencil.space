{"version":3,"sources":["src/api.cljs"],"mappings":";;;;;;AAMA,AAAA,AAAAA,AAAAC,AAAAC;AAAA;AAAA,AAAA,AAAA,AAAmBC;;AAEnB,AAAAC,AAAA;AAAAC,AAEC,AAAKE;AAAL,AACE,AAACC,AAAMC,AAAeF;;AAHzB,AAAA,AAAAH,AAAAC,AAAAD,AAAAC,AAACC,AAAAA,AAAAA;AAKD,AAAA,AAACI,AAEC,AAAAC,AAAAC;AAAA,AAAA,AAAAC,AAAAF;AAAAE,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAL,AAAAO,AAAAF,AAAAA;AAAAA,AAAqBO;AAArB,AAAAJ,AAAAH,AAAA,AAAaM;AAAbF,AAAAL;AAAA,AAAAM,AAAAD,AAAA,AAAA,AAA4BI;AAA5B,AAAAH,AAAAD,AAAA,AAAA,AAA8BK;AAA9B,AACE,AAAA,AAACC;;AADH,AAAA,AAAA,AAAA,AAAA,AAEO,AAAA,AAAA,AAAA,AAACC,AAAML,AAEI,AAAA,AAAOG;;AAI3B,AAAA,AAACG,AAEC,AAAAC,AAAKP;AAAL,AAAA,AAAAQ,AAAAD;AAAA,AAAAR,AAAAS,AAAA,AAAA,AAASN;AAAT,AAAAH,AAAAS,AAAA,AAAA,AAAWL;AAAX,AACE,AAAA,AAAA,AAACE,AAAML;;AAGX,AAAA,AAACT,AAEA,AAAAkB,AAAcP;AAAd,AAAA,AAAAQ,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAf,AAAA,AAAAe,AAAA,AAAA,AAAA,AAAA,AAAArB,AAAAO,AAAAc,AAAAA;AAAA,AAAAb,AAAAa,AAAA,AAAMV;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAEiChB,AAEqB,AAAA,AAAYgB,AAAY,AAAA,AAASA,AACtD,AAACW,AACD,AAAA,AAAA,AAAA,AAACC,AAG1B,AAAA,AAAA,AAACP,AAAML","names":["js/src","js/src.api","js/src.api.game-api","src.api/game-api","G__34692","G__34693","re-frame.core/reg-fx","route","cljs.core.apply","reitit.frontend.easy/push-state","re_frame.core.reg_event_fx","p__34698","p__34699","map__34703","cljs.core/PROTOCOL_SENTINEL","cljs.core/hash-map","cljs.core.get","vec__34704","cljs.core.nth","db","cofx","_","result","cljs.core.prn","cljs.core.assoc","re_frame.core.reg_event_db","p__34710","vec__34711","p__34714","map__34715","ajax.core/json-request-format","ajax.core/json-response-format"],"sourcesContent":["(ns src.api\n  (:require [ajax.core :as ajax]\n            [day8.re-frame.http-fx]\n            [reitit.frontend.easy :as rfe]\n            [re-frame.core :as re-frame]))\n\n(defonce ^:private game-api \"http://localhost:8080/api/v1/game\")\n\n(re-frame/reg-fx\n ::navigate!\n (fn [route]\n   (apply rfe/push-state route)))\n\n(re-frame/reg-event-fx\n  ::create-game-success\n  (fn [{:keys [db] :as cofx} [_ result]]\n    (prn \"hi2u\")\n    {:db (assoc db\n                :game :lobby\n                :id (:name result))\n\n     ::navigate! [:src.routes/lobby]}))\n\n(re-frame/reg-event-db\n  ::create-game-failure\n  (fn [db [_ result]]\n    (assoc db :game :failed)))\n\n\n(re-frame/reg-event-fx\n ::create-game\n (fn [{db :db} _]\n   {:http-xhrio {:method          :post\n                 :uri             game-api\n                 :timeout         5000\n                 :params          {:host {:id 1, :name (:nick-name db) :avatar (:avatar db)}}\n                 :format          (ajax/json-request-format)\n                 :response-format (ajax/json-response-format {:keywords? true})\n                 :on-success      [::create-game-success]\n                 :on-failure      [::create-game-failure]}\n    :db  (assoc db :game :starting)}))\n"]}